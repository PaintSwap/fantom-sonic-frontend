(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[189],{31050:function(i,r,c){"use strict";r.Xx=r._w=r.aP=r.KS=r.jQ=void 0,c(31416);let l=c(93350);function gf(i){let r=new Float64Array(16);if(i)for(let c=0;c<i.length;c++)r[c]=i[c];return r}c(17309),r.jQ=64,r.KS=64,r.aP=32;let E=new Uint8Array(32);E[0]=9;let S=gf(),P=gf([1]),C=(gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222])),A=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),q=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]);function set25519(i,r){for(let c=0;c<16;c++)i[c]=0|r[c]}function car25519(i){let r=1;for(let c=0;c<16;c++){let l=i[c]+r+65535;r=Math.floor(l/65536),i[c]=l-65536*r}i[0]+=r-1+37*(r-1)}function sel25519(i,r,c){let l=~(c-1);for(let c=0;c<16;c++){let E=l&(i[c]^r[c]);i[c]^=E,r[c]^=E}}function pack25519(i,r){let c=gf(),l=gf();for(let i=0;i<16;i++)l[i]=r[i];car25519(l),car25519(l),car25519(l);for(let i=0;i<2;i++){c[0]=l[0]-65517;for(let i=1;i<15;i++)c[i]=l[i]-65535-(c[i-1]>>16&1),c[i-1]&=65535;c[15]=l[15]-32767-(c[14]>>16&1);let i=c[15]>>16&1;c[14]&=65535,sel25519(l,c,1-i)}for(let r=0;r<16;r++)i[2*r]=255&l[r],i[2*r+1]=l[r]>>8}gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function add(i,r,c){for(let l=0;l<16;l++)i[l]=r[l]+c[l]}function sub(i,r,c){for(let l=0;l<16;l++)i[l]=r[l]-c[l]}function mul(i,r,c){let l,E,S=0,P=0,C=0,A=0,q=0,T=0,D=0,M=0,U=0,B=0,F=0,J=0,X=0,ee=0,et=0,ea=0,eo=0,ec=0,eh=0,el=0,ep=0,ed=0,ef=0,eg=0,ey=0,em=0,e_=0,ew=0,eb=0,eI=0,eE=0,ex=c[0],eS=c[1],eP=c[2],eC=c[3],eR=c[4],eO=c[5],eA=c[6],eN=c[7],eT=c[8],eD=c[9],ek=c[10],ej=c[11],eM=c[12],ez=c[13],eL=c[14],e$=c[15];S+=(l=r[0])*ex,P+=l*eS,C+=l*eP,A+=l*eC,q+=l*eR,T+=l*eO,D+=l*eA,M+=l*eN,U+=l*eT,B+=l*eD,F+=l*ek,J+=l*ej,X+=l*eM,ee+=l*ez,et+=l*eL,ea+=l*e$,P+=(l=r[1])*ex,C+=l*eS,A+=l*eP,q+=l*eC,T+=l*eR,D+=l*eO,M+=l*eA,U+=l*eN,B+=l*eT,F+=l*eD,J+=l*ek,X+=l*ej,ee+=l*eM,et+=l*ez,ea+=l*eL,eo+=l*e$,C+=(l=r[2])*ex,A+=l*eS,q+=l*eP,T+=l*eC,D+=l*eR,M+=l*eO,U+=l*eA,B+=l*eN,F+=l*eT,J+=l*eD,X+=l*ek,ee+=l*ej,et+=l*eM,ea+=l*ez,eo+=l*eL,ec+=l*e$,A+=(l=r[3])*ex,q+=l*eS,T+=l*eP,D+=l*eC,M+=l*eR,U+=l*eO,B+=l*eA,F+=l*eN,J+=l*eT,X+=l*eD,ee+=l*ek,et+=l*ej,ea+=l*eM,eo+=l*ez,ec+=l*eL,eh+=l*e$,q+=(l=r[4])*ex,T+=l*eS,D+=l*eP,M+=l*eC,U+=l*eR,B+=l*eO,F+=l*eA,J+=l*eN,X+=l*eT,ee+=l*eD,et+=l*ek,ea+=l*ej,eo+=l*eM,ec+=l*ez,eh+=l*eL,el+=l*e$,T+=(l=r[5])*ex,D+=l*eS,M+=l*eP,U+=l*eC,B+=l*eR,F+=l*eO,J+=l*eA,X+=l*eN,ee+=l*eT,et+=l*eD,ea+=l*ek,eo+=l*ej,ec+=l*eM,eh+=l*ez,el+=l*eL,ep+=l*e$,D+=(l=r[6])*ex,M+=l*eS,U+=l*eP,B+=l*eC,F+=l*eR,J+=l*eO,X+=l*eA,ee+=l*eN,et+=l*eT,ea+=l*eD,eo+=l*ek,ec+=l*ej,eh+=l*eM,el+=l*ez,ep+=l*eL,ed+=l*e$,M+=(l=r[7])*ex,U+=l*eS,B+=l*eP,F+=l*eC,J+=l*eR,X+=l*eO,ee+=l*eA,et+=l*eN,ea+=l*eT,eo+=l*eD,ec+=l*ek,eh+=l*ej,el+=l*eM,ep+=l*ez,ed+=l*eL,ef+=l*e$,U+=(l=r[8])*ex,B+=l*eS,F+=l*eP,J+=l*eC,X+=l*eR,ee+=l*eO,et+=l*eA,ea+=l*eN,eo+=l*eT,ec+=l*eD,eh+=l*ek,el+=l*ej,ep+=l*eM,ed+=l*ez,ef+=l*eL,eg+=l*e$,B+=(l=r[9])*ex,F+=l*eS,J+=l*eP,X+=l*eC,ee+=l*eR,et+=l*eO,ea+=l*eA,eo+=l*eN,ec+=l*eT,eh+=l*eD,el+=l*ek,ep+=l*ej,ed+=l*eM,ef+=l*ez,eg+=l*eL,ey+=l*e$,F+=(l=r[10])*ex,J+=l*eS,X+=l*eP,ee+=l*eC,et+=l*eR,ea+=l*eO,eo+=l*eA,ec+=l*eN,eh+=l*eT,el+=l*eD,ep+=l*ek,ed+=l*ej,ef+=l*eM,eg+=l*ez,ey+=l*eL,em+=l*e$,J+=(l=r[11])*ex,X+=l*eS,ee+=l*eP,et+=l*eC,ea+=l*eR,eo+=l*eO,ec+=l*eA,eh+=l*eN,el+=l*eT,ep+=l*eD,ed+=l*ek,ef+=l*ej,eg+=l*eM,ey+=l*ez,em+=l*eL,e_+=l*e$,X+=(l=r[12])*ex,ee+=l*eS,et+=l*eP,ea+=l*eC,eo+=l*eR,ec+=l*eO,eh+=l*eA,el+=l*eN,ep+=l*eT,ed+=l*eD,ef+=l*ek,eg+=l*ej,ey+=l*eM,em+=l*ez,e_+=l*eL,ew+=l*e$,ee+=(l=r[13])*ex,et+=l*eS,ea+=l*eP,eo+=l*eC,ec+=l*eR,eh+=l*eO,el+=l*eA,ep+=l*eN,ed+=l*eT,ef+=l*eD,eg+=l*ek,ey+=l*ej,em+=l*eM,e_+=l*ez,ew+=l*eL,eb+=l*e$,et+=(l=r[14])*ex,ea+=l*eS,eo+=l*eP,ec+=l*eC,eh+=l*eR,el+=l*eO,ep+=l*eA,ed+=l*eN,ef+=l*eT,eg+=l*eD,ey+=l*ek,em+=l*ej,e_+=l*eM,ew+=l*ez,eb+=l*eL,eI+=l*e$,ea+=(l=r[15])*ex,eo+=l*eS,ec+=l*eP,eh+=l*eC,el+=l*eR,ep+=l*eO,ed+=l*eA,ef+=l*eN,eg+=l*eT,ey+=l*eD,em+=l*ek,e_+=l*ej,ew+=l*eM,eb+=l*ez,eI+=l*eL,eE+=l*e$,S+=38*eo,P+=38*ec,C+=38*eh,A+=38*el,q+=38*ep,T+=38*ed,D+=38*ef,M+=38*eg,U+=38*ey,B+=38*em,F+=38*e_,J+=38*ew,X+=38*eb,ee+=38*eI,et+=38*eE,E=Math.floor((l=S+(E=1)+65535)/65536),S=l-65536*E,E=Math.floor((l=P+E+65535)/65536),P=l-65536*E,E=Math.floor((l=C+E+65535)/65536),C=l-65536*E,E=Math.floor((l=A+E+65535)/65536),A=l-65536*E,E=Math.floor((l=q+E+65535)/65536),q=l-65536*E,E=Math.floor((l=T+E+65535)/65536),T=l-65536*E,E=Math.floor((l=D+E+65535)/65536),D=l-65536*E,E=Math.floor((l=M+E+65535)/65536),M=l-65536*E,E=Math.floor((l=U+E+65535)/65536),U=l-65536*E,E=Math.floor((l=B+E+65535)/65536),B=l-65536*E,E=Math.floor((l=F+E+65535)/65536),F=l-65536*E,E=Math.floor((l=J+E+65535)/65536),J=l-65536*E,E=Math.floor((l=X+E+65535)/65536),X=l-65536*E,E=Math.floor((l=ee+E+65535)/65536),ee=l-65536*E,E=Math.floor((l=et+E+65535)/65536),et=l-65536*E,E=Math.floor((l=ea+E+65535)/65536),ea=l-65536*E,S+=E-1+37*(E-1),E=Math.floor((l=S+(E=1)+65535)/65536),S=l-65536*E,E=Math.floor((l=P+E+65535)/65536),P=l-65536*E,E=Math.floor((l=C+E+65535)/65536),C=l-65536*E,E=Math.floor((l=A+E+65535)/65536),A=l-65536*E,E=Math.floor((l=q+E+65535)/65536),q=l-65536*E,E=Math.floor((l=T+E+65535)/65536),T=l-65536*E,E=Math.floor((l=D+E+65535)/65536),D=l-65536*E,E=Math.floor((l=M+E+65535)/65536),M=l-65536*E,E=Math.floor((l=U+E+65535)/65536),U=l-65536*E,E=Math.floor((l=B+E+65535)/65536),B=l-65536*E,E=Math.floor((l=F+E+65535)/65536),F=l-65536*E,E=Math.floor((l=J+E+65535)/65536),J=l-65536*E,E=Math.floor((l=X+E+65535)/65536),X=l-65536*E,E=Math.floor((l=ee+E+65535)/65536),ee=l-65536*E,E=Math.floor((l=et+E+65535)/65536),et=l-65536*E,E=Math.floor((l=ea+E+65535)/65536),ea=l-65536*E,S+=E-1+37*(E-1),i[0]=S,i[1]=P,i[2]=C,i[3]=A,i[4]=q,i[5]=T,i[6]=D,i[7]=M,i[8]=U,i[9]=B,i[10]=F,i[11]=J,i[12]=X,i[13]=ee,i[14]=et,i[15]=ea}function edadd(i,r){let c=gf(),l=gf(),E=gf(),S=gf(),P=gf(),A=gf(),q=gf(),T=gf(),D=gf();sub(c,i[1],i[0]),sub(D,r[1],r[0]),mul(c,c,D),add(l,i[0],i[1]),add(D,r[0],r[1]),mul(l,l,D),mul(E,i[3],r[3]),mul(E,E,C),mul(S,i[2],r[2]),add(S,S,S),sub(P,l,c),sub(A,S,E),add(q,S,E),add(T,l,c),mul(i[0],P,A),mul(i[1],T,q),mul(i[2],q,A),mul(i[3],P,T)}function cswap(i,r,c){for(let l=0;l<4;l++)sel25519(i[l],r[l],c)}function pack(i,r){let c=gf(),l=gf(),E=gf();(function(i,r){let c;let l=gf();for(c=0;c<16;c++)l[c]=r[c];for(c=253;c>=0;c--)mul(l,l,l),2!==c&&4!==c&&mul(l,l,r);for(c=0;c<16;c++)i[c]=l[c]})(E,r[2]),mul(c,r[0],E),mul(l,r[1],E),pack25519(i,l),i[31]^=function(i){let r=new Uint8Array(32);return pack25519(r,i),1&r[0]}(c)<<7}function scalarbase(i,r){let c=[gf(),gf(),gf(),gf()];set25519(c[0],A),set25519(c[1],q),set25519(c[2],P),mul(c[3],A,q),function(i,r,c){set25519(i[0],S),set25519(i[1],P),set25519(i[2],P),set25519(i[3],S);for(let l=255;l>=0;--l){let E=c[l/8|0]>>(7&l)&1;cswap(i,r,E),edadd(r,i),edadd(i,i),cswap(i,r,E)}}(i,c,r)}r._w=function(i){if(i.length!==r.aP)throw Error(`ed25519: seed must be ${r.aP} bytes`);let c=(0,l.hash)(i);c[0]&=248,c[31]&=127,c[31]|=64;let E=new Uint8Array(32),S=[gf(),gf(),gf(),gf()];scalarbase(S,c),pack(E,S);let P=new Uint8Array(64);return P.set(i),P.set(E,32),{publicKey:E,secretKey:P}};let T=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function modL(i,r){let c,l,E,S;for(l=63;l>=32;--l){for(c=0,E=l-32,S=l-12;E<S;++E)r[E]+=c-16*r[l]*T[E-(l-32)],c=Math.floor((r[E]+128)/256),r[E]-=256*c;r[E]+=c,r[l]=0}for(E=0,c=0;E<32;E++)r[E]+=c-(r[31]>>4)*T[E],c=r[E]>>8,r[E]&=255;for(E=0;E<32;E++)r[E]-=c*T[E];for(l=0;l<32;l++)r[l+1]+=r[l]>>8,i[l]=255&r[l]}function reduce(i){let r=new Float64Array(64);for(let c=0;c<64;c++)r[c]=i[c];for(let r=0;r<64;r++)i[r]=0;modL(i,r)}r.Xx=function(i,r){let c=new Float64Array(64),E=[gf(),gf(),gf(),gf()],S=(0,l.hash)(i.subarray(0,32));S[0]&=248,S[31]&=127,S[31]|=64;let P=new Uint8Array(64);P.set(S.subarray(32),32);let C=new l.SHA512;C.update(P.subarray(32)),C.update(r);let A=C.digest();C.clean(),reduce(A),scalarbase(E,A),pack(P,E),C.reset(),C.update(P.subarray(0,32)),C.update(i.subarray(32)),C.update(r);let q=C.digest();reduce(q);for(let i=0;i<32;i++)c[i]=A[i];for(let i=0;i<32;i++)for(let r=0;r<32;r++)c[i+r]+=q[i]*S[r];return modL(P.subarray(32),c),P}},93350:function(i,r,c){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var l=c(98099),E=c(17309);r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var S=function(){function SHA512(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return SHA512.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},SHA512.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},SHA512.prototype.clean=function(){E.wipe(this._buffer),E.wipe(this._tempHi),E.wipe(this._tempLo),this.reset()},SHA512.prototype.update=function(i,c){if(void 0===c&&(c=i.length),this._finished)throw Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=c,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&c>0;)this._buffer[this._bufferLength++]=i[l++],c--;this._bufferLength===this.blockSize&&(hashBlocks(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(c>=this.blockSize&&(l=hashBlocks(this._tempHi,this._tempLo,this._stateHi,this._stateLo,i,l,c),c%=this.blockSize);c>0;)this._buffer[this._bufferLength++]=i[l++],c--;return this},SHA512.prototype.finish=function(i){if(!this._finished){var r=this._bytesHashed,c=this._bufferLength,E=r%128<112?128:256;this._buffer[c]=128;for(var S=c+1;S<E-8;S++)this._buffer[S]=0;l.writeUint32BE(r/536870912|0,this._buffer,E-8),l.writeUint32BE(r<<3,this._buffer,E-4),hashBlocks(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,E),this._finished=!0}for(var S=0;S<this.digestLength/8;S++)l.writeUint32BE(this._stateHi[S],i,8*S),l.writeUint32BE(this._stateLo[S],i,8*S+4);return this},SHA512.prototype.digest=function(){var i=new Uint8Array(this.digestLength);return this.finish(i),i},SHA512.prototype.saveState=function(){if(this._finished)throw Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},SHA512.prototype.restoreState=function(i){return this._stateHi.set(i.stateHi),this._stateLo.set(i.stateLo),this._bufferLength=i.bufferLength,i.buffer&&this._buffer.set(i.buffer),this._bytesHashed=i.bytesHashed,this._finished=!1,this},SHA512.prototype.cleanSavedState=function(i){E.wipe(i.stateHi),E.wipe(i.stateLo),i.buffer&&E.wipe(i.buffer),i.bufferLength=0,i.bytesHashed=0},SHA512}();r.SHA512=S;var P=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function hashBlocks(i,r,c,E,S,C,A){for(var q,T,D,M,U,B,F,J,X=c[0],ee=c[1],et=c[2],ea=c[3],eo=c[4],ec=c[5],eh=c[6],el=c[7],ep=E[0],ed=E[1],ef=E[2],eg=E[3],ey=E[4],em=E[5],e_=E[6],ew=E[7];A>=128;){for(var eb=0;eb<16;eb++){var eI=8*eb+C;i[eb]=l.readUint32BE(S,eI),r[eb]=l.readUint32BE(S,eI+4)}for(var eb=0;eb<80;eb++){var eE=X,ex=ee,eS=et,eP=ea,eC=eo,eR=ec,eO=eh,eA=el,eN=ep,eT=ed,eD=ef,ek=eg,ej=ey,eM=em,ez=e_,eL=ew;if(q=el,U=65535&(T=ew),B=T>>>16,F=65535&q,J=q>>>16,q=(eo>>>14|ey<<18)^(eo>>>18|ey<<14)^(ey>>>9|eo<<23),U+=65535&(T=(ey>>>14|eo<<18)^(ey>>>18|eo<<14)^(eo>>>9|ey<<23)),B+=T>>>16,F+=65535&q,J+=q>>>16,q=eo&ec^~eo&eh,U+=65535&(T=ey&em^~ey&e_),B+=T>>>16,F+=65535&q,J+=q>>>16,q=P[2*eb],U+=65535&(T=P[2*eb+1]),B+=T>>>16,F+=65535&q,J+=q>>>16,q=i[eb%16],U+=65535&(T=r[eb%16]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,D=65535&F|J<<16,M=65535&U|B<<16,q=D,U=65535&(T=M),B=T>>>16,F=65535&q,J=q>>>16,q=(X>>>28|ep<<4)^(ep>>>2|X<<30)^(ep>>>7|X<<25),U+=65535&(T=(ep>>>28|X<<4)^(X>>>2|ep<<30)^(X>>>7|ep<<25)),B+=T>>>16,F+=65535&q,J+=q>>>16,q=X&ee^X&et^ee&et,U+=65535&(T=ep&ed^ep&ef^ed&ef),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,eA=65535&F|J<<16,eL=65535&U|B<<16,q=eP,U=65535&(T=ek),B=T>>>16,F=65535&q,J=q>>>16,q=D,U+=65535&(T=M),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,eP=65535&F|J<<16,ek=65535&U|B<<16,ee=eE,et=ex,ea=eS,eo=eP,ec=eC,eh=eR,el=eO,X=eA,ed=eN,ef=eT,eg=eD,ey=ek,em=ej,e_=eM,ew=ez,ep=eL,eb%16==15)for(var eI=0;eI<16;eI++)q=i[eI],U=65535&(T=r[eI]),B=T>>>16,F=65535&q,J=q>>>16,q=i[(eI+9)%16],U+=65535&(T=r[(eI+9)%16]),B+=T>>>16,F+=65535&q,J+=q>>>16,q=((D=i[(eI+1)%16])>>>1|(M=r[(eI+1)%16])<<31)^(D>>>8|M<<24)^D>>>7,U+=65535&(T=(M>>>1|D<<31)^(M>>>8|D<<24)^(M>>>7|D<<25)),B+=T>>>16,F+=65535&q,J+=q>>>16,q=((D=i[(eI+14)%16])>>>19|(M=r[(eI+14)%16])<<13)^(M>>>29|D<<3)^D>>>6,U+=65535&(T=(M>>>19|D<<13)^(D>>>29|M<<3)^(M>>>6|D<<26)),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,i[eI]=65535&F|J<<16,r[eI]=65535&U|B<<16}q=X,U=65535&(T=ep),B=T>>>16,F=65535&q,J=q>>>16,q=c[0],U+=65535&(T=E[0]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,c[0]=X=65535&F|J<<16,E[0]=ep=65535&U|B<<16,q=ee,U=65535&(T=ed),B=T>>>16,F=65535&q,J=q>>>16,q=c[1],U+=65535&(T=E[1]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,c[1]=ee=65535&F|J<<16,E[1]=ed=65535&U|B<<16,q=et,U=65535&(T=ef),B=T>>>16,F=65535&q,J=q>>>16,q=c[2],U+=65535&(T=E[2]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,c[2]=et=65535&F|J<<16,E[2]=ef=65535&U|B<<16,q=ea,U=65535&(T=eg),B=T>>>16,F=65535&q,J=q>>>16,q=c[3],U+=65535&(T=E[3]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,c[3]=ea=65535&F|J<<16,E[3]=eg=65535&U|B<<16,q=eo,U=65535&(T=ey),B=T>>>16,F=65535&q,J=q>>>16,q=c[4],U+=65535&(T=E[4]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,c[4]=eo=65535&F|J<<16,E[4]=ey=65535&U|B<<16,q=ec,U=65535&(T=em),B=T>>>16,F=65535&q,J=q>>>16,q=c[5],U+=65535&(T=E[5]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,c[5]=ec=65535&F|J<<16,E[5]=em=65535&U|B<<16,q=eh,U=65535&(T=e_),B=T>>>16,F=65535&q,J=q>>>16,q=c[6],U+=65535&(T=E[6]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,c[6]=eh=65535&F|J<<16,E[6]=e_=65535&U|B<<16,q=el,U=65535&(T=ew),B=T>>>16,F=65535&q,J=q>>>16,q=c[7],U+=65535&(T=E[7]),B+=T>>>16,F+=65535&q,J+=q>>>16,B+=U>>>16,F+=B>>>16,J+=F>>>16,c[7]=el=65535&F|J<<16,E[7]=ew=65535&U|B<<16,C+=128,A-=128}return C}r.hash=function(i){var r=new S;r.update(i);var c=r.digest();return r.clean(),c}},22603:function(i,r,c){"use strict";let l;c.d(r,{EthereumProvider:function(){return iG}});var E=c(17187),S=c.n(E),P=c(41932);let C=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,A=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,q=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function jsonParseTransform(i,r){if("__proto__"===i||"constructor"===i&&r&&"object"==typeof r&&"prototype"in r){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`);return}return r}function destr(i,r={}){if("string"!=typeof i)return i;let c=i.trim();if('"'===i[0]&&i.endsWith('"')&&!i.includes("\\"))return c.slice(1,-1);if(c.length<=9){let i=c.toLowerCase();if("true"===i)return!0;if("false"===i)return!1;if("undefined"===i)return;if("null"===i)return null;if("nan"===i)return Number.NaN;if("infinity"===i)return Number.POSITIVE_INFINITY;if("-infinity"===i)return Number.NEGATIVE_INFINITY}if(!q.test(i)){if(r.strict)throw SyntaxError("[destr] Invalid JSON");return i}try{if(C.test(i)||A.test(i)){if(r.strict)throw Error("[destr] Possible prototype pollution");return JSON.parse(i,jsonParseTransform)}return JSON.parse(i)}catch(c){if(r.strict)throw c;return i}}var T=c(48764).Buffer;function asyncCall(i,...r){try{var c;return(c=i(...r))&&"function"==typeof c.then?c:Promise.resolve(c)}catch(i){return Promise.reject(i)}}function stringify(i){if(function(i){let r=typeof i;return null===i||"object"!==r&&"function"!==r}(i))return String(i);if(function(i){let r=Object.getPrototypeOf(i);return!r||r.isPrototypeOf(Object)}(i)||Array.isArray(i))return JSON.stringify(i);if("function"==typeof i.toJSON)return stringify(i.toJSON());throw Error("[unstorage] Cannot stringify value!")}function checkBufferSupport(){if(void 0===T)throw TypeError("[unstorage] Buffer is not supported!")}let D="base64:";function normalizeKey(i){return i?i.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function unstorage_d569726e_normalizeBaseKey(i){return(i=normalizeKey(i))?i+":":""}let memory=()=>{let i=new Map;return{name:"memory",getInstance:()=>i,hasItem:r=>i.has(r),getItem:r=>i.get(r)??null,getItemRaw:r=>i.get(r)??null,setItem(r,c){i.set(r,c)},setItemRaw(r,c){i.set(r,c)},removeItem(r){i.delete(r)},getKeys:()=>[...i.keys()],clear(){i.clear()},dispose(){i.clear()}}};function watch(i,r,c){return i.watch?i.watch((i,l)=>r(i,c+l)):()=>{}}async function dispose(i){"function"==typeof i.dispose&&await asyncCall(i.dispose)}function promisifyRequest(i){return new Promise((r,c)=>{i.oncomplete=i.onsuccess=()=>r(i.result),i.onabort=i.onerror=()=>c(i.error)})}function createStore(i,r){let c=indexedDB.open(i);c.onupgradeneeded=()=>c.result.createObjectStore(r);let l=promisifyRequest(c);return(i,c)=>l.then(l=>c(l.transaction(r,i).objectStore(r)))}function defaultGetStore(){return l||(l=createStore("keyval-store","keyval")),l}function get(i,r=defaultGetStore()){return r("readonly",r=>promisifyRequest(r.get(i)))}var M=c(85094),z=(i={})=>{let r;let c=i.base&&i.base.length>0?`${i.base}:`:"",e=i=>c+i;return i.dbName&&i.storeName&&(r=createStore(i.dbName,i.storeName)),{name:"idb-keyval",options:i,hasItem:async i=>!(typeof await get(e(i),r)>"u"),getItem:async i=>await get(e(i),r)??null,setItem:(i,c)=>(function(i,r,c=defaultGetStore()){return c("readwrite",c=>(c.put(r,i),promisifyRequest(c.transaction)))})(e(i),c,r),removeItem:i=>(function(i,r=defaultGetStore()){return r("readwrite",r=>(r.delete(i),promisifyRequest(r.transaction)))})(e(i),r),getKeys:()=>(function(i=defaultGetStore()){return i("readonly",i=>{var r;if(i.getAllKeys)return promisifyRequest(i.getAllKeys());let c=[];return(r=i=>c.push(i.key),i.openCursor().onsuccess=function(){this.result&&(r(this.result),this.result.continue())},promisifyRequest(i.transaction)).then(()=>c)})})(r),clear:()=>(function(i=defaultGetStore()){return i("readwrite",i=>(i.clear(),promisifyRequest(i.transaction)))})(r)}};let _=class _{constructor(){this.indexedDb=function(i={}){let r={mounts:{"":i.driver||memory()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},getMount=i=>{for(let c of r.mountpoints)if(i.startsWith(c))return{base:c,relativeKey:i.slice(c.length),driver:r.mounts[c]};return{base:"",relativeKey:i,driver:r.mounts[""]}},getMounts=(i,c)=>r.mountpoints.filter(r=>r.startsWith(i)||c&&i.startsWith(r)).map(c=>({relativeBase:i.length>c.length?i.slice(c.length):void 0,mountpoint:c,driver:r.mounts[c]})),onChange=(i,c)=>{if(r.watching)for(let l of(c=normalizeKey(c),r.watchListeners))l(i,c)},startWatch=async()=>{if(!r.watching)for(let i in r.watching=!0,r.mounts)r.unwatch[i]=await watch(r.mounts[i],onChange,i)},stopWatch=async()=>{if(r.watching){for(let i in r.unwatch)await r.unwatch[i]();r.unwatch={},r.watching=!1}},runBatch=(i,r,c)=>{let l=new Map,getBatch=i=>{let r=l.get(i.base);return r||(r={driver:i.driver,base:i.base,items:[]},l.set(i.base,r)),r};for(let c of i){let i="string"==typeof c,l=normalizeKey(i?c:c.key),E=i?void 0:c.value,S=i||!c.options?r:{...r,...c.options},P=getMount(l);getBatch(P).items.push({key:l,value:E,relativeKey:P.relativeKey,options:S})}return Promise.all([...l.values()].map(i=>c(i))).then(i=>i.flat())},c={hasItem(i,r={}){i=normalizeKey(i);let{relativeKey:c,driver:l}=getMount(i);return asyncCall(l.hasItem,c,r)},getItem(i,r={}){i=normalizeKey(i);let{relativeKey:c,driver:l}=getMount(i);return asyncCall(l.getItem,c,r).then(i=>destr(i))},getItems:(i,r)=>runBatch(i,r,i=>i.driver.getItems?asyncCall(i.driver.getItems,i.items.map(i=>({key:i.relativeKey,options:i.options})),r).then(r=>r.map(r=>({key:function(...i){return normalizeKey(i.join(":"))}(i.base,r.key),value:destr(r.value)}))):Promise.all(i.items.map(r=>asyncCall(i.driver.getItem,r.relativeKey,r.options).then(i=>({key:r.key,value:destr(i)}))))),getItemRaw(i,r={}){i=normalizeKey(i);let{relativeKey:c,driver:l}=getMount(i);return l.getItemRaw?asyncCall(l.getItemRaw,c,r):asyncCall(l.getItem,c,r).then(i=>"string"==typeof i&&i.startsWith(D)?(checkBufferSupport(),T.from(i.slice(D.length),"base64")):i)},async setItem(i,r,l={}){if(void 0===r)return c.removeItem(i);i=normalizeKey(i);let{relativeKey:E,driver:S}=getMount(i);S.setItem&&(await asyncCall(S.setItem,E,stringify(r),l),S.watch||onChange("update",i))},async setItems(i,r){await runBatch(i,r,async i=>{if(i.driver.setItems)return asyncCall(i.driver.setItems,i.items.map(i=>({key:i.relativeKey,value:stringify(i.value),options:i.options})),r);i.driver.setItem&&await Promise.all(i.items.map(r=>asyncCall(i.driver.setItem,r.relativeKey,stringify(r.value),r.options)))})},async setItemRaw(i,r,l={}){if(void 0===r)return c.removeItem(i,l);i=normalizeKey(i);let{relativeKey:E,driver:S}=getMount(i);if(S.setItemRaw)await asyncCall(S.setItemRaw,E,r,l);else{if(!S.setItem)return;await asyncCall(S.setItem,E,function(i){if("string"==typeof i)return i;checkBufferSupport();let r=T.from(i).toString("base64");return D+r}(r),l)}S.watch||onChange("update",i)},async removeItem(i,r={}){"boolean"==typeof r&&(r={removeMeta:r}),i=normalizeKey(i);let{relativeKey:c,driver:l}=getMount(i);l.removeItem&&(await asyncCall(l.removeItem,c,r),(r.removeMeta||r.removeMata)&&await asyncCall(l.removeItem,c+"$",r),l.watch||onChange("remove",i))},async getMeta(i,r={}){"boolean"==typeof r&&(r={nativeOnly:r}),i=normalizeKey(i);let{relativeKey:c,driver:l}=getMount(i),E=Object.create(null);if(l.getMeta&&Object.assign(E,await asyncCall(l.getMeta,c,r)),!r.nativeOnly){let i=await asyncCall(l.getItem,c+"$",r).then(i=>destr(i));i&&"object"==typeof i&&("string"==typeof i.atime&&(i.atime=new Date(i.atime)),"string"==typeof i.mtime&&(i.mtime=new Date(i.mtime)),Object.assign(E,i))}return E},setMeta(i,r,c={}){return this.setItem(i+"$",r,c)},removeMeta(i,r={}){return this.removeItem(i+"$",r)},async getKeys(i,r={}){i=unstorage_d569726e_normalizeBaseKey(i);let c=getMounts(i,!0),l=[],E=[];for(let i of c){let c=await asyncCall(i.driver.getKeys,i.relativeBase,r);for(let r of c){let c=i.mountpoint+normalizeKey(r);l.some(i=>c.startsWith(i))||E.push(c)}l=[i.mountpoint,...l.filter(r=>!r.startsWith(i.mountpoint))]}return i?E.filter(r=>r.startsWith(i)&&"$"!==r[r.length-1]):E.filter(i=>"$"!==i[i.length-1])},async clear(i,r={}){i=unstorage_d569726e_normalizeBaseKey(i),await Promise.all(getMounts(i,!1).map(async i=>{if(i.driver.clear)return asyncCall(i.driver.clear,i.relativeBase,r);if(i.driver.removeItem){let c=await i.driver.getKeys(i.relativeBase||"",r);return Promise.all(c.map(c=>i.driver.removeItem(c,r)))}}))},async dispose(){await Promise.all(Object.values(r.mounts).map(i=>dispose(i)))},watch:async i=>(await startWatch(),r.watchListeners.push(i),async()=>{r.watchListeners=r.watchListeners.filter(r=>r!==i),0===r.watchListeners.length&&await stopWatch()}),async unwatch(){r.watchListeners=[],await stopWatch()},mount(i,l){if((i=unstorage_d569726e_normalizeBaseKey(i))&&r.mounts[i])throw Error(`already mounted at ${i}`);return i&&(r.mountpoints.push(i),r.mountpoints.sort((i,r)=>r.length-i.length)),r.mounts[i]=l,r.watching&&Promise.resolve(watch(l,onChange,i)).then(c=>{r.unwatch[i]=c}).catch(console.error),c},async unmount(i,c=!0){(i=unstorage_d569726e_normalizeBaseKey(i))&&r.mounts[i]&&(r.watching&&i in r.unwatch&&(r.unwatch[i](),delete r.unwatch[i]),c&&await dispose(r.mounts[i]),r.mountpoints=r.mountpoints.filter(r=>r!==i),delete r.mounts[i])},getMount(i=""){i=normalizeKey(i)+":";let r=getMount(i);return{driver:r.driver,base:r.base}},getMounts(i="",r={}){i=normalizeKey(i);let c=getMounts(i,r.parents);return c.map(i=>({driver:i.driver,base:i.mountpoint}))},keys:(i,r={})=>c.getKeys(i,r),get:(i,r={})=>c.getItem(i,r),set:(i,r,l={})=>c.setItem(i,r,l),has:(i,r={})=>c.hasItem(i,r),del:(i,r={})=>c.removeItem(i,r),remove:(i,r={})=>c.removeItem(i,r)};return c}({driver:z({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(i=>[i.key,i.value])}async getItem(i){let r=await this.indexedDb.getItem(i);if(null!==r)return r}async setItem(i,r){await this.indexedDb.setItem(i,(0,M.u)(r))}async removeItem(i){await this.indexedDb.removeItem(i)}};var U="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof c.g?c.g:"u">typeof self?self:{},B={exports:{}};function k(i){var r;return[i[0],(0,M.D)(null!=(r=i[1])?r:"")]}!function(){function t(){}t.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},t.prototype.setItem=function(i,r){this[i]=String(r)},t.prototype.removeItem=function(i){delete this[i]},t.prototype.clear=function(){let i=this;Object.keys(i).forEach(function(r){i[r]=void 0,delete i[r]})},t.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),"u">typeof U&&U.localStorage?B.exports=U.localStorage:"u">typeof window&&window.localStorage?B.exports=window.localStorage:B.exports=new t}();let K=class K{constructor(){this.localStorage=B.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(k)}async getItem(i){let r=this.localStorage.getItem(i);if(null!==r)return(0,M.D)(r)}async setItem(i,r){this.localStorage.setItem(i,(0,M.u)(r))}async removeItem(i){this.localStorage.removeItem(i)}};let O=async(i,r,c)=>{let l="wc_storage_version",E=await r.getItem(l);if(E&&E>=1){c(r);return}let S=await i.getKeys();if(!S.length){c(r);return}let P=[];for(;S.length;){let c=S.shift();if(!c)continue;let l=c.toLowerCase();if(l.includes("wc@")||l.includes("walletconnect")||l.includes("wc_")||l.includes("wallet_connect")){let l=await i.getItem(c);await r.setItem(c,l),P.push(c)}}await r.setItem(l,1),c(r),j(i,P)},j=async(i,r)=>{r.length&&r.forEach(async r=>{await i.removeItem(r)})};let h=class h{constructor(){this.initialized=!1,this.setInitialized=i=>{this.storage=i,this.initialized=!0};let i=new K;this.storage=i;try{let r=new _;O(i,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(i){return await this.initialize(),this.storage.getItem(i)}async setItem(i,r){return await this.initialize(),this.storage.setItem(i,r)}async removeItem(i){return await this.initialize(),this.storage.removeItem(i)}async initialize(){this.initialized||await new Promise(i=>{let r=setInterval(()=>{this.initialized&&(clearInterval(r),i())},20)})}};var F=c(66736);let IEvents=class IEvents{};let n=class n extends IEvents{constructor(i){super()}};let J=F.FIVE_SECONDS,X={pulse:"heartbeat_pulse"};let index_es_i=class index_es_i extends n{constructor(i){super(i),this.events=new E.EventEmitter,this.interval=J,this.interval=i?.interval||J}static async init(i){let r=new index_es_i(i);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),(0,F.toMiliseconds)(this.interval))}pulse(){this.events.emit(X.pulse)}};var ee=c(12044);let index_es_n=class index_es_n extends IEvents{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}};let index_es_h=class index_es_h extends IEvents{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}};let a=class a{constructor(i,r){this.logger=i,this.core=r}};let u=class u extends IEvents{constructor(i,r){super(),this.relayer=i,this.logger=r}};let g=class g extends IEvents{constructor(i){super()}};let p=class p{constructor(i,r,c,l){this.core=i,this.logger=r,this.name=c}};let d=class d extends IEvents{constructor(i,r){super(),this.relayer=i,this.logger=r}};let index_es_E=class index_es_E extends IEvents{constructor(i,r){super(),this.core=i,this.logger=r}};let index_es_y=class index_es_y{constructor(i,r){this.projectId=i,this.logger=r}};let v=class v{constructor(i,r){this.projectId=i,this.logger=r}};let b=class b{constructor(i){this.opts=i,this.protocol="wc",this.version=2}};let w=class w{constructor(i){this.client=i}};var et=c(31050),ea=c(31416);let eo="base64url",ec="base58btc";function as_uint8array_asUint8Array(i){return null!=globalThis.Buffer?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function allocUnsafe(i=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?as_uint8array_asUint8Array(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}var eh=c(91835);function createCodec(i,r,c,l){return{name:i,prefix:r,encoder:{name:i,prefix:r,encode:c},decoder:{decode:l}}}let el=createCodec("utf8","u",i=>{let r=new TextDecoder("utf8");return"u"+r.decode(i)},i=>{let r=new TextEncoder;return r.encode(i.substring(1))}),ep=createCodec("ascii","a",i=>{let r="a";for(let c=0;c<i.length;c++)r+=String.fromCharCode(i[c]);return r},i=>{i=i.substring(1);let r=allocUnsafe(i.length);for(let c=0;c<i.length;c++)r[c]=i.charCodeAt(c);return r}),ed={utf8:el,"utf-8":el,hex:eh.gh.base16,latin1:ep,ascii:ep,binary:ep,...eh.gh};function to_string_toString(i,r="utf8"){let c=ed[r];if(!c)throw Error(`Unsupported encoding "${r}"`);return("utf8"===r||"utf-8"===r)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):c.encoder.encode(i).substring(1)}function from_string_fromString(i,r="utf8"){let c=ed[r];if(!c)throw Error(`Unsupported encoding "${r}"`);return("utf8"===r||"utf-8"===r)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?as_uint8array_asUint8Array(globalThis.Buffer.from(i,"utf-8")):c.decoder.decode(`${c.prefix}${i}`)}function encodeJSON(i){return to_string_toString(from_string_fromString((0,M.u)(i),"utf8"),eo)}function encodeIss(i){let r=from_string_fromString("K36",ec),c="z"+to_string_toString(function(i,r){r||(r=i.reduce((i,r)=>i+r.length,0));let c=allocUnsafe(r),l=0;for(let r of i)c.set(r,l),l+=r.length;return as_uint8array_asUint8Array(c)}([r,i]),ec);return["did","key",c].join(":")}function generateKeyPair(i=(0,ea.randomBytes)(32)){return et._w(i)}async function signJWT(i,r,c,l,E=(0,F.fromMiliseconds)(Date.now())){var S,P;let C={alg:"EdDSA",typ:"JWT"},A=encodeIss(l.publicKey),q={iss:A,sub:i,aud:r,iat:E,exp:E+c},T=from_string_fromString([encodeJSON((S={header:C,payload:q}).header),encodeJSON(S.payload)].join("."),"utf8"),D=et.Xx(l.secretKey,T);return[encodeJSON((P={header:C,payload:q,signature:D}).header),encodeJSON(P.payload),to_string_toString(P.signature,eo)].join(".")}c(43014);var ef=c(46514),eg=c(94622),ey=c(64534),em=c(56186);let index_es_b=()=>"u">typeof WebSocket||"u">typeof c.g&&"u">typeof c.g.WebSocket||"u">typeof window&&"u">typeof window.WebSocket||"u">typeof self&&"u">typeof self.WebSocket,index_es_a=i=>i.split("?")[0],e_="u">typeof WebSocket?WebSocket:"u">typeof c.g&&"u">typeof c.g.WebSocket?c.g.WebSocket:"u">typeof window&&"u">typeof window.WebSocket?window.WebSocket:"u">typeof self&&"u">typeof self.WebSocket?self.WebSocket:c(72030);let f=class f{constructor(i){if(this.url=i,this.events=new E.EventEmitter,this.registering=!1,!(0,em.isWsUrl)(i))throw Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return"u">typeof this.socket}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),i()},this.socket.close()})}async send(i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send((0,M.u)(i))}catch(r){this.onError(i.id,r)}}register(i=this.url){if(!(0,em.isWsUrl)(i))throw Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){let i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((i,r)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),r(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return r(Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,c)=>{let l=new URLSearchParams(i).get("origin"),E=(0,em.isReactNative)()?{headers:{origin:l}}:{rejectUnauthorized:!(0,em.isLocalhostUrl)(i)},S=new e_(i,[],E);index_es_b()?S.onerror=i=>{c(this.emitError(i.error))}:S.on("error",i=>{c(this.emitError(i))}),S.onopen=()=>{this.onOpen(S),r(S)}})}onOpen(i){i.onmessage=i=>this.onPayload(i),i.onclose=i=>this.onClose(i),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;let r="string"==typeof i.data?(0,M.D)(i.data):i.data;this.events.emit("payload",r)}onError(i,r){let c=this.parseError(r),l=c.message||c.toString(),E=(0,em.formatJsonRpcError)(i,l);this.events.emit("payload",E)}parseError(i,r=this.url){return(0,em.parseConnectionError)(i,index_es_a(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(i){let r=this.parseError(Error(i?.message||`WebSocket connection failed for host: ${index_es_a(this.url)}`));return this.events.emit("register_error",r),r}};var ew=c(72307),eb=c.n(ew),eI=c(63144),eE=c.n(eI),ex=c(34155),Xi=function(i,r){if(i.length>=255)throw TypeError("Alphabet too long");for(var c=new Uint8Array(256),l=0;l<c.length;l++)c[l]=255;for(var E=0;E<i.length;E++){var S=i.charAt(E),P=S.charCodeAt(0);if(255!==c[P])throw TypeError(S+" is ambiguous");c[P]=E}var C=i.length,A=i.charAt(0),q=Math.log(C)/Math.log(256),T=Math.log(256)/Math.log(C);function m(i){if("string"!=typeof i)throw TypeError("Expected String");if(0===i.length)return new Uint8Array;var r=0;if(" "!==i[0]){for(var l=0,E=0;i[r]===A;)l++,r++;for(var S=(i.length-r)*q+1>>>0,P=new Uint8Array(S);i[r];){var T=c[i.charCodeAt(r)];if(255===T)return;for(var D=0,M=S-1;(0!==T||D<E)&&-1!==M;M--,D++)T+=C*P[M]>>>0,P[M]=T%256>>>0,T=T/256>>>0;if(0!==T)throw Error("Non-zero carry");E=D,r++}if(" "!==i[r]){for(var U=S-E;U!==S&&0===P[U];)U++;for(var B=new Uint8Array(l+(S-U)),F=l;U!==S;)B[F++]=P[U++];return B}}}return{encode:function(r){if(r instanceof Uint8Array||(ArrayBuffer.isView(r)?r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength):Array.isArray(r)&&(r=Uint8Array.from(r))),!(r instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===r.length)return"";for(var c=0,l=0,E=0,S=r.length;E!==S&&0===r[E];)E++,c++;for(var P=(S-E)*T+1>>>0,q=new Uint8Array(P);E!==S;){for(var D=r[E],M=0,U=P-1;(0!==D||M<l)&&-1!==U;U--,M++)D+=256*q[U]>>>0,q[U]=D%C>>>0,D=D/C>>>0;if(0!==D)throw Error("Non-zero carry");l=M,E++}for(var B=P-l;B!==P&&0===q[B];)B++;for(var F=A.repeat(c);B<P;++B)F+=i.charAt(q[B]);return F},decodeUnsafe:m,decode:function(i){var c=m(i);if(c)return c;throw Error(`Non-${r} character`)}}};let Ue=i=>{if(i instanceof Uint8Array&&"Uint8Array"===i.constructor.name)return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw Error("Unknown type, must be binary type")},Wi=i=>new TextEncoder().encode(i),Qi=i=>new TextDecoder().decode(i);let Zi=class Zi{constructor(i,r,c){this.name=i,this.prefix=r,this.baseEncode=c}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}};let es=class es{constructor(i,r,c){if(this.name=i,this.prefix=r,void 0===r.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=c}decode(i){if("string"==typeof i){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(i){return Fe(this,i)}};let ts=class ts{constructor(i){this.decoders=i}or(i){return Fe(this,i)}decode(i){let r=i[0],c=this.decoders[r];if(c)return c.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};let Fe=(i,r)=>new ts({...i.decoders||{[i.prefix]:i},...r.decoders||{[r.prefix]:r}});let is=class is{constructor(i,r,c,l){this.name=i,this.prefix=r,this.baseEncode=c,this.baseDecode=l,this.encoder=new Zi(i,r,c),this.decoder=new es(i,r,l)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}};let Q=({name:i,prefix:r,encode:c,decode:l})=>new is(i,r,c,l),V=({prefix:i,name:r,alphabet:c})=>{let{encode:l,decode:E}=Xi(c,r);return Q({prefix:i,name:r,encode:l,decode:i=>Ue(E(i))})},ss=(i,r,c,l)=>{let E={};for(let i=0;i<r.length;++i)E[r[i]]=i;let S=i.length;for(;"="===i[S-1];)--S;let P=new Uint8Array(S*c/8|0),C=0,A=0,q=0;for(let r=0;r<S;++r){let S=E[i[r]];if(void 0===S)throw SyntaxError(`Non-${l} character`);A=A<<c|S,(C+=c)>=8&&(C-=8,P[q++]=255&A>>C)}if(C>=c||255&A<<8-C)throw SyntaxError("Unexpected end of data");return P},rs=(i,r,c)=>{let l="="===r[r.length-1],E=(1<<c)-1,S="",P=0,C=0;for(let l=0;l<i.length;++l)for(C=C<<8|i[l],P+=8;P>c;)P-=c,S+=r[E&C>>P];if(P&&(S+=r[E&C<<c-P]),l)for(;S.length*c&7;)S+="=";return S},dist_index_es_y=({name:i,prefix:r,bitsPerChar:c,alphabet:l})=>Q({prefix:r,name:i,encode:i=>rs(i,l,c),decode:r=>ss(r,l,c,i)}),eS=Q({prefix:"\x00",name:"identity",encode:i=>Qi(i),decode:i=>Wi(i)});var eP=Object.freeze({__proto__:null,identity:eS});let eC=dist_index_es_y({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var eR=Object.freeze({__proto__:null,base2:eC});let eO=dist_index_es_y({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var eA=Object.freeze({__proto__:null,base8:eO});let eN=V({prefix:"9",name:"base10",alphabet:"0123456789"});var eT=Object.freeze({__proto__:null,base10:eN});let eD=dist_index_es_y({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),ek=dist_index_es_y({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ej=Object.freeze({__proto__:null,base16:eD,base16upper:ek});let eM=dist_index_es_y({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),ez=dist_index_es_y({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),eL=dist_index_es_y({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),e$=dist_index_es_y({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),eH=dist_index_es_y({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),eU=dist_index_es_y({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),eK=dist_index_es_y({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),eV=dist_index_es_y({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eB=dist_index_es_y({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var eW=Object.freeze({__proto__:null,base32:eM,base32upper:ez,base32pad:eL,base32padupper:e$,base32hex:eH,base32hexupper:eU,base32hexpad:eK,base32hexpadupper:eV,base32z:eB});let eF=V({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),eG=V({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var eJ=Object.freeze({__proto__:null,base36:eF,base36upper:eG});let eY=V({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),eZ=V({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var eQ=Object.freeze({__proto__:null,base58btc:eY,base58flickr:eZ});let eX=dist_index_es_y({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),e0=dist_index_es_y({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),e1=dist_index_es_y({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),e5=dist_index_es_y({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var e6=Object.freeze({__proto__:null,base64:eX,base64pad:e0,base64url:e1,base64urlpad:e5});let e2=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),e3=e2.reduce((i,r,c)=>(i[c]=r,i),[]),e4=e2.reduce((i,r,c)=>(i[r.codePointAt(0)]=c,i),[]),e9=Q({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(i){return i.reduce((i,r)=>i+=e3[r],"")},decode:function(i){let r=[];for(let c of i){let i=e4[c.codePointAt(0)];if(void 0===i)throw Error(`Non-base256emoji character: ${c}`);r.push(i)}return new Uint8Array(r)}});var e8=Object.freeze({__proto__:null,base256emoji:e9});function Me(i,r,c){r=r||[],c=c||0;for(var l=c;i>=2147483648;)r[c++]=255&i|128,i/=128;for(;-128&i;)r[c++]=255&i|128,i>>>=7;return r[c]=0|i,Me.bytes=c-l+1,r}function de(i,r){var c,l=0,r=r||0,E=0,S=r,P=i.length;do{if(S>=P)throw de.bytes=0,RangeError("Could not decode varint");c=i[S++],l+=E<28?(127&c)<<E:(127&c)*Math.pow(2,E),E+=7}while(c>=128);return de.bytes=S-r,l}var e7={encode:Me,decode:de,encodingLength:function(i){return i<128?1:i<16384?2:i<2097152?3:i<268435456?4:i<34359738368?5:i<4398046511104?6:i<562949953421312?7:i<72057594037927940?8:i<0x7fffffffffffffff?9:10}};let Ve=(i,r,c=0)=>(e7.encode(i,r,c),r),qe=i=>e7.encodingLength(i),ge=(i,r)=>{let c=r.byteLength,l=qe(i),E=l+qe(c),S=new Uint8Array(E+c);return Ve(i,S,0),Ve(c,S,l),S.set(r,E),new or(i,c,r,S)};let or=class or{constructor(i,r,c,l){this.code=i,this.size=r,this.digest=c,this.bytes=l}};let je=({name:i,code:r,encode:c})=>new ar(i,r,c);let ar=class ar{constructor(i,r,c){this.name=i,this.code=r,this.encode=c}digest(i){if(i instanceof Uint8Array){let r=this.encode(i);return r instanceof Uint8Array?ge(this.code,r):r.then(i=>ge(this.code,i))}throw Error("Unknown type, must be binary type")}};let Ge=i=>async r=>new Uint8Array(await crypto.subtle.digest(i,r)),te=je({name:"sha2-256",code:18,encode:Ge("SHA-256")}),tn=je({name:"sha2-512",code:19,encode:Ge("SHA-512")});var to=Object.freeze({__proto__:null,sha256:te,sha512:tn}),tc=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:Ue,digest:i=>ge(0,Ue(i))}});new TextEncoder,new TextDecoder;let th={...eP,...eR,...eA,...eT,...ej,...eW,...eJ,...eQ,...e6,...e8};function Xe(i,r,c,l){return{name:i,prefix:r,encoder:{name:i,prefix:r,encode:c},decoder:{decode:l}}}({...to,...tc});let tl=Xe("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),tp=Xe("ascii","a",i=>{let r="a";for(let c=0;c<i.length;c++)r+=String.fromCharCode(i[c]);return r},i=>{i=i.substring(1);let r=function(i=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(i):new Uint8Array(i)}(i.length);for(let c=0;c<i.length;c++)r[c]=i.charCodeAt(c);return r}),td={utf8:tl,"utf-8":tl,hex:th.base16,latin1:tp,ascii:tp,binary:tp,...th},tg="core",ty=`wc@2:${tg}:`,tm={logger:"error"},t_={database:":memory:"},tw="client_ed25519_seed",tb=F.ONE_DAY,tI=F.SIX_HOURS,tE="wss://relay.walletconnect.com",tx="wss://relay.walletconnect.org",tS={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",publish:"relayer_publish"},tP={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},tC=F.ONE_SECOND,tR={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},tO=1e3*F.FIVE_SECONDS,tA={wc_pairingDelete:{req:{ttl:F.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:F.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:F.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:F.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:F.ONE_DAY,prompt:!1,tag:0},res:{ttl:F.ONE_DAY,prompt:!1,tag:0}}},tq={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},tN={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},tT={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},tD="verify-api",tk="https://verify.walletconnect.com",tj="https://verify.walletconnect.org",tM=[tk,tj];let xt=class xt{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name="keychain",this.version="0.3",this.initialized=!1,this.storagePrefix=ty,this.init=async()=>{if(!this.initialized){let i=await this.getKeyChain();"u">typeof i&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,r)=>{this.isInitialized(),this.keychain.set(i,r),await this.persist()},this.get=i=>{this.isInitialized();let r=this.keychain.get(i);if(typeof r>"u"){let{message:r}=(0,ef.kCb)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw Error(r)}return r},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=i,this.logger=(0,ee.Ep)(r,this.name)}get context(){return(0,ee.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,(0,ef.KCv)(i))}async getKeyChain(){let i=await this.core.storage.getItem(this.storageKey);return"u">typeof i?(0,ef.IPd)(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}};let Ot=class Ot{constructor(i,r,c){this.core=i,this.logger=r,this.name="crypto",this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();let i=await this.getClientSeed(),r=generateKeyPair(i);return encodeIss(r.publicKey)},this.generateKeyPair=()=>{this.isInitialized();let i=(0,ef.Au2)();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();let r=await this.getClientSeed(),c=generateKeyPair(r),l=(0,ef.jdp)();return await signJWT(l,i,tb,c)},this.generateSharedKey=(i,r,c)=>{this.isInitialized();let l=this.getPrivateKey(i),E=(0,ef.m$A)(l,r);return this.setSymKey(E,c)},this.setSymKey=async(i,r)=>{this.isInitialized();let c=r||(0,ef.YmJ)(i);return await this.keychain.set(c,i),c},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,r,c)=>{this.isInitialized();let l=(0,ef.ENt)(c),E=(0,M.u)(r);if((0,ef.Q8x)(l)){let r=l.senderPublicKey,c=l.receiverPublicKey;i=await this.generateSharedKey(r,c)}let S=this.getSymKey(i),{type:P,senderPublicKey:C}=l;return(0,ef.HIp)({type:P,symKey:S,message:E,senderPublicKey:C})},this.decode=async(i,r,c)=>{this.isInitialized();let l=(0,ef.Llj)(r,c);if((0,ef.Q8x)(l)){let r=l.receiverPublicKey,c=l.senderPublicKey;i=await this.generateSharedKey(r,c)}try{let c=this.getSymKey(i),l=(0,ef.peR)({symKey:c,encoded:r});return(0,M.D)(l)}catch(r){this.logger.error(`Failed to decode message from topic: '${i}', clientId: '${await this.getClientId()}'`),this.logger.error(r)}},this.getPayloadType=i=>{let r=(0,ef.vBi)(i);return(0,ef.WGe)(r.type)},this.getPayloadSenderPublicKey=i=>{let r=(0,ef.vBi)(i);return r.senderPublicKey?(0,eg.BB)(r.senderPublicKey,ef.AWt):void 0},this.core=i,this.logger=(0,ee.Ep)(r,this.name),this.keychain=c||new xt(this.core,this.logger)}get context(){return(0,ee.Fd)(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(tw)}catch{i=(0,ef.jdp)(),await this.keychain.set(tw,i)}return function(i,r="utf8"){let c=td[r];if(!c)throw Error(`Unsupported encoding "${r}"`);return("utf8"===r||"utf-8"===r)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(i,"utf8"):c.decoder.decode(`${c.prefix}${i}`)}(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}};let At=class At extends a{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name="messages",this.version="0.3",this.initialized=!1,this.storagePrefix=ty,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let i=await this.getRelayerMessages();"u">typeof i&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,r)=>{this.isInitialized();let c=(0,ef.rjm)(r),l=this.messages.get(i);return typeof l>"u"&&(l={}),"u">typeof l[c]||(l[c]=r,this.messages.set(i,l),await this.persist()),c},this.get=i=>{this.isInitialized();let r=this.messages.get(i);return typeof r>"u"&&(r={}),r},this.has=(i,r)=>{this.isInitialized();let c=this.get(i),l=(0,ef.rjm)(r);return"u">typeof c[l]},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=(0,ee.Ep)(i,this.name),this.core=r}get context(){return(0,ee.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,(0,ef.KCv)(i))}async getRelayerMessages(){let i=await this.core.storage.getItem(this.storageKey);return"u">typeof i?(0,ef.IPd)(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}};let vr=class vr extends u{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new E.EventEmitter,this.name="publisher",this.queue=new Map,this.publishTimeout=(0,F.toMiliseconds)(F.ONE_MINUTE),this.failedPublishTimeout=(0,F.toMiliseconds)(F.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(i,r,c)=>{var l;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:r,opts:c}});let E=c?.ttl||tI,S=(0,ef._HE)(c),P=c?.prompt||!1,C=c?.tag||0,A=c?.id||(0,em.getBigIntRpcId)().toString(),q={topic:i,message:r,opts:{ttl:E,relay:S,prompt:P,tag:C,id:A}},T=`Failed to publish payload, please try again. id:${A} tag:${C}`,D=Date.now(),M,U=1;try{for(;void 0===M;){if(Date.now()-D>this.publishTimeout)throw Error(T);this.logger.trace({id:A,attempts:U},`publisher.publish - attempt ${U}`),M=await await (0,ef.hFY)(this.rpcPublish(i,r,E,S,P,C,A).catch(i=>this.logger.warn(i)),this.publishTimeout,T),U++,M||await new Promise(i=>setTimeout(i,this.failedPublishTimeout))}this.relayer.events.emit(tS.publish,q),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:A,topic:i,message:r,opts:c}})}catch(i){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(i),null!=(l=c?.internal)&&l.throwOnFailedPublish)throw i;this.queue.set(A,q)}},this.on=(i,r)=>{this.events.on(i,r)},this.once=(i,r)=>{this.events.once(i,r)},this.off=(i,r)=>{this.events.off(i,r)},this.removeListener=(i,r)=>{this.events.removeListener(i,r)},this.relayer=i,this.logger=(0,ee.Ep)(r,this.name),this.registerEventListeners()}get context(){return(0,ee.Fd)(this.logger)}rpcPublish(i,r,c,l,E,S,P){var C,A,q,T;let D={method:(0,ef.cOS)(l.protocol).publish,params:{topic:i,message:r,ttl:c,prompt:E,tag:S},id:P};return(0,ef.o8e)(null==(C=D.params)?void 0:C.prompt)&&(null==(A=D.params)||delete A.prompt),(0,ef.o8e)(null==(q=D.params)?void 0:q.tag)&&(null==(T=D.params)||delete T.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:D}),this.relayer.request(D)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{let{topic:r,message:c,opts:l}=i;await this.publish(r,c,l)})}registerEventListeners(){this.relayer.core.heartbeat.on(X.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(tS.connection_stalled);return}this.checkQueue()}),this.relayer.on(tS.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}};let Ir=class Ir{constructor(){this.map=new Map,this.set=(i,r)=>{let c=this.get(i);this.exists(i,r)||this.map.set(i,[...c,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;let c=this.get(i);if(!this.exists(i,r))return;let l=c.filter(i=>i!==r);if(!l.length){this.map.delete(i);return}this.map.set(i,l)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}};var tz=Object.defineProperty,tL=Object.defineProperties,t$=Object.getOwnPropertyDescriptors,tH=Object.getOwnPropertySymbols,tU=Object.prototype.hasOwnProperty,tK=Object.prototype.propertyIsEnumerable,Nt=(i,r,c)=>r in i?tz(i,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[r]=c,index_es_j=(i,r)=>{for(var c in r||(r={}))tU.call(r,c)&&Nt(i,c,r[c]);if(tH)for(var c of tH(r))tK.call(r,c)&&Nt(i,c,r[c]);return i},fe=(i,r)=>tL(i,t$(r));let Lt=class Lt extends d{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new Ir,this.events=new E.EventEmitter,this.name="subscription",this.version="0.3",this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=ty,this.subscribeTimeout=(0,F.toMiliseconds)(F.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(i,r)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:r}});try{let c=(0,ef._HE)(r),l={topic:i,relay:c};this.pending.set(i,l);let E=await this.rpcSubscribe(i,c);return"string"==typeof E&&(this.onSubscribe(E,l),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:r}})),E}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}},this.unsubscribe=async(i,r)=>{await this.restartToComplete(),this.isInitialized(),"u">typeof r?.id?await this.unsubscribeById(i,r.id,r):await this.unsubscribeByTopic(i,r)},this.isSubscribed=async i=>{if(this.topics.includes(i))return!0;let r=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((c,l)=>{let E=new F.Watch;E.start(r);let S=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(S),E.stop(r),c(!0)),E.elapsed(r)>=tO&&(clearInterval(S),E.stop(r),l(Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(i,r)=>{this.events.on(i,r)},this.once=(i,r)=>{this.events.once(i,r)},this.off=(i,r)=>{this.events.off(i,r)},this.removeListener=(i,r)=>{this.events.removeListener(i,r)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=(0,ee.Ep)(r,this.name),this.clientId=""}get context(){return(0,ee.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let c=!1;try{c=this.getSubscription(i).topic===r}catch{}return c}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){let c=this.topicMap.get(i);await Promise.all(c.map(async c=>await this.unsubscribeById(i,c,r)))}async unsubscribeById(i,r,c){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:c}});try{let l=(0,ef._HE)(c);await this.rpcUnsubscribe(i,r,l);let E=(0,ef.D6H)("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,E),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:c}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(i,r){let c={method:(0,ef.cOS)(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:c});try{return await await (0,ef.hFY)(this.relayer.request(c).catch(i=>this.logger.warn(i)),this.subscribeTimeout)?(0,ef.rjm)(i+this.clientId):null}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(tS.connection_stalled)}return null}async rpcBatchSubscribe(i){if(!i.length)return;let r=i[0].relay,c={method:(0,ef.cOS)(r.protocol).batchSubscribe,params:{topics:i.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:c});try{return await await (0,ef.hFY)(this.relayer.request(c).catch(i=>this.logger.warn(i)),this.subscribeTimeout)}catch{this.relayer.events.emit(tS.connection_stalled)}}async rpcBatchFetchMessages(i){let r;if(!i.length)return;let c=i[0].relay,l={method:(0,ef.cOS)(c.protocol).batchFetchMessages,params:{topics:i.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:l});try{r=await await (0,ef.hFY)(this.relayer.request(l).catch(i=>this.logger.warn(i)),this.subscribeTimeout)}catch{this.relayer.events.emit(tS.connection_stalled)}return r}rpcUnsubscribe(i,r,c){let l={method:(0,ef.cOS)(c.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:l}),this.relayer.request(l)}onSubscribe(i,r){this.setSubscription(i,fe(index_es_j({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(i=>{this.setSubscription(i.id,index_es_j({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(i,r,c){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,c),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r)}addSubscription(i,r){this.subscriptions.set(i,index_es_j({},r)),this.topicMap.set(r.topic,i),this.events.emit(tR.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});let r=this.subscriptions.get(i);if(!r){let{message:r}=(0,ef.kCb)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw Error(r)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});let c=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(c.topic,i),this.events.emit(tR.deleted,fe(index_es_j({},c),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(tR.sync)}async reset(){if(this.cached.length){let i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){let i=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(i),await this.batchSubscribe(i)}}this.events.emit(tR.resubscribed)}async restore(){try{let i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){let{message:i}=(0,ef.kCb)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(i)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;let r=await this.rpcBatchSubscribe(i);(0,ef.qt8)(r)&&this.onBatchSubscribe(r.map((r,c)=>fe(index_es_j({},i[c]),{id:r})))}async batchFetchMessages(i){if(!i.length)return;this.logger.trace(`Fetching batch messages for ${i.length} subscriptions`);let r=await this.rpcBatchFetchMessages(i);r&&r.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(r.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;let i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(X.pulse,async()=>{await this.checkPending()}),this.events.on(tR.created,async i=>{let r=tR.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(tR.deleted,async i=>{let r=tR.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{let r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}};var tV=Object.defineProperty,tB=Object.getOwnPropertySymbols,tW=Object.prototype.hasOwnProperty,tF=Object.prototype.propertyIsEnumerable,Ft=(i,r,c)=>r in i?tV(i,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[r]=c,Ar=(i,r)=>{for(var c in r||(r={}))tW.call(r,c)&&Ft(i,c,r[c]);if(tB)for(var c of tB(r))tF.call(r,c)&&Ft(i,c,r[c]);return i};let $t=class $t extends g{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new E.EventEmitter,this.name="relayer",this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=(0,F.toMiliseconds)(F.THIRTY_SECONDS+F.ONE_SECOND),this.request=async i=>{var r,c;this.logger.debug("Publishing Request Payload");let l=i.id||(0,em.getBigIntRpcId)().toString();await this.toEstablishConnection();try{let E=this.provider.request(i);this.requestsInFlight.set(l,{promise:E,request:i}),this.logger.trace({id:l,method:i.method,topic:null==(r=i.params)?void 0:r.topic},"relayer.request - attempt to publish...");let S=await new Promise(async(i,r)=>{let d=()=>{r(Error(`relayer.request - publish interrupted, id: ${l}`))};this.provider.on(tP.disconnect,d);let c=await E;this.provider.off(tP.disconnect,d),i(c)});return this.logger.trace({id:l,method:i.method,topic:null==(c=i.params)?void 0:c.topic},"relayer.request - published"),S}catch(i){throw this.logger.debug(`Failed to Publish Request: ${l}`),i}finally{this.requestsInFlight.delete(l)}},this.resetPingTimeout=()=>{if((0,ef.UGU)())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var i,r,c;null==(c=null==(r=null==(i=this.provider)?void 0:i.connection)?void 0:r.socket)||c.terminate()},this.heartBeatTimeout)}catch(i){this.logger.warn(i)}},this.onPayloadHandler=i=>{this.onProviderPayload(i),this.resetPingTimeout()},this.onConnectHandler=()=>{this.startPingTimeout(),this.events.emit(tS.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=i=>{this.logger.error(i),this.events.emit(tS.error,i),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(tP.payload,this.onPayloadHandler),this.provider.on(tP.connect,this.onConnectHandler),this.provider.on(tP.disconnect,this.onDisconnectHandler),this.provider.on(tP.error,this.onProviderErrorHandler)},this.core=i.core,this.logger="u">typeof i.logger&&"string"!=typeof i.logger?(0,ee.Ep)(i.logger,this.name):(0,ee.gw)((0,ee.jI)({level:i.logger||"error"})),this.messages=new At(this.logger,i.core),this.subscriber=new Lt(this,this.logger),this.publisher=new vr(this,this.logger),this.relayUrl=i?.relayUrl||tE,this.projectId=i.projectId,this.bundleId=(0,ef.X_B)(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${tx}...`),await this.restartTransport(tx)}this.initialized=!0,setTimeout(async()=>{0===this.subscriber.topics.length&&0===this.subscriber.pending.size&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},1e4)}get context(){return(0,ee.Fd)(this.logger)}get connected(){var i,r,c;return(null==(c=null==(r=null==(i=this.provider)?void 0:i.connection)?void 0:r.socket)?void 0:c.readyState)===1}get connecting(){var i,r,c;return(null==(c=null==(r=null==(i=this.provider)?void 0:i.connection)?void 0:r.socket)?void 0:c.readyState)===0}async publish(i,r,c){this.isInitialized(),await this.publisher.publish(i,r,c),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var c;this.isInitialized();let l=(null==(c=this.subscriber.topicMap.get(i))?void 0:c[0])||"",E,n=r=>{r.topic===i&&(this.subscriber.off(tR.created,n),E())};return await Promise.all([new Promise(i=>{E=i,this.subscriber.on(tR.created,n)}),new Promise(async c=>{l=await this.subscriber.subscribe(i,r)||l,c()})]),l}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(i=>i.promise))}catch(i){this.logger.warn(i)}this.hasExperiencedNetworkDisruption||this.connected?await (0,ef.hFY)(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(i){await this.confirmOnlineStateOrThrow(),i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(i,r)=>{let s=()=>{this.provider.off(tP.disconnect,s),r(Error("Connection interrupted while trying to subscribe"))};this.provider.on(tP.disconnect,s),await (0,ef.hFY)(this.provider.connect(),(0,F.toMiliseconds)(F.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(i=>{r(i)}),await this.subscriber.start(),this.hasExperiencedNetworkDisruption=!1,i()})}catch(i){if(this.logger.error(i),this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(i.message))throw i}finally{this.connectionAttemptInProgress=!1}}async restartTransport(i){this.connectionAttemptInProgress||(this.relayUrl=i||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await (0,ef.Ggh)())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(i){if(i?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}let r=i.sort((i,r)=>i.publishedAt-r.publishedAt);for(let i of(this.logger.trace(`Batch of ${r.length} message events sorted`),r))try{await this.onMessageEvent(i)}catch(i){this.logger.warn(i)}this.logger.trace(`Batch of ${r.length} message events processed`)}startPingTimeout(){var i,r,c,l,E;if((0,ef.UGU)())try{null!=(r=null==(i=this.provider)?void 0:i.connection)&&r.socket&&(null==(E=null==(l=null==(c=this.provider)?void 0:c.connection)?void 0:l.socket)||E.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(i){this.logger.warn(i)}}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new ey.r(new f((0,ef.$0m)({sdkVersion:"2.13.0",protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(i){let{topic:r,message:c}=i;await this.messages.set(r,c)}async shouldIgnoreMessageEvent(i){let{topic:r,message:c}=i;if(!c||0===c.length)return this.logger.debug(`Ignoring invalid/empty message: ${c}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;let l=this.messages.has(r,c);return l&&this.logger.debug(`Ignoring duplicate message: ${c}`),l}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),(0,em.isJsonRpcRequest)(i)){if(!i.method.endsWith("_subscription"))return;let r=i.params,{topic:c,message:l,publishedAt:E}=r.data,S={topic:c,message:l,publishedAt:E};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ar({type:"event",event:r.id},S)),this.events.emit(r.id,S),await this.acknowledgePayload(i),await this.onMessageEvent(S)}else(0,em.isJsonRpcResponse)(i)&&this.events.emit(tS.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(tS.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){let r=(0,em.formatJsonRpcResult)(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(tP.payload,this.onPayloadHandler),this.provider.off(tP.connect,this.onConnectHandler),this.provider.off(tP.disconnect,this.onDisconnectHandler),this.provider.off(tP.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let i=await (0,ef.Ggh)();(0,ef.uwg)(async r=>{i!==r&&(i=r,r?await this.restartTransport().catch(i=>this.logger.error(i)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit(tS.disconnect),this.connectionAttemptInProgress=!1,this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen().catch(i=>this.logger.error(i))},(0,F.toMiliseconds)(tC))}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),this.connected||(this.connectionAttemptInProgress&&await new Promise(i=>{let r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)}),await this.transportOpen())}};var tG=Object.defineProperty,tJ=Object.getOwnPropertySymbols,tY=Object.prototype.hasOwnProperty,tZ=Object.prototype.propertyIsEnumerable,Mt=(i,r,c)=>r in i?tG(i,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[r]=c,kt=(i,r)=>{for(var c in r||(r={}))tY.call(r,c)&&Mt(i,c,r[c]);if(tJ)for(var c of tJ(r))tZ.call(r,c)&&Mt(i,c,r[c]);return i};let Kt=class Kt extends p{constructor(i,r,c,l=ty,E){super(i,r,c,l),this.core=i,this.logger=r,this.name=c,this.map=new Map,this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=ty,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>{this.getKey&&null!==i&&!(0,ef.o8e)(i)?this.map.set(this.getKey(i),i):(0,ef.xWS)(i)?this.map.set(i.id,i):(0,ef.h1R)(i)&&this.map.set(i.topic,i)}),this.cached=[],this.initialized=!0)},this.set=async(i,r)=>{this.isInitialized(),this.map.has(i)?await this.update(i,r):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:i,value:r}),this.map.set(i,r),await this.persist())},this.get=i=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:i}),this.getData(i)),this.getAll=i=>(this.isInitialized(),i?this.values.filter(r=>Object.keys(i).every(c=>eb()(r[c],i[c]))):this.values),this.update=async(i,r)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:i,update:r});let c=kt(kt({},this.getData(i)),r);this.map.set(i,c),await this.persist()},this.delete=async(i,r)=>{this.isInitialized(),this.map.has(i)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:i,reason:r}),this.map.delete(i),this.addToRecentlyDeleted(i),await this.persist())},this.logger=(0,ee.Ep)(r,this.name),this.storagePrefix=l,this.getKey=E}get context(){return(0,ee.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(i){this.recentlyDeleted.push(i),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){let r=this.map.get(i);if(!r){if(this.recentlyDeleted.includes(i)){let{message:r}=(0,ef.kCb)("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${i}`);throw this.logger.error(r),Error(r)}let{message:r}=(0,ef.kCb)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(r),Error(r)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{let i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){let{message:i}=(0,ef.kCb)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),Error(i)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}};let Vt=class Vt{constructor(i,r){this.core=i,this.logger=r,this.name="pairing",this.version="0.3",this.events=new(S()),this.initialized=!1,this.storagePrefix=ty,this.ignoredPayloadTypes=[ef.rVF],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async i=>{this.isInitialized();let r=(0,ef.jdp)(),c=await this.core.crypto.setSymKey(r),l=(0,ef.gn4)(F.FIVE_MINUTES),E={protocol:"irn"},S=(0,ef.Bvr)({protocol:this.core.protocol,version:this.core.version,topic:c,symKey:r,relay:E,expiryTimestamp:l,methods:i?.methods});return this.core.expirer.set(c,l),await this.pairings.set(c,{topic:c,expiry:l,relay:E,active:!1}),await this.core.relayer.subscribe(c),{topic:c,uri:S}},this.pair=async i=>{this.isInitialized(),this.isValidPair(i);let{topic:r,symKey:c,relay:l,expiryTimestamp:E,methods:S}=(0,ef.heJ)(i.uri);if(this.pairings.keys.includes(r)&&this.pairings.get(r).active)throw Error(`Pairing already exists: ${r}. Please try again with a new connection URI.`);let P=E||(0,ef.gn4)(F.FIVE_MINUTES),C={topic:r,relay:l,expiry:P,active:!1,methods:S};return this.core.expirer.set(r,P),await this.pairings.set(r,C),i.activatePairing&&await this.activate({topic:r}),this.events.emit(tq.create,C),this.core.crypto.keychain.has(r)||await this.core.crypto.setSymKey(c,r),await this.core.relayer.subscribe(r,{relay:l}),C},this.activate=async({topic:i})=>{this.isInitialized();let r=(0,ef.gn4)(F.THIRTY_DAYS);this.core.expirer.set(i,r),await this.pairings.update(i,{active:!0,expiry:r})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);let{topic:r}=i;if(this.pairings.keys.includes(r)){let i=await this.sendRequest(r,"wc_pairingPing",{}),{done:c,resolve:l,reject:E}=(0,ef.H1S)();this.events.once((0,ef.E0T)("pairing_ping",i),({error:i})=>{i?E(i):l()}),await c()}},this.updateExpiry=async({topic:i,expiry:r})=>{this.isInitialized(),await this.pairings.update(i,{expiry:r})},this.updateMetadata=async({topic:i,metadata:r})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:r})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);let{topic:r}=i;this.pairings.keys.includes(r)&&(await this.sendRequest(r,"wc_pairingDelete",(0,ef.D6H)("USER_DISCONNECTED")),await this.deletePairing(r))},this.sendRequest=async(i,r,c)=>{let l=(0,em.formatJsonRpcRequest)(r,c),E=await this.core.crypto.encode(i,l),S=tA[r].req;return this.core.history.set(i,l),this.core.relayer.publish(i,E,S),l.id},this.sendResult=async(i,r,c)=>{let l=(0,em.formatJsonRpcResult)(i,c),E=await this.core.crypto.encode(r,l),S=await this.core.history.get(r,i),P=tA[S.request.method].res;await this.core.relayer.publish(r,E,P),await this.core.history.resolve(l)},this.sendError=async(i,r,c)=>{let l=(0,em.formatJsonRpcError)(i,c),E=await this.core.crypto.encode(r,l),S=await this.core.history.get(r,i),P=tA[S.request.method]?tA[S.request.method].res:tA.unregistered_method.res;await this.core.relayer.publish(r,E,P),await this.core.history.resolve(l)},this.deletePairing=async(i,r)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,(0,ef.D6H)("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),r?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{let i=this.pairings.getAll().filter(i=>(0,ef.BwD)(i.expiry));await Promise.all(i.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=i=>{let{topic:r,payload:c}=i;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(r,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(r,c);default:return this.onUnknownRpcMethodRequest(r,c)}},this.onRelayEventResponse=async i=>{let{topic:r,payload:c}=i,l=(await this.core.history.get(r,c.id)).request.method;return"wc_pairingPing"===l?this.onPairingPingResponse(r,c):this.onUnknownRpcMethodResponse(l)},this.onPairingPingRequest=async(i,r)=>{let{id:c}=r;try{this.isValidPing({topic:i}),await this.sendResult(c,i,!0),this.events.emit(tq.ping,{id:c,topic:i})}catch(r){await this.sendError(c,i,r),this.logger.error(r)}},this.onPairingPingResponse=(i,r)=>{let{id:c}=r;setTimeout(()=>{(0,em.isJsonRpcResult)(r)?this.events.emit((0,ef.E0T)("pairing_ping",c),{}):(0,em.isJsonRpcError)(r)&&this.events.emit((0,ef.E0T)("pairing_ping",c),{error:r.error})},500)},this.onPairingDeleteRequest=async(i,r)=>{let{id:c}=r;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(tq.delete,{id:c,topic:i})}catch(r){await this.sendError(c,i,r),this.logger.error(r)}},this.onUnknownRpcMethodRequest=async(i,r)=>{let{id:c,method:l}=r;try{if(this.registeredMethods.includes(l))return;let r=(0,ef.D6H)("WC_METHOD_UNSUPPORTED",l);await this.sendError(c,i,r),this.logger.error(r)}catch(r){await this.sendError(c,i,r),this.logger.error(r)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error((0,ef.D6H)("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=i=>{var r;if(!(0,ef.EJd)(i)){let{message:r}=(0,ef.kCb)("MISSING_OR_INVALID",`pair() params: ${i}`);throw Error(r)}if(!(0,ef.jvJ)(i.uri)){let{message:r}=(0,ef.kCb)("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw Error(r)}let c=(0,ef.heJ)(i.uri);if(!(null!=(r=c?.relay)&&r.protocol)){let{message:i}=(0,ef.kCb)("MISSING_OR_INVALID","pair() uri#relay-protocol");throw Error(i)}if(!(null!=c&&c.symKey)){let{message:i}=(0,ef.kCb)("MISSING_OR_INVALID","pair() uri#symKey");throw Error(i)}if(null!=c&&c.expiryTimestamp&&(0,F.toMiliseconds)(c?.expiryTimestamp)<Date.now()){let{message:i}=(0,ef.kCb)("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(i)}},this.isValidPing=async i=>{if(!(0,ef.EJd)(i)){let{message:r}=(0,ef.kCb)("MISSING_OR_INVALID",`ping() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidPairingTopic(r)},this.isValidDisconnect=async i=>{if(!(0,ef.EJd)(i)){let{message:r}=(0,ef.kCb)("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidPairingTopic(r)},this.isValidPairingTopic=async i=>{if(!(0,ef.M_r)(i,!1)){let{message:r}=(0,ef.kCb)("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw Error(r)}if(!this.pairings.keys.includes(i)){let{message:r}=(0,ef.kCb)("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw Error(r)}if((0,ef.BwD)(this.pairings.get(i).expiry)){await this.deletePairing(i);let{message:r}=(0,ef.kCb)("EXPIRED",`pairing topic: ${i}`);throw Error(r)}},this.core=i,this.logger=(0,ee.Ep)(r,this.name),this.pairings=new Kt(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,ee.Fd)(this.logger)}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}registerRelayerEvents(){this.core.relayer.on(tS.message,async i=>{let{topic:r,message:c}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(c)))return;let l=await this.core.crypto.decode(r,c);try{(0,em.isJsonRpcRequest)(l)?(this.core.history.set(r,l),this.onRelayEventRequest({topic:r,payload:l})):(0,em.isJsonRpcResponse)(l)&&(await this.core.history.resolve(l),await this.onRelayEventResponse({topic:r,payload:l}),this.core.history.delete(r,l.id))}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(tT.expired,async i=>{let{topic:r}=(0,ef.iPz)(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(tq.expire,{topic:r}))})}};let qt=class qt extends index_es_h{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new E.EventEmitter,this.name="history",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=ty,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,r,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:r,chainId:c}),this.records.has(r.id))return;let l={id:r.id,topic:i,request:{method:r.method,params:r.params||null},chainId:c,expiry:(0,ef.gn4)(F.THIRTY_DAYS)};this.records.set(l.id,l),this.persist(),this.events.emit(tN.created,l)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;let r=await this.getRecord(i.id);typeof r.response>"u"&&(r.response=(0,em.isJsonRpcError)(i)?{error:i.error}:{result:i.result},this.records.set(r.id,r),this.persist(),this.events.emit(tN.updated,r))},this.get=async(i,r)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:r}),await this.getRecord(r)),this.delete=(i,r)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:r}),this.values.forEach(c=>{c.topic!==i||"u">typeof r&&c.id!==r||(this.records.delete(c.id),this.events.emit(tN.deleted,c))}),this.persist()},this.exists=async(i,r)=>(this.isInitialized(),!!this.records.has(r)&&(await this.getRecord(r)).topic===i),this.on=(i,r)=>{this.events.on(i,r)},this.once=(i,r)=>{this.events.once(i,r)},this.off=(i,r)=>{this.events.off(i,r)},this.removeListener=(i,r)=>{this.events.removeListener(i,r)},this.logger=(0,ee.Ep)(r,this.name)}get context(){return(0,ee.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let i=[];return this.values.forEach(r=>{if("u">typeof r.response)return;let c={topic:r.topic,request:(0,em.formatJsonRpcRequest)(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(c)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();let r=this.records.get(i);if(!r){let{message:r}=(0,ef.kCb)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw Error(r)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(tN.sync)}async restore(){try{let i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){let{message:i}=(0,ef.kCb)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),Error(i)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(tN.created,i=>{let r=tN.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i})}),this.events.on(tN.updated,i=>{let r=tN.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i})}),this.events.on(tN.deleted,i=>{let r=tN.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i})}),this.core.heartbeat.on(X.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let i=!1;this.records.forEach(r=>{(0,F.toMiliseconds)(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(tN.deleted,r,!1),i=!0)}),i&&this.persist()}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}};let jt=class jt extends index_es_E{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new E.EventEmitter,this.name="expirer",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=ty,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{let r=this.formatTarget(i);return"u">typeof this.getExpiration(r)}catch{return!1}},this.set=(i,r)=>{this.isInitialized();let c=this.formatTarget(i),l={target:c,expiry:r};this.expirations.set(c,l),this.checkExpiry(c,l),this.events.emit(tT.created,{target:c,expiration:l})},this.get=i=>{this.isInitialized();let r=this.formatTarget(i);return this.getExpiration(r)},this.del=i=>{if(this.isInitialized(),this.has(i)){let r=this.formatTarget(i),c=this.getExpiration(r);this.expirations.delete(r),this.events.emit(tT.deleted,{target:r,expiration:c})}},this.on=(i,r)=>{this.events.on(i,r)},this.once=(i,r)=>{this.events.once(i,r)},this.off=(i,r)=>{this.events.off(i,r)},this.removeListener=(i,r)=>{this.events.removeListener(i,r)},this.logger=(0,ee.Ep)(r,this.name)}get context(){return(0,ee.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if("string"==typeof i)return(0,ef.Z42)(i);if("number"==typeof i)return(0,ef.GqV)(i);let{message:r}=(0,ef.kCb)("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(tT.sync)}async restore(){try{let i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){let{message:i}=(0,ef.kCb)("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),Error(i)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){let r=this.expirations.get(i);if(!r){let{message:r}=(0,ef.kCb)("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.warn(r),Error(r)}return r}checkExpiry(i,r){let{expiry:c}=r;(0,F.toMiliseconds)(c)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(tT.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(X.pulse,()=>this.checkExpirations()),this.events.on(tT.created,i=>{let r=tT.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(tT.expired,i=>{let r=tT.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(tT.deleted,i=>{let r=tT.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){let{message:i}=(0,ef.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}}};let Gt=class Gt extends index_es_y{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=tD,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async i=>{if(this.verifyDisabled||(0,ef.b$m)()||!(0,ef.jUY)())return;let r=this.getVerifyUrl(i?.verifyUrl);this.verifyUrl!==r&&this.removeIframe(),this.verifyUrl=r;try{await this.createIframe()}catch(i){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(i)}if(!this.initialized){this.removeIframe(),this.verifyUrl=tj;try{await this.createIframe()}catch(i){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(i),this.verifyDisabled=!0}}},this.register=async i=>{this.initialized?this.sendPost(i.attestationId):(this.addToQueue(i.attestationId),await this.init())},this.resolve=async i=>{let r;if(this.isDevEnv)return"";let c=this.getVerifyUrl(i?.verifyUrl);try{r=await this.fetchAttestation(i.attestationId,c)}catch(l){this.logger.info(`failed to resolve attestation: ${i.attestationId} from url: ${c}`),this.logger.info(l),r=await this.fetchAttestation(i.attestationId,tj)}return r},this.fetchAttestation=async(i,r)=>{this.logger.info(`resolving attestation: ${i} from url: ${r}`);let c=this.startAbortTimer(2*F.ONE_SECOND),l=await fetch(`${r}/attestation/${i}`,{signal:this.abortController.signal});return clearTimeout(c),200===l.status?await l.json():void 0},this.addToQueue=i=>{this.queue.push(i)},this.processQueue=()=>{0!==this.queue.length&&(this.queue.forEach(i=>this.sendPost(i)),this.queue=[])},this.sendPost=i=>{var r;try{if(!this.iframe)return;null==(r=this.iframe.contentWindow)||r.postMessage(i,"*"),this.logger.info(`postMessage sent: ${i} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let i;let s=r=>{"verify_ready"===r.data&&(this.onInit(),window.removeEventListener("message",s),i())};await Promise.race([new Promise(r=>{let c=document.getElementById(tD);if(c)return this.iframe=c,this.onInit(),r();window.addEventListener("message",s);let l=document.createElement("iframe");l.id=tD,l.src=`${this.verifyUrl}/${this.projectId}`,l.style.display="none",document.body.append(l),this.iframe=l,i=r}),new Promise((i,r)=>setTimeout(()=>{window.removeEventListener("message",s),r("verify iframe load timeout")},(0,F.toMiliseconds)(F.FIVE_SECONDS)))])},this.onInit=()=>{this.initialized=!0,this.processQueue()},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=i=>{let r=i||tk;return tM.includes(r)||(this.logger.info(`verify url: ${r}, not included in trusted list, assigning default: ${tk}`),r=tk),r},this.logger=(0,ee.Ep)(r,this.name),this.verifyUrl=tk,this.abortController=new AbortController,this.isDevEnv=(0,ef.UGU)()&&ex.env.IS_VITEST}get context(){return(0,ee.Fd)(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,F.toMiliseconds)(i))}};let Yt=class Yt extends v{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.context="echo",this.registerDeviceToken=async i=>{let{clientId:r,token:c,notificationType:l,enableEncrypted:E=!1}=i,S=`https://echo.walletconnect.com/${this.projectId}/clients`;await eE()(S,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:r,type:l,token:c,always_raw:E})})},this.logger=(0,ee.Ep)(r,this.context)}};var tQ=Object.defineProperty,tX=Object.getOwnPropertySymbols,t0=Object.prototype.hasOwnProperty,t1=Object.prototype.propertyIsEnumerable,Jt=(i,r,c)=>r in i?tQ(i,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[r]=c,Xt=(i,r)=>{for(var c in r||(r={}))t0.call(r,c)&&Jt(i,c,r[c]);if(tX)for(var c of tX(r))t1.call(r,c)&&Jt(i,c,r[c]);return i};let ie=class ie extends index_es_n{constructor(i){var r;super(i),this.protocol="wc",this.version=2,this.name=tg,this.events=new E.EventEmitter,this.initialized=!1,this.on=(i,r)=>this.events.on(i,r),this.once=(i,r)=>this.events.once(i,r),this.off=(i,r)=>this.events.off(i,r),this.removeListener=(i,r)=>this.events.removeListener(i,r),this.projectId=i?.projectId,this.relayUrl=i?.relayUrl||tE,this.customStoragePrefix=null!=i&&i.customStoragePrefix?`:${i.customStoragePrefix}`:"";let c=(0,ee.jI)({level:"string"==typeof i?.logger&&i.logger?i.logger:tm.logger}),{logger:l,chunkLoggerController:S}=(0,ee.Rt)({opts:c,maxSizeInBytes:i?.maxLogBlobSizeInBytes,loggerOverride:i?.logger});this.logChunkController=S,null!=(r=this.logChunkController)&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var i,r;null!=(i=this.logChunkController)&&i.downloadLogsBlobInBrowser&&(null==(r=this.logChunkController)||r.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,ee.Ep)(l,this.name),this.heartbeat=new index_es_i,this.crypto=new Ot(this,this.logger,i?.keychain),this.history=new qt(this,this.logger),this.expirer=new jt(this,this.logger),this.storage=null!=i&&i.storage?i.storage:new h(Xt(Xt({},t_),i?.storageOptions)),this.relayer=new $t({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Vt(this,this.logger),this.verify=new Gt(this.projectId||"",this.logger),this.echoClient=new Yt(this.projectId||"",this.logger)}static async init(i){let r=new ie(i);await r.initialize();let c=await r.crypto.getClientId();return await r.storage.setItem("WALLETCONNECT_CLIENT_ID",c),r}get context(){return(0,ee.Fd)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var i;return null==(i=this.logChunkController)?void 0:i.logsToBlob({clientId:await this.crypto.getClientId()})}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}};var t5=c(75450);let t6="client",t2=`wc@2:${t6}:`,t3={name:t6,logger:"error"},t4="WALLETCONNECT_DEEPLINK_CHOICE",t9="Proposal expired",t8=F.SEVEN_DAYS,t7={wc_sessionPropose:{req:{ttl:F.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:F.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:F.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:F.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:F.ONE_DAY,prompt:!1,tag:1104},res:{ttl:F.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:F.ONE_DAY,prompt:!1,tag:1106},res:{ttl:F.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:F.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:F.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:F.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:F.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:F.ONE_DAY,prompt:!1,tag:1112},res:{ttl:F.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:F.ONE_DAY,prompt:!1,tag:1114},res:{ttl:F.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:F.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:F.ONE_HOUR,prompt:!1,tag:1117}}},ir={min:F.FIVE_MINUTES,max:F.SEVEN_DAYS},ia={idle:"IDLE",active:"ACTIVE"},io=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],ic="wc@1.5:auth:",ih=`${ic}:PUB_KEY`;var il=Object.defineProperty,ip=Object.defineProperties,id=Object.getOwnPropertyDescriptors,ig=Object.getOwnPropertySymbols,iy=Object.prototype.hasOwnProperty,im=Object.prototype.propertyIsEnumerable,index_es_We=(i,r,c)=>r in i?il(i,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[r]=c,sign_client_dist_index_es_y=(i,r)=>{for(var c in r||(r={}))iy.call(r,c)&&index_es_We(i,c,r[c]);if(ig)for(var c of ig(r))im.call(r,c)&&index_es_We(i,c,r[c]);return i},index_es_M=(i,r)=>ip(i,id(r));let Zt=class Zt extends w{constructor(i){super(i),this.name="engine",this.events=new(S()),this.initialized=!1,this.requestQueue={state:ia.idle,queue:[]},this.sessionRequestQueue={state:ia.idle,queue:[]},this.requestQueueDelay=F.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(t7)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,F.toMiliseconds)(this.requestQueueDelay)))},this.connect=async i=>{await this.isInitialized();let r=index_es_M(sign_client_dist_index_es_y({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(r);let{pairingTopic:c,requiredNamespaces:l,optionalNamespaces:E,sessionProperties:S,relays:P}=r,C=c,A,q=!1;try{C&&(q=this.client.core.pairing.pairings.get(C).active)}catch(i){throw this.client.logger.error(`connect() -> pairing.get(${C}) failed`),i}if(!C||!q){let{topic:i,uri:r}=await this.client.core.pairing.create();C=i,A=r}if(!C){let{message:i}=(0,t5.kCb)("NO_MATCHING_KEY",`connect() pairing topic: ${C}`);throw Error(i)}let T=await this.client.core.crypto.generateKeyPair(),D=t7.wc_sessionPropose.req.ttl||F.FIVE_MINUTES,M=(0,t5.gn4)(D),U=sign_client_dist_index_es_y({requiredNamespaces:l,optionalNamespaces:E,relays:P??[{protocol:"irn"}],proposer:{publicKey:T,metadata:this.client.metadata},expiryTimestamp:M},S&&{sessionProperties:S}),{reject:B,resolve:J,done:X}=(0,t5.H1S)(D,t9);this.events.once((0,t5.E0T)("session_connect"),async({error:i,session:r})=>{if(i)B(i);else if(r){r.self.publicKey=T;let i=index_es_M(sign_client_dist_index_es_y({},r),{requiredNamespaces:U.requiredNamespaces,optionalNamespaces:U.optionalNamespaces});await this.client.session.set(r.topic,i),await this.setExpiry(r.topic,r.expiry),C&&await this.client.core.pairing.updateMetadata({topic:C,metadata:r.peer.metadata}),J(i)}});let ee=await this.sendRequest({topic:C,method:"wc_sessionPropose",params:U,throwOnFailedPublish:!0});return await this.setProposal(ee,sign_client_dist_index_es_y({id:ee},U)),{uri:A,approval:X}},this.pair=async i=>{await this.isInitialized();try{return await this.client.core.pairing.pair(i)}catch(i){throw this.client.logger.error("pair() failed"),i}},this.approve=async i=>{let r;await this.isInitialized();try{await this.isValidApprove(i)}catch(i){throw this.client.logger.error("approve() -> isValidApprove() failed"),i}let{id:c,relayProtocol:l,namespaces:E,sessionProperties:S,sessionConfig:P}=i;try{r=this.client.proposal.get(c)}catch(i){throw this.client.logger.error(`approve() -> proposal.get(${c}) failed`),i}let{pairingTopic:C,proposer:A,requiredNamespaces:q,optionalNamespaces:T}=r;C=C||"";let D=await this.client.core.crypto.generateKeyPair(),M=A.publicKey,U=await this.client.core.crypto.generateSharedKey(D,M),B=sign_client_dist_index_es_y(sign_client_dist_index_es_y({relay:{protocol:l??"irn"},namespaces:E,pairingTopic:C,controller:{publicKey:D,metadata:this.client.metadata},expiry:(0,t5.gn4)(t8)},S&&{sessionProperties:S}),P&&{sessionConfig:P});await this.client.core.relayer.subscribe(U);let F=index_es_M(sign_client_dist_index_es_y({},B),{topic:U,requiredNamespaces:q,optionalNamespaces:T,pairingTopic:C,acknowledged:!1,self:B.controller,peer:{publicKey:A.publicKey,metadata:A.metadata},controller:D});await this.client.session.set(U,F);try{await this.sendResult({id:c,topic:C,result:{relay:{protocol:l??"irn"},responderPublicKey:D},throwOnFailedPublish:!0}),await this.sendRequest({topic:U,method:"wc_sessionSettle",params:B,throwOnFailedPublish:!0})}catch(i){throw this.client.logger.error(i),this.client.session.delete(U,(0,t5.D6H)("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(U),i}return await this.client.core.pairing.updateMetadata({topic:C,metadata:A.metadata}),await this.client.proposal.delete(c,(0,t5.D6H)("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:C}),await this.setExpiry(U,(0,t5.gn4)(t8)),{topic:U,acknowledged:()=>new Promise(i=>setTimeout(()=>i(this.client.session.get(U)),500))}},this.reject=async i=>{let r;await this.isInitialized();try{await this.isValidReject(i)}catch(i){throw this.client.logger.error("reject() -> isValidReject() failed"),i}let{id:c,reason:l}=i;try{r=this.client.proposal.get(c).pairingTopic}catch(i){throw this.client.logger.error(`reject() -> proposal.get(${c}) failed`),i}r&&(await this.sendError({id:c,topic:r,error:l}),await this.client.proposal.delete(c,(0,t5.D6H)("USER_DISCONNECTED")))},this.update=async i=>{await this.isInitialized();try{await this.isValidUpdate(i)}catch(i){throw this.client.logger.error("update() -> isValidUpdate() failed"),i}let{topic:r,namespaces:c}=i,{done:l,resolve:E,reject:S}=(0,t5.H1S)(),P=(0,em.payloadId)(),C=(0,em.getBigIntRpcId)().toString(),A=this.client.session.get(r).namespaces;return this.events.once((0,t5.E0T)("session_update",P),({error:i})=>{i?S(i):E()}),await this.client.session.update(r,{namespaces:c}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:c},throwOnFailedPublish:!0,clientRpcId:P,relayRpcId:C}).catch(i=>{this.client.logger.error(i),this.client.session.update(r,{namespaces:A}),S(i)}),{acknowledged:l}},this.extend=async i=>{await this.isInitialized();try{await this.isValidExtend(i)}catch(i){throw this.client.logger.error("extend() -> isValidExtend() failed"),i}let{topic:r}=i,c=(0,em.payloadId)(),{done:l,resolve:E,reject:S}=(0,t5.H1S)();return this.events.once((0,t5.E0T)("session_extend",c),({error:i})=>{i?S(i):E()}),await this.setExpiry(r,(0,t5.gn4)(t8)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:c,throwOnFailedPublish:!0}).catch(i=>{S(i)}),{acknowledged:l}},this.request=async i=>{await this.isInitialized();try{await this.isValidRequest(i)}catch(i){throw this.client.logger.error("request() -> isValidRequest() failed"),i}let{chainId:r,request:c,topic:l,expiry:E=t7.wc_sessionRequest.req.ttl}=i,S=this.client.session.get(l),P=(0,em.payloadId)(),C=(0,em.getBigIntRpcId)().toString(),{done:A,resolve:q,reject:T}=(0,t5.H1S)(E,"Request expired. Please try again.");return this.events.once((0,t5.E0T)("session_request",P),({error:i,result:r})=>{i?T(i):q(r)}),await Promise.all([new Promise(async i=>{await this.sendRequest({clientRpcId:P,relayRpcId:C,topic:l,method:"wc_sessionRequest",params:{request:index_es_M(sign_client_dist_index_es_y({},c),{expiryTimestamp:(0,t5.gn4)(E)}),chainId:r},expiry:E,throwOnFailedPublish:!0}).catch(i=>T(i)),this.client.events.emit("session_request_sent",{topic:l,request:c,chainId:r,id:P}),i()}),new Promise(async i=>{var r;if(!(null!=(r=S.sessionConfig)&&r.disableDeepLink)){let i=await (0,t5.bW6)(this.client.core.storage,t4);(0,t5.HhN)({id:P,topic:l,wcDeepLink:i})}i()}),A()]).then(i=>i[2])},this.respond=async i=>{await this.isInitialized(),await this.isValidRespond(i);let{topic:r,response:c}=i,{id:l}=c;(0,em.isJsonRpcResult)(c)?await this.sendResult({id:l,topic:r,result:c.result,throwOnFailedPublish:!0}):(0,em.isJsonRpcError)(c)&&await this.sendError({id:l,topic:r,error:c.error}),this.cleanupAfterResponse(i)},this.ping=async i=>{await this.isInitialized();try{await this.isValidPing(i)}catch(i){throw this.client.logger.error("ping() -> isValidPing() failed"),i}let{topic:r}=i;if(this.client.session.keys.includes(r)){let i=(0,em.payloadId)(),c=(0,em.getBigIntRpcId)().toString(),{done:l,resolve:E,reject:S}=(0,t5.H1S)();this.events.once((0,t5.E0T)("session_ping",i),({error:i})=>{i?S(i):E()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:i,relayRpcId:c}),l()])}else this.client.core.pairing.pairings.keys.includes(r)&&await this.client.core.pairing.ping({topic:r})},this.emit=async i=>{await this.isInitialized(),await this.isValidEmit(i);let{topic:r,event:c,chainId:l}=i,E=(0,em.getBigIntRpcId)().toString();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:c,chainId:l},throwOnFailedPublish:!0,relayRpcId:E})},this.disconnect=async i=>{await this.isInitialized(),await this.isValidDisconnect(i);let{topic:r}=i;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:(0,t5.D6H)("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{let{message:i}=(0,t5.kCb)("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw Error(i)}},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(r=>(0,t5.Ih8)(r,i))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async i=>{this.isInitialized(),this.isValidAuthenticate(i);let{chains:r,statement:c="",uri:l,domain:E,nonce:S,type:P,exp:C,nbf:A,methods:q=[],expiry:T}=i,D=[...i.resources||[]],{topic:M,uri:U}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"]});this.client.logger.info({message:"Generated new pairing",pairing:{topic:M,uri:U}});let B=await this.client.core.crypto.generateKeyPair(),F=(0,t5.YmJ)(B);if(await Promise.all([this.client.auth.authKeys.set(ih,{responseTopic:F,publicKey:B}),this.client.auth.pairingTopics.set(F,{topic:F,pairingTopic:M})]),await this.client.core.relayer.subscribe(F),this.client.logger.info(`sending request to new pairing topic: ${M}`),q.length>0){let{namespace:i}=(0,t5.DQe)(r[0]),c=(0,t5.IkP)(i,"request",q);(0,t5.hA9)(D)&&(c=(0,t5.qJM)(c,D.pop())),D.push(c)}let J=T&&T>t7.wc_sessionAuthenticate.req.ttl?T:t7.wc_sessionAuthenticate.req.ttl,X={authPayload:{type:P??"caip122",chains:r,statement:c,aud:l,domain:E,version:"1",nonce:S,iat:new Date().toISOString(),exp:C,nbf:A,resources:D},requester:{publicKey:B,metadata:this.client.metadata},expiryTimestamp:(0,t5.gn4)(J)},ee={eip155:{chains:r,methods:[...new Set(["personal_sign",...q])],events:["chainChanged","accountsChanged"]}},et={requiredNamespaces:{},optionalNamespaces:ee,relays:[{protocol:"irn"}],proposer:{publicKey:B,metadata:this.client.metadata},expiryTimestamp:(0,t5.gn4)(t7.wc_sessionPropose.req.ttl)},{done:ea,resolve:eo,reject:ec}=(0,t5.H1S)(J,"Request expired"),W=async({error:i,session:r})=>{if(this.events.off((0,t5.E0T)("session_request",eh),ce),i)ec(i);else if(r){r.self.publicKey=B,await this.client.session.set(r.topic,r),await this.setExpiry(r.topic,r.expiry),M&&await this.client.core.pairing.updateMetadata({topic:M,metadata:r.peer.metadata});let i=this.client.session.get(r.topic);await this.deleteProposal(el),eo({session:i})}},ce=async i=>{let r;if(await this.deletePendingAuthRequest(eh,{message:"fulfilled",code:0}),i.error){let r=(0,t5.D6H)("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return i.error.code===r.code?void 0:(this.events.off((0,t5.E0T)("session_connect"),W),ec(i.error.message))}await this.deleteProposal(el),this.events.off((0,t5.E0T)("session_connect"),W);let{cacaos:c,responder:l}=i.result,E=[],S=[];for(let i of c){await (0,t5.c4l)({cacao:i,projectId:this.client.core.projectId})||(this.client.logger.error(i,"Signature verification failed"),ec((0,t5.D6H)("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:r}=i,c=(0,t5.hA9)(r.resources),l=[(0,t5.DJo)(r.iss)],P=(0,t5.NmC)(r.iss);if(c){let i=(0,t5.Y31)(c),r=(0,t5.ouN)(c);E.push(...i),l.push(...r)}for(let i of l)S.push(`${i}:${P}`)}let P=await this.client.core.crypto.generateSharedKey(B,l.publicKey);E.length>0&&(r={topic:P,acknowledged:!0,self:{publicKey:B,metadata:this.client.metadata},peer:l,controller:l.publicKey,expiry:(0,t5.gn4)(t8),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:M,namespaces:(0,t5.E12)([...new Set(E)],[...new Set(S)])},await this.client.core.relayer.subscribe(P),await this.client.session.set(P,r),r=this.client.session.get(P)),eo({auths:c,session:r})},eh=(0,em.payloadId)(),el=(0,em.payloadId)();this.events.once((0,t5.E0T)("session_connect"),W),this.events.once((0,t5.E0T)("session_request",eh),ce);try{await Promise.all([this.sendRequest({topic:M,method:"wc_sessionAuthenticate",params:X,expiry:i.expiry,throwOnFailedPublish:!0,clientRpcId:eh}),this.sendRequest({topic:M,method:"wc_sessionPropose",params:et,expiry:t7.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:el})])}catch(i){throw this.events.off((0,t5.E0T)("session_connect"),W),this.events.off((0,t5.E0T)("session_request",eh),ce),i}return await this.setProposal(el,sign_client_dist_index_es_y({id:el},et)),await this.setAuthRequest(eh,{request:index_es_M(sign_client_dist_index_es_y({},X),{verifyContext:{}}),pairingTopic:M}),{uri:U,response:ea}},this.approveSessionAuthenticate=async i=>{let r;this.isInitialized();let{id:c,auths:l}=i,E=this.getPendingAuthRequest(c);if(!E)throw Error(`Could not find pending auth request with id ${c}`);let S=E.requester.publicKey,P=await this.client.core.crypto.generateKeyPair(),C=(0,t5.YmJ)(S),A={type:t5.rVF,receiverPublicKey:S,senderPublicKey:P},q=[],T=[];for(let i of l){if(!await (0,t5.c4l)({cacao:i,projectId:this.client.core.projectId})){let i=(0,t5.D6H)("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:c,topic:C,error:i,encodeOpts:A}),Error(i.message)}let{p:r}=i,l=(0,t5.hA9)(r.resources),E=[(0,t5.DJo)(r.iss)],S=(0,t5.NmC)(r.iss);if(l){let i=(0,t5.Y31)(l),r=(0,t5.ouN)(l);q.push(...i),E.push(...r)}for(let i of E)T.push(`${i}:${S}`)}let D=await this.client.core.crypto.generateSharedKey(P,S);return q?.length>0&&(r={topic:D,acknowledged:!0,self:{publicKey:P,metadata:this.client.metadata},peer:{publicKey:S,metadata:E.requester.metadata},controller:S,expiry:(0,t5.gn4)(t8),authentication:l,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:"",namespaces:(0,t5.E12)([...new Set(q)],[...new Set(T)])},await this.client.core.relayer.subscribe(D),await this.client.session.set(D,r)),await this.sendResult({topic:C,id:c,result:{cacaos:l,responder:{publicKey:P,metadata:this.client.metadata}},encodeOpts:A,throwOnFailedPublish:!0}),await this.client.auth.requests.delete(c,{message:"fullfilled",code:0}),await this.client.core.pairing.activate({topic:E.pairingTopic}),{session:r}},this.rejectSessionAuthenticate=async i=>{await this.isInitialized();let{id:r,reason:c}=i,l=this.getPendingAuthRequest(r);if(!l)throw Error(`Could not find pending auth request with id ${r}`);let E=l.requester.publicKey,S=await this.client.core.crypto.generateKeyPair(),P=(0,t5.YmJ)(E),C={type:t5.rVF,receiverPublicKey:E,senderPublicKey:S};await this.sendError({id:r,topic:P,error:c,encodeOpts:C}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.client.proposal.delete(r,(0,t5.D6H)("USER_DISCONNECTED"))},this.formatAuthMessage=i=>{this.isInitialized();let{request:r,iss:c}=i;return(0,t5.wvx)(r,c)},this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{let r=this.client.core.pairing.pairings.get(i.pairingTopic),c=this.client.core.pairing.pairings.getAll().filter(c=>{var l,E;return(null==(l=c.peerMetadata)?void 0:l.url)&&(null==(E=c.peerMetadata)?void 0:E.url)===i.peer.metadata.url&&c.topic&&c.topic!==r.topic});if(0===c.length)return;this.client.logger.info(`Cleaning up ${c.length} duplicate pairing(s)`),await Promise.all(c.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async i=>{let{topic:r,expirerHasDeleted:c=!1,emitEvent:l=!0,id:E=0}=i,{self:S}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,(0,t5.D6H)("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(S.publicKey)&&await this.client.core.crypto.deleteKeyPair(S.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),c||this.client.core.expirer.del(r),this.client.core.storage.removeItem(t4).catch(i=>this.client.logger.warn(i)),this.getPendingSessionRequests().forEach(i=>{i.topic===r&&this.deletePendingSessionRequest(i.id,(0,t5.D6H)("USER_DISCONNECTED"))}),l&&this.client.events.emit("session_delete",{id:E,topic:r})},this.deleteProposal=async(i,r)=>{await Promise.all([this.client.proposal.delete(i,(0,t5.D6H)("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(i)]),this.addToRecentlyDeleted(i,"proposal")},this.deletePendingSessionRequest=async(i,r,c=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,r),c?Promise.resolve():this.client.core.expirer.del(i)]),this.addToRecentlyDeleted(i,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(r=>r.id!==i),c&&(this.sessionRequestQueue.state=ia.idle,this.client.events.emit("session_request_expire",{id:i}))},this.deletePendingAuthRequest=async(i,r,c=!1)=>{await Promise.all([this.client.auth.requests.delete(i,r),c?Promise.resolve():this.client.core.expirer.del(i)])},this.setExpiry=async(i,r)=>{this.client.session.keys.includes(i)&&(this.client.core.expirer.set(i,r),await this.client.session.update(i,{expiry:r}))},this.setProposal=async(i,r)=>{this.client.core.expirer.set(i,(0,t5.gn4)(t7.wc_sessionPropose.req.ttl)),await this.client.proposal.set(i,r)},this.setAuthRequest=async(i,r)=>{let{request:c,pairingTopic:l}=r;this.client.core.expirer.set(i,c.expiryTimestamp),await this.client.auth.requests.set(i,{authPayload:c.authPayload,requester:c.requester,expiryTimestamp:c.expiryTimestamp,id:i,pairingTopic:l,verifyContext:c.verifyContext})},this.setPendingSessionRequest=async i=>{let{id:r,topic:c,params:l,verifyContext:E}=i,S=l.request.expiryTimestamp||(0,t5.gn4)(t7.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,S),await this.client.pendingRequest.set(r,{id:r,topic:c,params:l,verifyContext:E})},this.sendRequest=async i=>{let r;let{topic:c,method:l,params:E,expiry:S,relayRpcId:P,clientRpcId:C,throwOnFailedPublish:A}=i,q=(0,em.formatJsonRpcRequest)(l,E,C);if((0,t5.jUY)()&&io.includes(l)){let i=(0,t5.rjm)(JSON.stringify(q));this.client.core.verify.register({attestationId:i})}try{r=await this.client.core.crypto.encode(c,q)}catch(i){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${c} failed`),i}let T=t7[l].req;return S&&(T.ttl=S),P&&(T.id=P),this.client.core.history.set(c,q),A?(T.internal=index_es_M(sign_client_dist_index_es_y({},T.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(c,r,T)):this.client.core.relayer.publish(c,r,T).catch(i=>this.client.logger.error(i)),q.id},this.sendResult=async i=>{let r,c;let{id:l,topic:E,result:S,throwOnFailedPublish:P,encodeOpts:C}=i,A=(0,em.formatJsonRpcResult)(l,S);try{r=await this.client.core.crypto.encode(E,A,C)}catch(i){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${E} failed`),i}try{c=await this.client.core.history.get(E,l)}catch(i){throw this.client.logger.error(`sendResult() -> history.get(${E}, ${l}) failed`),i}let q=t7[c.request.method].res;P?(q.internal=index_es_M(sign_client_dist_index_es_y({},q.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(E,r,q)):this.client.core.relayer.publish(E,r,q).catch(i=>this.client.logger.error(i)),await this.client.core.history.resolve(A)},this.sendError=async i=>{let r,c;let{id:l,topic:E,error:S,encodeOpts:P}=i,C=(0,em.formatJsonRpcError)(l,S);try{r=await this.client.core.crypto.encode(E,C,P)}catch(i){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${E} failed`),i}try{c=await this.client.core.history.get(E,l)}catch(i){throw this.client.logger.error(`sendError() -> history.get(${E}, ${l}) failed`),i}let A=t7[c.request.method].res;this.client.core.relayer.publish(E,r,A),await this.client.core.history.resolve(C)},this.cleanup=async()=>{let i=[],r=[];this.client.session.getAll().forEach(r=>{let c=!1;(0,t5.BwD)(r.expiry)&&(c=!0),this.client.core.crypto.keychain.has(r.topic)||(c=!0),c&&i.push(r.topic)}),this.client.proposal.getAll().forEach(i=>{(0,t5.BwD)(i.expiryTimestamp)&&r.push(i.id)}),await Promise.all([...i.map(i=>this.deleteSession({topic:i})),...r.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=async i=>{this.requestQueue.queue.push(i),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ia.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ia.active;let i=this.requestQueue.queue.shift();if(i)try{this.processRequest(i),await new Promise(i=>setTimeout(i,300))}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=ia.idle},this.processRequest=i=>{let{topic:r,payload:c}=i,l=c.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:l}))switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(r,c);case"wc_sessionSettle":return this.onSessionSettleRequest(r,c);case"wc_sessionUpdate":return this.onSessionUpdateRequest(r,c);case"wc_sessionExtend":return this.onSessionExtendRequest(r,c);case"wc_sessionPing":return this.onSessionPingRequest(r,c);case"wc_sessionDelete":return this.onSessionDeleteRequest(r,c);case"wc_sessionRequest":return this.onSessionRequest(r,c);case"wc_sessionEvent":return this.onSessionEventRequest(r,c);case"wc_sessionAuthenticate":return this.onSessionAuthenticateRequest(r,c);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async i=>{let{topic:r,payload:c}=i,l=(await this.client.core.history.get(r,c.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(r,c);case"wc_sessionSettle":return this.onSessionSettleResponse(r,c);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,c);case"wc_sessionExtend":return this.onSessionExtendResponse(r,c);case"wc_sessionPing":return this.onSessionPingResponse(r,c);case"wc_sessionRequest":return this.onSessionRequestResponse(r,c);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,c);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=i=>{let{topic:r}=i,{message:c}=(0,t5.kCb)("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw Error(c)},this.shouldIgnorePairingRequest=i=>{let{topic:r,requestMethod:c}=i,l=this.expectedPairingMethodMap.get(r);return!(!l||l.includes(c))&&!!(l.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async(i,r)=>{let{params:c,id:l}=r;try{this.isValidConnect(sign_client_dist_index_es_y({},r.params));let E=c.expiryTimestamp||(0,t5.gn4)(t7.wc_sessionPropose.req.ttl),S=sign_client_dist_index_es_y({id:l,pairingTopic:i,expiryTimestamp:E},c);await this.setProposal(l,S);let P=(0,t5.rjm)(JSON.stringify(r)),C=await this.getVerifyContext(P,S.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:S,verifyContext:C})}catch(r){await this.sendError({id:l,topic:i,error:r}),this.client.logger.error(r)}},this.onSessionProposeResponse=async(i,r)=>{let{id:c}=r;if((0,em.isJsonRpcResult)(r)){let{result:l}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});let E=this.client.proposal.get(c);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:E});let S=E.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:S});let P=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:P});let C=await this.client.core.crypto.generateSharedKey(S,P);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:C});let A=await this.client.core.relayer.subscribe(C);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:A}),await this.client.core.pairing.activate({topic:i})}else if((0,em.isJsonRpcError)(r)){await this.client.proposal.delete(c,(0,t5.D6H)("USER_DISCONNECTED"));let i=(0,t5.E0T)("session_connect");if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners, 954`);this.events.emit((0,t5.E0T)("session_connect"),{error:r.error})}},this.onSessionSettleRequest=async(i,r)=>{let{id:c,params:l}=r;try{this.isValidSessionSettleRequest(l);let{relay:c,controller:E,expiry:S,namespaces:P,sessionProperties:C,pairingTopic:A,sessionConfig:q}=r.params,T=sign_client_dist_index_es_y(sign_client_dist_index_es_y({topic:i,relay:c,expiry:S,namespaces:P,acknowledged:!0,pairingTopic:A,requiredNamespaces:{},optionalNamespaces:{},controller:E.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:E.publicKey,metadata:E.metadata}},C&&{sessionProperties:C}),q&&{sessionConfig:q});await this.sendResult({id:r.id,topic:i,result:!0,throwOnFailedPublish:!0});let D=(0,t5.E0T)("session_connect");if(0===this.events.listenerCount(D))throw Error(`emitting ${D} without any listeners 997`);this.events.emit((0,t5.E0T)("session_connect"),{session:T}),this.cleanupDuplicatePairings(T)}catch(r){await this.sendError({id:c,topic:i,error:r}),this.client.logger.error(r)}},this.onSessionSettleResponse=async(i,r)=>{let{id:c}=r;(0,em.isJsonRpcResult)(r)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit((0,t5.E0T)("session_approve",c),{})):(0,em.isJsonRpcError)(r)&&(await this.client.session.delete(i,(0,t5.D6H)("USER_DISCONNECTED")),this.events.emit((0,t5.E0T)("session_approve",c),{error:r.error}))},this.onSessionUpdateRequest=async(i,r)=>{let{params:c,id:l}=r;try{let r=`${i}_session_update`,E=t5.O6B.get(r);if(E&&this.isRequestOutOfSync(E,l)){this.client.logger.info(`Discarding out of sync request - ${l}`),this.sendError({id:l,topic:i,error:(0,t5.D6H)("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(sign_client_dist_index_es_y({topic:i},c));try{t5.O6B.set(r,l),await this.client.session.update(i,{namespaces:c.namespaces}),await this.sendResult({id:l,topic:i,result:!0,throwOnFailedPublish:!0})}catch(i){throw t5.O6B.delete(r),i}this.client.events.emit("session_update",{id:l,topic:i,params:c})}catch(r){await this.sendError({id:l,topic:i,error:r}),this.client.logger.error(r)}},this.isRequestOutOfSync=(i,r)=>parseInt(r.toString().slice(0,-3))<=parseInt(i.toString().slice(0,-3)),this.onSessionUpdateResponse=(i,r)=>{let{id:c}=r,l=(0,t5.E0T)("session_update",c);if(0===this.events.listenerCount(l))throw Error(`emitting ${l} without any listeners`);(0,em.isJsonRpcResult)(r)?this.events.emit((0,t5.E0T)("session_update",c),{}):(0,em.isJsonRpcError)(r)&&this.events.emit((0,t5.E0T)("session_update",c),{error:r.error})},this.onSessionExtendRequest=async(i,r)=>{let{id:c}=r;try{this.isValidExtend({topic:i}),await this.setExpiry(i,(0,t5.gn4)(t8)),await this.sendResult({id:c,topic:i,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:c,topic:i})}catch(r){await this.sendError({id:c,topic:i,error:r}),this.client.logger.error(r)}},this.onSessionExtendResponse=(i,r)=>{let{id:c}=r,l=(0,t5.E0T)("session_extend",c);if(0===this.events.listenerCount(l))throw Error(`emitting ${l} without any listeners`);(0,em.isJsonRpcResult)(r)?this.events.emit((0,t5.E0T)("session_extend",c),{}):(0,em.isJsonRpcError)(r)&&this.events.emit((0,t5.E0T)("session_extend",c),{error:r.error})},this.onSessionPingRequest=async(i,r)=>{let{id:c}=r;try{this.isValidPing({topic:i}),await this.sendResult({id:c,topic:i,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:c,topic:i})}catch(r){await this.sendError({id:c,topic:i,error:r}),this.client.logger.error(r)}},this.onSessionPingResponse=(i,r)=>{let{id:c}=r,l=(0,t5.E0T)("session_ping",c);if(0===this.events.listenerCount(l))throw Error(`emitting ${l} without any listeners`);setTimeout(()=>{(0,em.isJsonRpcResult)(r)?this.events.emit((0,t5.E0T)("session_ping",c),{}):(0,em.isJsonRpcError)(r)&&this.events.emit((0,t5.E0T)("session_ping",c),{error:r.error})},500)},this.onSessionDeleteRequest=async(i,r)=>{let{id:c}=r;try{this.isValidDisconnect({topic:i,reason:r.params}),await Promise.all([new Promise(r=>{this.client.core.relayer.once(tS.publish,async()=>{r(await this.deleteSession({topic:i,id:c}))})}),this.sendResult({id:c,topic:i,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:i,error:(0,t5.D6H)("USER_DISCONNECTED")})])}catch(i){this.client.logger.error(i)}},this.onSessionRequest=async(i,r)=>{var c;let{id:l,params:E}=r;try{await this.isValidRequest(sign_client_dist_index_es_y({topic:i},E));let r=(0,t5.rjm)(JSON.stringify((0,em.formatJsonRpcRequest)("wc_sessionRequest",E,l))),S=this.client.session.get(i),P=await this.getVerifyContext(r,S.peer.metadata),C={id:l,topic:i,params:E,verifyContext:P};await this.setPendingSessionRequest(C),null!=(c=this.client.signConfig)&&c.disableRequestQueue?this.emitSessionRequest(C):(this.addSessionRequestToSessionRequestQueue(C),this.processSessionRequestQueue())}catch(r){await this.sendError({id:l,topic:i,error:r}),this.client.logger.error(r)}},this.onSessionRequestResponse=(i,r)=>{let{id:c}=r,l=(0,t5.E0T)("session_request",c);if(0===this.events.listenerCount(l))throw Error(`emitting ${l} without any listeners`);(0,em.isJsonRpcResult)(r)?this.events.emit((0,t5.E0T)("session_request",c),{result:r.result}):(0,em.isJsonRpcError)(r)&&this.events.emit((0,t5.E0T)("session_request",c),{error:r.error})},this.onSessionEventRequest=async(i,r)=>{let{id:c,params:l}=r;try{let r=`${i}_session_event_${l.event.name}`,E=t5.O6B.get(r);if(E&&this.isRequestOutOfSync(E,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidEmit(sign_client_dist_index_es_y({topic:i},l)),this.client.events.emit("session_event",{id:c,topic:i,params:l}),t5.O6B.set(r,c)}catch(r){await this.sendError({id:c,topic:i,error:r}),this.client.logger.error(r)}},this.onSessionAuthenticateResponse=(i,r)=>{let{id:c}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:i,payload:r}),(0,em.isJsonRpcResult)(r)?this.events.emit((0,t5.E0T)("session_request",c),{result:r.result}):(0,em.isJsonRpcError)(r)&&this.events.emit((0,t5.E0T)("session_request",c),{error:r.error})},this.onSessionAuthenticateRequest=async(i,r)=>{let{requester:c,authPayload:l,expiryTimestamp:E}=r.params,S=(0,t5.rjm)(JSON.stringify(r)),P=await this.getVerifyContext(S,this.client.metadata),C={requester:c,pairingTopic:i,id:r.id,authPayload:l,verifyContext:P,expiryTimestamp:E};await this.setAuthRequest(r.id,{request:C,pairingTopic:i}),this.client.events.emit("session_authenticate",{topic:i,params:r.params,id:r.id})},this.addSessionRequestToSessionRequestQueue=i=>{this.sessionRequestQueue.queue.push(i)},this.cleanupAfterResponse=i=>{this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ia.idle,this.processSessionRequestQueue()},(0,F.toMiliseconds)(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:i,error:r})=>{let c=this.client.core.history.pending;c.length>0&&c.filter(r=>r.topic===i&&"wc_sessionRequest"===r.request.method).forEach(i=>{let c=i.request.id,l=(0,t5.E0T)("session_request",c);if(0===this.events.listenerCount(l))throw Error(`emitting ${l} without any listeners`);this.events.emit((0,t5.E0T)("session_request",i.request.id),{error:r})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ia.active){this.client.logger.info("session request queue is already active.");return}let i=this.sessionRequestQueue.queue[0];if(!i){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ia.active,this.emitSessionRequest(i)}catch(i){this.client.logger.error(i)}},this.emitSessionRequest=i=>{this.client.events.emit("session_request",i)},this.onPairingCreated=i=>{if(i.methods&&this.expectedPairingMethodMap.set(i.topic,i.methods),i.active)return;let r=this.client.proposal.getAll().find(r=>r.pairingTopic===i.topic);r&&this.onSessionProposeRequest(i.topic,(0,em.formatJsonRpcRequest)("wc_sessionPropose",{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties},r.id))},this.isValidConnect=async i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw Error(r)}let{pairingTopic:r,requiredNamespaces:c,optionalNamespaces:l,sessionProperties:E,relays:S}=i;if((0,t5.o8e)(r)||await this.isValidPairingTopic(r),!(0,t5.PMr)(S,!0)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`connect() relays: ${S}`);throw Error(i)}(0,t5.o8e)(c)||0===(0,t5.L5o)(c)||this.validateNamespaces(c,"requiredNamespaces"),(0,t5.o8e)(l)||0===(0,t5.L5o)(l)||this.validateNamespaces(l,"optionalNamespaces"),(0,t5.o8e)(E)||this.validateSessionProps(E,"sessionProperties")},this.validateNamespaces=(i,r)=>{let c=(0,t5.naP)(i,"connect()",r);if(c)throw Error(c.message)},this.isValidApprove=async i=>{if(!(0,t5.EJd)(i))throw Error((0,t5.kCb)("MISSING_OR_INVALID",`approve() params: ${i}`).message);let{id:r,namespaces:c,relayProtocol:l,sessionProperties:E}=i;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);let S=this.client.proposal.get(r),P=(0,t5.ing)(c,"approve()");if(P)throw Error(P.message);let C=(0,t5.rFo)(S.requiredNamespaces,c,"approve()");if(C)throw Error(C.message);if(!(0,t5.M_r)(l,!0)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw Error(i)}(0,t5.o8e)(E)||this.validateSessionProps(E,"sessionProperties")},this.isValidReject=async i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`reject() params: ${i}`);throw Error(r)}let{id:r,reason:c}=i;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!(0,t5.H4H)(c)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(c)}`);throw Error(i)}},this.isValidSessionSettleRequest=i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw Error(r)}let{relay:r,controller:c,namespaces:l,expiry:E}=i;if(!(0,t5.Z26)(r)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(i)}let S=(0,t5.DdM)(c,"onSessionSettleRequest()");if(S)throw Error(S.message);let P=(0,t5.ing)(l,"onSessionSettleRequest()");if(P)throw Error(P.message);if((0,t5.BwD)(E)){let{message:i}=(0,t5.kCb)("EXPIRED","onSessionSettleRequest()");throw Error(i)}},this.isValidUpdate=async i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`update() params: ${i}`);throw Error(r)}let{topic:r,namespaces:c}=i;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let l=this.client.session.get(r),E=(0,t5.ing)(c,"update()");if(E)throw Error(E.message);let S=(0,t5.rFo)(l.requiredNamespaces,c,"update()");if(S)throw Error(S.message)},this.isValidExtend=async i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`extend() params: ${i}`);throw Error(r)}let{topic:r}=i;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)},this.isValidRequest=async i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`request() params: ${i}`);throw Error(r)}let{topic:r,request:c,chainId:l,expiry:E}=i;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:S}=this.client.session.get(r);if(!(0,t5.p8o)(S,l)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`request() chainId: ${l}`);throw Error(i)}if(!(0,t5.hHR)(c)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`request() ${JSON.stringify(c)}`);throw Error(i)}if(!(0,t5.alS)(S,l,c.method)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`request() method: ${c.method}`);throw Error(i)}if(E&&!(0,t5.ONw)(E,ir)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`request() expiry: ${E}. Expiry must be a number (in seconds) between ${ir.min} and ${ir.max}`);throw Error(i)}},this.isValidRespond=async i=>{var r;if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`respond() params: ${i}`);throw Error(r)}let{topic:c,response:l}=i;try{await this.isValidSessionTopic(c)}catch(c){throw null!=(r=i?.response)&&r.id&&this.cleanupAfterResponse(i),c}if(!(0,t5.JTI)(l)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(l)}`);throw Error(i)}},this.isValidPing=async i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`ping() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidSessionOrPairingTopic(r)},this.isValidEmit=async i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`emit() params: ${i}`);throw Error(r)}let{topic:r,event:c,chainId:l}=i;await this.isValidSessionTopic(r);let{namespaces:E}=this.client.session.get(r);if(!(0,t5.p8o)(E,l)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw Error(i)}if(!(0,t5.nfW)(c)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(c)}`);throw Error(i)}if(!(0,t5.B95)(E,l,c.name)){let{message:i}=(0,t5.kCb)("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(c)}`);throw Error(i)}},this.isValidDisconnect=async i=>{if(!(0,t5.EJd)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw Error(r)}let{topic:r}=i;await this.isValidSessionOrPairingTopic(r)},this.isValidAuthenticate=i=>{let{chains:r,uri:c,domain:l,nonce:E}=i;if(!Array.isArray(r)||0===r.length)throw Error("chains is required and must be a non-empty array");if(!(0,t5.M_r)(c,!1))throw Error("uri is required parameter");if(!(0,t5.M_r)(l,!1))throw Error("domain is required parameter");if(!(0,t5.M_r)(E,!1))throw Error("nonce is required parameter");if([...new Set(r.map(i=>(0,t5.DQe)(i).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:S}=(0,t5.DQe)(r[0]);if("eip155"!==S)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async(i,r)=>{let c={verified:{verifyUrl:r.verifyUrl||tk,validation:"UNKNOWN",origin:r.url||""}};try{let l=await this.client.core.verify.resolve({attestationId:i,verifyUrl:r.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(r.url).origin?"VALID":"INVALID")}catch(i){this.client.logger.info(i)}return this.client.logger.info(`Verify context: ${JSON.stringify(c)}`),c},this.validateSessionProps=(i,r)=>{Object.values(i).forEach(i=>{if(!(0,t5.M_r)(i,!1)){let{message:c}=(0,t5.kCb)("MISSING_OR_INVALID",`${r} must be in Record<string, string> format. Received: ${JSON.stringify(i)}`);throw Error(c)}})},this.getPendingAuthRequest=i=>{let r=this.client.auth.requests.get(i);return"object"==typeof r?r:void 0},this.addToRecentlyDeleted=(i,r)=>{if(this.recentlyDeletedMap.set(i,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let i=0,r=this.recentlyDeletedLimit/2;for(let c of this.recentlyDeletedMap.keys()){if(i++>=r)break;this.recentlyDeletedMap.delete(c)}}},this.checkRecentlyDeleted=i=>{let r=this.recentlyDeletedMap.get(i);if(r){let{message:c}=(0,t5.kCb)("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${i}`);throw Error(c)}}}async isInitialized(){if(!this.initialized){let{message:i}=(0,t5.kCb)("NOT_INITIALIZED",this.name);throw Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(tS.message,async i=>{let{topic:r,message:c}=i,{publicKey:l}=this.client.auth.authKeys.keys.includes(ih)?this.client.auth.authKeys.get(ih):{responseTopic:void 0,publicKey:void 0},E=await this.client.core.crypto.decode(r,c,{receiverPublicKey:l});try{(0,em.isJsonRpcRequest)(E)?(this.client.core.history.set(r,E),this.onRelayEventRequest({topic:r,payload:E})):(0,em.isJsonRpcResponse)(E)?(await this.client.core.history.resolve(E),await this.onRelayEventResponse({topic:r,payload:E}),this.client.core.history.delete(r,E.id)):this.onRelayEventUnknownPayload({topic:r,payload:E})}catch(i){this.client.logger.error(i)}})}registerExpirerEvents(){this.client.core.expirer.on(tT.expired,async i=>{let{topic:r,id:c}=(0,t5.iPz)(i.target);return c&&this.client.pendingRequest.keys.includes(c)?await this.deletePendingSessionRequest(c,(0,t5.kCb)("EXPIRED"),!0):c&&this.client.auth.requests.keys.includes(c)?await this.deletePendingAuthRequest(c,(0,t5.kCb)("EXPIRED"),!0):void(r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):c&&(await this.deleteProposal(c,!0),this.client.events.emit("proposal_expire",{id:c})))})}registerPairingEvents(){this.client.core.pairing.events.on(tq.create,i=>this.onPairingCreated(i)),this.client.core.pairing.events.on(tq.delete,i=>{this.addToRecentlyDeleted(i.topic,"pairing")})}isValidPairingTopic(i){if(!(0,t5.M_r)(i,!1)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){let{message:r}=(0,t5.kCb)("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw Error(r)}if((0,t5.BwD)(this.client.core.pairing.pairings.get(i).expiry)){let{message:r}=(0,t5.kCb)("EXPIRED",`pairing topic: ${i}`);throw Error(r)}}async isValidSessionTopic(i){if(!(0,t5.M_r)(i,!1)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw Error(r)}if(this.checkRecentlyDeleted(i),!this.client.session.keys.includes(i)){let{message:r}=(0,t5.kCb)("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw Error(r)}if((0,t5.BwD)(this.client.session.get(i).expiry)){await this.deleteSession({topic:i});let{message:r}=(0,t5.kCb)("EXPIRED",`session topic: ${i}`);throw Error(r)}if(!this.client.core.crypto.keychain.has(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`session topic does not exist in keychain: ${i}`);throw await this.deleteSession({topic:i}),Error(r)}}async isValidSessionOrPairingTopic(i){if(this.checkRecentlyDeleted(i),this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if((0,t5.M_r)(i,!1)){let{message:r}=(0,t5.kCb)("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw Error(r)}else{let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw Error(r)}}async isValidProposalId(i){if(!(0,t5.Q01)(i)){let{message:r}=(0,t5.kCb)("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw Error(r)}if(!this.client.proposal.keys.includes(i)){let{message:r}=(0,t5.kCb)("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw Error(r)}if((0,t5.BwD)(this.client.proposal.get(i).expiryTimestamp)){await this.deleteProposal(i);let{message:r}=(0,t5.kCb)("EXPIRED",`proposal id: ${i}`);throw Error(r)}}};let index_es_es=class index_es_es extends Kt{constructor(i,r){super(i,r,"proposal",t2),this.core=i,this.logger=r}};let index_es_Ze=class index_es_Ze extends Kt{constructor(i,r){super(i,r,"session",t2),this.core=i,this.logger=r}};let index_es_ts=class index_es_ts extends Kt{constructor(i,r){super(i,r,"request",t2,i=>i.id),this.core=i,this.logger=r}};let index_es_ss=class index_es_ss extends Kt{constructor(i,r){super(i,r,"authKeys",ic,()=>ih),this.core=i,this.logger=r}};let index_es_is=class index_es_is extends Kt{constructor(i,r){super(i,r,"pairingTopics",ic),this.core=i,this.logger=r}};let index_es_rs=class index_es_rs extends Kt{constructor(i,r){super(i,r,"requests",ic,i=>i.id),this.core=i,this.logger=r}};let index_es_ns=class index_es_ns{constructor(i,r){this.core=i,this.logger=r,this.authKeys=new index_es_ss(this.core,this.logger),this.pairingTopics=new index_es_is(this.core,this.logger),this.requests=new index_es_rs(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}};let oe=class oe extends b{constructor(i){super(i),this.protocol="wc",this.version=2,this.name=t3.name,this.events=new E.EventEmitter,this.on=(i,r)=>this.events.on(i,r),this.once=(i,r)=>this.events.once(i,r),this.off=(i,r)=>this.events.off(i,r),this.removeListener=(i,r)=>this.events.removeListener(i,r),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(i){throw this.logger.error(i.message),i}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(i){throw this.logger.error(i.message),i}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(i){throw this.logger.error(i.message),i}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(i){throw this.logger.error(i.message),i}},this.update=async i=>{try{return await this.engine.update(i)}catch(i){throw this.logger.error(i.message),i}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(i){throw this.logger.error(i.message),i}},this.request=async i=>{try{return await this.engine.request(i)}catch(i){throw this.logger.error(i.message),i}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(i){throw this.logger.error(i.message),i}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(i){throw this.logger.error(i.message),i}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(i){throw this.logger.error(i.message),i}},this.find=i=>{try{return this.engine.find(i)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.authenticate=async i=>{try{return await this.engine.authenticate(i)}catch(i){throw this.logger.error(i.message),i}},this.formatAuthMessage=i=>{try{return this.engine.formatAuthMessage(i)}catch(i){throw this.logger.error(i.message),i}},this.approveSessionAuthenticate=async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(i){throw this.logger.error(i.message),i}},this.rejectSessionAuthenticate=async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(i){throw this.logger.error(i.message),i}},this.name=i?.name||t3.name,this.metadata=i?.metadata||(0,t5.DaH)(),this.signConfig=i?.signConfig;let r="u">typeof i?.logger&&"string"!=typeof i?.logger?i.logger:(0,ee.gw)((0,ee.jI)({level:i?.logger||t3.logger}));this.core=i?.core||new ie(i),this.logger=(0,ee.Ep)(r,this.name),this.session=new index_es_Ze(this.core,this.logger),this.proposal=new index_es_es(this.core,this.logger),this.pendingRequest=new index_es_ts(this.core,this.logger),this.engine=new Zt(this),this.auth=new index_es_ns(this.core,this.logger)}static async init(i){let r=new oe(i);return await r.initialize(),r}get context(){return(0,ee.Fd)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),await this.auth.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}};var i_=c(88900);let iw="error",ib="wc@2:universal_provider:",iI={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var iE="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof c.g?c.g:"u">typeof self?self:{},ix={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */!function(i,r){(function(){var c,l="Expected a function",E="__lodash_hash_undefined__",S="__lodash_placeholder__",P=1/0,C=0/0,A=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],q="[object Arguments]",T="[object Array]",D="[object Boolean]",M="[object Date]",U="[object Error]",B="[object Function]",F="[object GeneratorFunction]",J="[object Map]",X="[object Number]",ee="[object Object]",et="[object Promise]",ea="[object RegExp]",eo="[object Set]",ec="[object String]",eh="[object Symbol]",el="[object WeakMap]",ep="[object ArrayBuffer]",ed="[object DataView]",ef="[object Float32Array]",eg="[object Float64Array]",ey="[object Int8Array]",em="[object Int16Array]",e_="[object Int32Array]",ew="[object Uint8Array]",eb="[object Uint8ClampedArray]",eI="[object Uint16Array]",eE="[object Uint32Array]",ex=/\b__p \+= '';/g,eS=/\b(__p \+=) '' \+/g,eP=/(__e\(.*?\)|\b__t\)) \+\n'';/g,eC=/&(?:amp|lt|gt|quot|#39);/g,eR=/[&<>"']/g,eO=RegExp(eC.source),eA=RegExp(eR.source),eN=/<%-([\s\S]+?)%>/g,eT=/<%([\s\S]+?)%>/g,eD=/<%=([\s\S]+?)%>/g,ek=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ej=/^\w*$/,eM=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ez=/[\\^$.*+?()[\]{}|]/g,eL=RegExp(ez.source),e$=/^\s+/,eH=/\s/,eU=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,eK=/\{\n\/\* \[wrapped with (.+)\] \*/,eV=/,? & /,eB=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,eW=/[()=,{}\[\]\/\s]/,eF=/\\(\\)?/g,eG=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,eJ=/\w*$/,eY=/^[-+]0x[0-9a-f]+$/i,eZ=/^0b[01]+$/i,eQ=/^\[object .+?Constructor\]$/,eX=/^0o[0-7]+$/i,e0=/^(?:0|[1-9]\d*)$/,e1=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,e5=/($^)/,e6=/['\n\r\u2028\u2029\\]/g,e2="\ud800-\udfff",e3="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",e4="\\u2700-\\u27bf",e9="a-z\\xdf-\\xf6\\xf8-\\xff",e8="A-Z\\xc0-\\xd6\\xd8-\\xde",e7="\\ufe0e\\ufe0f",te="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",tn="['’]",to="["+te+"]",tc="["+e3+"]",th="["+e9+"]",tl="[^"+e2+te+"\\d+"+e4+e9+e8+"]",tp="\ud83c[\udffb-\udfff]",td="[^"+e2+"]",tg="(?:\ud83c[\udde6-\uddff]){2}",ty="[\ud800-\udbff][\udc00-\udfff]",tm="["+e8+"]",t_="\\u200d",tw="(?:"+th+"|"+tl+")",tb="(?:"+tn+"(?:d|ll|m|re|s|t|ve))?",tI="(?:"+tn+"(?:D|LL|M|RE|S|T|VE))?",tE="(?:"+tc+"|"+tp+")?",tx="["+e7+"]?",tS="(?:"+t_+"(?:"+[td,tg,ty].join("|")+")"+tx+tE+")*",tP=tx+tE+tS,tC="(?:"+["["+e4+"]",tg,ty].join("|")+")"+tP,tR="(?:"+[td+tc+"?",tc,tg,ty,"["+e2+"]"].join("|")+")",tO=RegExp(tn,"g"),tA=RegExp(tc,"g"),tq=RegExp(tp+"(?="+tp+")|"+tR+tP,"g"),tN=RegExp([tm+"?"+th+"+"+tb+"(?="+[to,tm,"$"].join("|")+")","(?:"+tm+"|"+tl+")+"+tI+"(?="+[to,tm+tw,"$"].join("|")+")",tm+"?"+tw+"+"+tb,tm+"+"+tI,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",tC].join("|"),"g"),tT=RegExp("["+t_+e2+e3+e7+"]"),tD=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,tk=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],tj=-1,tM={};tM[ef]=tM[eg]=tM[ey]=tM[em]=tM[e_]=tM[ew]=tM[eb]=tM[eI]=tM[eE]=!0,tM[q]=tM[T]=tM[ep]=tM[D]=tM[ed]=tM[M]=tM[U]=tM[B]=tM[J]=tM[X]=tM[ee]=tM[ea]=tM[eo]=tM[ec]=tM[el]=!1;var tz={};tz[q]=tz[T]=tz[ep]=tz[ed]=tz[D]=tz[M]=tz[ef]=tz[eg]=tz[ey]=tz[em]=tz[e_]=tz[J]=tz[X]=tz[ee]=tz[ea]=tz[eo]=tz[ec]=tz[eh]=tz[ew]=tz[eb]=tz[eI]=tz[eE]=!0,tz[U]=tz[B]=tz[el]=!1;var tL={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},t$=parseFloat,tH=parseInt,tU="object"==typeof iE&&iE&&iE.Object===Object&&iE,tK="object"==typeof self&&self&&self.Object===Object&&self,tV=tU||tK||Function("return this")(),tB=r&&!r.nodeType&&r,tW=tB&&i&&!i.nodeType&&i,tF=tW&&tW.exports===tB,tG=tF&&tU.process,tJ=function(){try{return tW&&tW.require&&tW.require("util").types||tG&&tG.binding&&tG.binding("util")}catch{}}(),tY=tJ&&tJ.isArrayBuffer,tZ=tJ&&tJ.isDate,tQ=tJ&&tJ.isMap,tX=tJ&&tJ.isRegExp,t0=tJ&&tJ.isSet,t1=tJ&&tJ.isTypedArray;function cn(i,r,c){switch(c.length){case 0:return i.call(r);case 1:return i.call(r,c[0]);case 2:return i.call(r,c[0],c[1]);case 3:return i.call(r,c[0],c[1],c[2])}return i.apply(r,c)}function jo(i,r,c,l){for(var E=-1,S=null==i?0:i.length;++E<S;){var P=i[E];r(l,P,c(P),i)}return l}function mn(i,r){for(var c=-1,l=null==i?0:i.length;++c<l&&!1!==r(i[c],c,i););return i}function Cs(i,r){for(var c=-1,l=null==i?0:i.length;++c<l;)if(!r(i[c],c,i))return!1;return!0}function jn(i,r){for(var c=-1,l=null==i?0:i.length,E=0,S=[];++c<l;){var P=i[c];r(P,c,i)&&(S[E++]=P)}return S}function Ee(i,r){return!!(null==i?0:i.length)&&Tt(i,r,0)>-1}function Dr(i,r,c){for(var l=-1,E=null==i?0:i.length;++l<E;)if(c(r,i[l]))return!0;return!1}function G(i,r){for(var c=-1,l=null==i?0:i.length,E=Array(l);++c<l;)E[c]=r(i[c],c,i);return E}function nt(i,r){for(var c=-1,l=r.length,E=i.length;++c<l;)i[E+c]=r[c];return i}function Nr(i,r,c,l){var E=-1,S=null==i?0:i.length;for(l&&S&&(c=i[++E]);++E<S;)c=r(c,i[E],E,i);return c}function tf(i,r,c,l){var E=null==i?0:i.length;for(l&&E&&(c=i[--E]);E--;)c=r(c,i[E],E,i);return c}function Hr(i,r){for(var c=-1,l=null==i?0:i.length;++c<l;)if(r(i[c],c,i))return!0;return!1}var t5=$r("length");function Is(i,r,c){var l;return c(i,function(i,c,E){if(r(i,c,E))return l=c,!1}),l}function ye(i,r,c,l){for(var E=i.length,S=c+(l?1:-1);l?S--:++S<E;)if(r(i[S],S,i))return S;return -1}function Tt(i,r,c){return r==r?function(i,r,c){for(var l=c-1,E=i.length;++l<E;)if(i[l]===r)return l;return -1}(i,r,c):ye(i,xs,c)}function uf(i,r,c,l){for(var E=c-1,S=i.length;++E<S;)if(l(i[E],r))return E;return -1}function xs(i){return i!=i}function Es(i,r){var c=null==i?0:i.length;return c?Wr(i,r)/c:C}function $r(i){return function(r){return null==r?c:r[i]}}function Ur(i){return function(r){return null==i?c:i[r]}}function ys(i,r,c,l,E){return E(i,function(i,E,S){c=l?(l=!1,i):r(c,i,E,S)}),c}function Wr(i,r){for(var l,E=-1,S=i.length;++E<S;){var P=r(i[E]);P!==c&&(l=l===c?P:l+P)}return l}function Fr(i,r){for(var c=-1,l=Array(i);++c<i;)l[c]=r(c);return l}function Ss(i){return i&&i.slice(0,Ts(i)+1).replace(e$,"")}function hn(i){return function(r){return i(r)}}function Mr(i,r){return G(r,function(r){return i[r]})}function jt(i,r){return i.has(r)}function Os(i,r){for(var c=-1,l=i.length;++c<l&&Tt(r,i[c],0)>-1;);return c}function Rs(i,r){for(var c=i.length;c--&&Tt(r,i[c],0)>-1;);return c}var t6=Ur({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),t2=Ur({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function lf(i){return"\\"+tL[i]}function Lt(i){return tT.test(i)}function qr(i){var r=-1,c=Array(i.size);return i.forEach(function(i,l){c[++r]=[l,i]}),c}function bs(i,r){return function(c){return i(r(c))}}function tt(i,r){for(var c=-1,l=i.length,E=0,P=[];++c<l;){var C=i[c];(C===r||C===S)&&(i[c]=S,P[E++]=c)}return P}function Se(i){var r=-1,c=Array(i.size);return i.forEach(function(i){c[++r]=i}),c}function Dt(i){return Lt(i)?function(i){for(var r=tq.lastIndex=0;tq.test(i);)++r;return r}(i):t5(i)}function On(i){return Lt(i)?i.match(tq)||[]:i.split("")}function Ts(i){for(var r=i.length;r--&&eH.test(i.charAt(r)););return r}var t3=Ur({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),t4=function h(i){var r,eH,e2,e3,e4=(i=null==i?tV:t4.defaults(tV.Object(),i,t4.pick(tV,tk))).Array,e9=i.Date,e8=i.Error,e7=i.Function,te=i.Math,tn=i.Object,to=i.RegExp,tc=i.String,th=i.TypeError,tl=e4.prototype,tp=e7.prototype,td=tn.prototype,tg=i["__core-js_shared__"],ty=tp.toString,tm=td.hasOwnProperty,t_=0,tw=(r=/[^.]+$/.exec(tg&&tg.keys&&tg.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",tb=td.toString,tI=ty.call(tn),tE=tV._,tx=to("^"+ty.call(tm).replace(ez,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tS=tF?i.Buffer:c,tP=i.Symbol,tC=i.Uint8Array,tR=tS?tS.allocUnsafe:c,tq=bs(tn.getPrototypeOf,tn),tT=tn.create,tL=td.propertyIsEnumerable,tU=tl.splice,tK=tP?tP.isConcatSpreadable:c,tB=tP?tP.iterator:c,tW=tP?tP.toStringTag:c,tG=function(){try{var i=mt(tn,"defineProperty");return i({},"",{}),i}catch{}}(),tJ=i.clearTimeout!==tV.clearTimeout&&i.clearTimeout,t5=e9&&e9.now!==tV.Date.now&&e9.now,t9=i.setTimeout!==tV.setTimeout&&i.setTimeout,t8=te.ceil,t7=te.floor,ir=tn.getOwnPropertySymbols,ia=tS?tS.isBuffer:c,io=i.isFinite,ic=tl.join,ih=bs(tn.keys,tn),il=te.max,ip=te.min,id=e9.now,ig=i.parseInt,iy=te.random,im=tl.reverse,i_=mt(i,"DataView"),iw=mt(i,"Map"),ib=mt(i,"Promise"),iI=mt(i,"Set"),iE=mt(i,"WeakMap"),ix=mt(tn,"create"),iS=iE&&new iE,iP={},iC=wt(i_),iR=wt(iw),iO=wt(ib),iA=wt(iI),iq=wt(iE),iN=tP?tP.prototype:c,iT=iN?iN.valueOf:c,iD=iN?iN.toString:c;function a(i){if(Y(i)&&!rD(i)&&!(i instanceof H)){if(i instanceof Pn)return i;if(tm.call(i,"__wrapped__"))return Mu(i)}return new Pn(i)}var ik=function(){function n(){}return function(i){if(!K(i))return{};if(tT)return tT(i);n.prototype=i;var r=new n;return n.prototype=c,r}}();function qe(){}function Pn(i,r){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=c}function H(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function dt(i){var r=-1,c=null==i?0:i.length;for(this.clear();++r<c;){var l=i[r];this.set(l[0],l[1])}}function Bn(i){var r=-1,c=null==i?0:i.length;for(this.clear();++r<c;){var l=i[r];this.set(l[0],l[1])}}function Gn(i){var r=-1,c=null==i?0:i.length;for(this.clear();++r<c;){var l=i[r];this.set(l[0],l[1])}}function gt(i){var r=-1,c=null==i?0:i.length;for(this.__data__=new Gn;++r<c;)this.add(i[r])}function Rn(i){var r=this.__data__=new Bn(i);this.size=r.size}function Ms(i,r){var c=rD(i),l=!c&&rT(i),E=!c&&!l&&rj(i),S=!c&&!l&&!E&&rH(i),P=c||l||E||S,C=P?Fr(i.length,tc):[],A=C.length;for(var q in i)(r||tm.call(i,q))&&!(P&&("length"==q||E&&("offset"==q||"parent"==q)||S&&("buffer"==q||"byteLength"==q||"byteOffset"==q)||Zn(q,A)))&&C.push(q);return C}function qs(i){var r=i.length;return r?i[ei(0,r-1)]:c}function Yr(i,r,l){(l===c||bn(i[r],l))&&(l!==c||r in i)||zn(i,r,l)}function se(i,r,l){var E=i[r];tm.call(i,r)&&bn(E,l)&&(l!==c||r in i)||zn(i,r,l)}function Be(i,r){for(var c=i.length;c--;)if(bn(i[c][0],r))return c;return -1}function _c(i,r,c,l){return ij(i,function(i,E,S){r(l,i,c(i),S)}),l}function Bs(i,r){return i&&Un(r,V(r),i)}function zn(i,r,c){"__proto__"==r&&tG?tG(i,r,{configurable:!0,enumerable:!0,value:c,writable:!0}):i[r]=c}function Zr(i,r){for(var l=-1,E=r.length,S=e4(E),P=null==i;++l<E;)S[l]=P?c:Si(i,r[l]);return S}function vt(i,r,l){return i==i&&(l!==c&&(i=i<=l?i:l),r!==c&&(i=i>=r?i:r)),i}function An(i,r,l,E,S,P){var C,A=1&r,T=2&r,U=4&r;if(l&&(C=S?l(i,E,S,P):l(i)),C!==c)return C;if(!K(i))return i;var et=rD(i);if(et){if(el=i.length,ex=new i.constructor(el),el&&"string"==typeof i[0]&&tm.call(i,"index")&&(ex.index=i.index,ex.input=i.input),C=ex,!A)return un(i,C)}else{var el,ex,eS,eP,eC,eR=iF(i),eO=eR==B||eR==F;if(rj(i))return lu(i,A);if(eR==ee||eR==q||eO&&!S){if(C=T||eO?{}:Tu(i),!A)return T?(eS=(eC=C)&&Un(i,on(i),eC),Un(i,iW(i),eS)):(eP=Bs(C,i),Un(i,iB(i),eP))}else{if(!tz[eR])return S?i:{};C=function(i,r,c){var l,E,S=i.constructor;switch(r){case ep:return fi(i);case D:case M:return new S(+i);case ed:return l=c?fi(i.buffer):i.buffer,new i.constructor(l,i.byteOffset,i.byteLength);case ef:case eg:case ey:case em:case e_:case ew:case eb:case eI:case eE:return pu(i,c);case J:return new S;case X:case ec:return new S(i);case ea:return(E=new i.constructor(i.source,eJ.exec(i))).lastIndex=i.lastIndex,E;case eo:return new S;case eh:return iT?tn(iT.call(i)):{}}}(i,eR,A)}}P||(P=new Rn);var eA=P.get(i);if(eA)return eA;P.set(i,C),r$(i)?i.forEach(function(c){C.add(An(c,r,l,c,i,P))}):rz(i)&&i.forEach(function(c,E){C.set(E,An(c,r,l,E,i,P))});var eN=U?T?pi:li:T?on:V,eT=et?c:eN(i);return mn(eT||i,function(c,E){eT&&(c=i[E=c]),se(C,E,An(c,r,l,E,i,P))}),C}function Gs(i,r,l){var E=l.length;if(null==i)return!E;for(i=tn(i);E--;){var S=l[E],P=r[S],C=i[S];if(C===c&&!(S in i)||!P(C))return!1}return!0}function zs(i,r,E){if("function"!=typeof i)throw new th(l);return iY(function(){i.apply(c,E)},r)}function ue(i,r,c,l){var E=-1,S=Ee,P=!0,C=i.length,A=[],q=r.length;if(!C)return A;c&&(r=G(r,hn(c))),l?(S=Dr,P=!1):r.length>=200&&(S=jt,P=!1,r=new gt(r));e:for(;++E<C;){var T=i[E],D=null==c?T:c(T);if(T=l||0!==T?T:0,P&&D==D){for(var M=q;M--;)if(r[M]===D)continue e;A.push(T)}else S(r,D,l)||A.push(T)}return A}a.templateSettings={escape:eN,evaluate:eT,interpolate:eD,variable:"",imports:{_:a}},a.prototype=qe.prototype,a.prototype.constructor=a,Pn.prototype=ik(qe.prototype),Pn.prototype.constructor=Pn,H.prototype=ik(qe.prototype),H.prototype.constructor=H,dt.prototype.clear=function(){this.__data__=ix?ix(null):{},this.size=0},dt.prototype.delete=function(i){var r=this.has(i)&&delete this.__data__[i];return this.size-=r?1:0,r},dt.prototype.get=function(i){var r=this.__data__;if(ix){var l=r[i];return l===E?c:l}return tm.call(r,i)?r[i]:c},dt.prototype.has=function(i){var r=this.__data__;return ix?r[i]!==c:tm.call(r,i)},dt.prototype.set=function(i,r){var l=this.__data__;return this.size+=this.has(i)?0:1,l[i]=ix&&r===c?E:r,this},Bn.prototype.clear=function(){this.__data__=[],this.size=0},Bn.prototype.delete=function(i){var r=this.__data__,c=Be(r,i);return!(c<0)&&(c==r.length-1?r.pop():tU.call(r,c,1),--this.size,!0)},Bn.prototype.get=function(i){var r=this.__data__,l=Be(r,i);return l<0?c:r[l][1]},Bn.prototype.has=function(i){return Be(this.__data__,i)>-1},Bn.prototype.set=function(i,r){var c=this.__data__,l=Be(c,i);return l<0?(++this.size,c.push([i,r])):c[l][1]=r,this},Gn.prototype.clear=function(){this.size=0,this.__data__={hash:new dt,map:new(iw||Bn),string:new dt}},Gn.prototype.delete=function(i){var r=nr(this,i).delete(i);return this.size-=r?1:0,r},Gn.prototype.get=function(i){return nr(this,i).get(i)},Gn.prototype.has=function(i){return nr(this,i).has(i)},Gn.prototype.set=function(i,r){var c=nr(this,i),l=c.size;return c.set(i,r),this.size+=c.size==l?0:1,this},gt.prototype.add=gt.prototype.push=function(i){return this.__data__.set(i,E),this},gt.prototype.has=function(i){return this.__data__.has(i)},Rn.prototype.clear=function(){this.__data__=new Bn,this.size=0},Rn.prototype.delete=function(i){var r=this.__data__,c=r.delete(i);return this.size=r.size,c},Rn.prototype.get=function(i){return this.__data__.get(i)},Rn.prototype.has=function(i){return this.__data__.has(i)},Rn.prototype.set=function(i,r){var c=this.__data__;if(c instanceof Bn){var l=c.__data__;if(!iw||l.length<199)return l.push([i,r]),this.size=++c.size,this;c=this.__data__=new Gn(l)}return c.set(i,r),this.size=c.size,this};var ij=_u($n),iM=_u(Xr,!0);function Pc(i,r){var c=!0;return ij(i,function(i,l,E){return c=!!r(i,l,E)}),c}function Ge(i,r,l){for(var E=-1,S=i.length;++E<S;){var P=i[E],C=r(P);if(null!=C&&(A===c?C==C&&!pn(C):l(C,A)))var A=C,q=P}return q}function Ys(i,r){var c=[];return ij(i,function(i,l,E){r(i,l,E)&&c.push(i)}),c}function j(i,r,c,l,E){var S=-1,P=i.length;for(c||(c=fh),E||(E=[]);++S<P;){var C=i[S];r>0&&c(C)?r>1?j(C,r-1,c,l,E):nt(E,C):l||(E[E.length]=C)}return E}var iz=mu(),iL=mu(!0);function $n(i,r){return i&&iz(i,r,V)}function Xr(i,r){return i&&iL(i,r,V)}function ze(i,r){return jn(r,function(r){return Jn(i[r])})}function _t(i,r){r=st(r,i);for(var l=0,E=r.length;null!=i&&l<E;)i=i[Wn(r[l++])];return l&&l==E?i:c}function Js(i,r,c){var l=r(i);return rD(i)?l:nt(l,c(i))}function en(i){return null==i?i===c?"[object Undefined]":"[object Null]":tW&&tW in tn(i)?function(i){var r=tm.call(i,tW),l=i[tW];try{i[tW]=c;var E=!0}catch{}var S=tb.call(i);return E&&(r?i[tW]=l:delete i[tW]),S}(i):tb.call(i)}function Qr(i,r){return i>r}function Cc(i,r){return null!=i&&tm.call(i,r)}function Ic(i,r){return null!=i&&r in tn(i)}function Vr(i,r,l){for(var E=l?Dr:Ee,S=i[0].length,P=i.length,C=P,A=e4(P),q=1/0,T=[];C--;){var D=i[C];C&&r&&(D=G(D,hn(r))),q=ip(D.length,q),A[C]=!l&&(r||S>=120&&D.length>=120)?new gt(C&&D):c}D=i[0];var M=-1,U=A[0];e:for(;++M<S&&T.length<q;){var B=D[M],F=r?r(B):B;if(B=l||0!==B?B:0,!(U?jt(U,F):E(T,F,l))){for(C=P;--C;){var J=A[C];if(!(J?jt(J,F):E(i[C],F,l)))continue e}U&&U.push(F),T.push(B)}}return T}function ae(i,r,l){r=st(r,i);var E=null==(i=Hu(i,r))?i:i[Wn(In(r))];return null==E?c:cn(E,i,l)}function Xs(i){return Y(i)&&en(i)==q}function oe(i,r,l,E,S){return i===r||(null!=i&&null!=r&&(Y(i)||Y(r))?function(i,r,l,E,S,P){var C=rD(i),A=rD(r),B=C?T:iF(i),F=A?T:iF(r);B=B==q?ee:B,F=F==q?ee:F;var et=B==ee,el=F==ee,ef=B==F;if(ef&&rj(i)){if(!rj(r))return!1;C=!0,et=!1}if(ef&&!et)return P||(P=new Rn),C||rH(i)?Ou(i,r,l,E,S,P):function(i,r,c,l,E,S,P){switch(c){case ed:if(i.byteLength!=r.byteLength||i.byteOffset!=r.byteOffset)break;i=i.buffer,r=r.buffer;case ep:return!(i.byteLength!=r.byteLength||!S(new tC(i),new tC(r)));case D:case M:case X:return bn(+i,+r);case U:return i.name==r.name&&i.message==r.message;case ea:case ec:return i==r+"";case J:var C=qr;case eo:var A=1&l;if(C||(C=Se),i.size!=r.size&&!A)break;var q=P.get(i);if(q)return q==r;l|=2,P.set(i,r);var T=Ou(C(i),C(r),l,E,S,P);return P.delete(i),T;case eh:if(iT)return iT.call(i)==iT.call(r)}return!1}(i,r,B,l,E,S,P);if(!(1&l)){var eg=et&&tm.call(i,"__wrapped__"),ey=el&&tm.call(r,"__wrapped__");if(eg||ey){var em=eg?i.value():i,e_=ey?r.value():r;return P||(P=new Rn),S(em,e_,l,E,P)}}return!!ef&&(P||(P=new Rn),function(i,r,l,E,S,P){var C=1&l,A=li(i),q=A.length;if(q!=li(r).length&&!C)return!1;for(var T=q;T--;){var D=A[T];if(!(C?D in r:tm.call(r,D)))return!1}var M=P.get(i),U=P.get(r);if(M&&U)return M==r&&U==i;var B=!0;P.set(i,r),P.set(r,i);for(var F=C;++T<q;){var J=i[D=A[T]],X=r[D];if(E)var ee=C?E(X,J,D,r,i,P):E(J,X,D,i,r,P);if(!(ee===c?J===X||S(J,X,l,E,P):ee)){B=!1;break}F||(F="constructor"==D)}if(B&&!F){var et=i.constructor,ea=r.constructor;et!=ea&&"constructor"in i&&"constructor"in r&&!("function"==typeof et&&et instanceof et&&"function"==typeof ea&&ea instanceof ea)&&(B=!1)}return P.delete(i),P.delete(r),B}(i,r,l,E,S,P))}(i,r,l,E,oe,S):i!=i&&r!=r)}function kr(i,r,l,E){var S=l.length,P=S,C=!E;if(null==i)return!P;for(i=tn(i);S--;){var A=l[S];if(C&&A[2]?A[1]!==i[A[0]]:!(A[0]in i))return!1}for(;++S<P;){var q=(A=l[S])[0],T=i[q],D=A[1];if(C&&A[2]){if(T===c&&!(q in i))return!1}else{var M=new Rn;if(E)var U=E(T,D,q,i,r,M);if(!(U===c?oe(D,T,3,E,M):U))return!1}}return!0}function Qs(i){return!(!K(i)||tw&&tw in i)&&(Jn(i)?tx:eQ).test(wt(i))}function Vs(i){return"function"==typeof i?i:null==i?fn:"object"==typeof i?rD(i)?nu(i[0],i[1]):js(i):wa(i)}function jr(i){if(!he(i))return ih(i);var r=[];for(var c in tn(i))tm.call(i,c)&&"constructor"!=c&&r.push(c);return r}function ni(i,r){return i<r}function ks(i,r){var c=-1,l=an(i)?e4(i.length):[];return ij(i,function(i,E,S){l[++c]=r(i,E,S)}),l}function js(i){var r=gi(i);return 1==r.length&&r[0][2]?Du(r[0][0],r[0][1]):function(c){return c===i||kr(c,i,r)}}function nu(i,r){var l;return _i(i)&&(l=r)==l&&!K(l)?Du(Wn(i),r):function(l){var E=Si(l,i);return E===c&&E===r?Oi(l,i):oe(r,E,3)}}function Ke(i,r,l,E,S){i!==r&&iz(r,function(P,C){if(S||(S=new Rn),K(P))!function(i,r,l,E,S,P,C){var A=wi(i,l),q=wi(r,l),T=C.get(q);if(T){Yr(i,l,T);return}var D=P?P(A,q,l+"",i,r,C):c,M=D===c;if(M){var U=rD(q),B=!U&&rj(q),F=!U&&!B&&rH(q);D=q,U||B||F?rD(A)?D=A:Z(A)?D=un(A):B?(M=!1,D=lu(q,!0)):F?(M=!1,D=pu(q,!0)):D=[]:pe(q)||rT(q)?(D=A,rT(A)?D=fa(A):(!K(A)||Jn(A))&&(D=Tu(q))):M=!1}M&&(C.set(q,D),S(D,q,E,P,C),C.delete(q)),Yr(i,l,D)}(i,r,C,l,Ke,E,S);else{var A=E?E(wi(i,C),P,C+"",i,r,S):c;A===c&&(A=P),Yr(i,C,A)}},on)}function tu(i,r){var l=i.length;if(l)return Zn(r+=r<0?l:0,l)?i[r]:c}function eu(i,r,c){r=r.length?G(r,function(i){return rD(i)?function(r){return _t(r,1===i.length?i[0]:i)}:i}):[fn];var l=-1;return r=G(r,hn(x())),function(i,r){var c=i.length;for(i.sort(r);c--;)i[c]=i[c].value;return i}(ks(i,function(i,c,E){return{criteria:G(r,function(r){return r(i)}),index:++l,value:i}}),function(i,r){return function(i,r,c){for(var l=-1,E=i.criteria,S=r.criteria,P=E.length,C=c.length;++l<P;){var A=du(E[l],S[l]);if(A){if(l>=C)return A;return A*("desc"==c[l]?-1:1)}}return i.index-r.index}(i,r,c)})}function ru(i,r,c){for(var l=-1,E=r.length,S={};++l<E;){var P=r[l],C=_t(i,P);c(C,P)&&fe(S,st(P,i),C)}return S}function ti(i,r,c,l){var E=l?uf:Tt,S=-1,P=r.length,C=i;for(i===r&&(r=un(r)),c&&(C=G(i,hn(c)));++S<P;)for(var A=0,q=r[S],T=c?c(q):q;(A=E(C,T,A,l))>-1;)C!==i&&tU.call(C,A,1),tU.call(i,A,1);return i}function iu(i,r){for(var c=i?r.length:0,l=c-1;c--;){var E=r[c];if(c==l||E!==S){var S=E;Zn(E)?tU.call(i,E,1):si(i,E)}}return i}function ei(i,r){return i+t7(iy()*(r-i+1))}function ri(i,r){var c="";if(!i||r<1||r>9007199254740991)return c;do r%2&&(c+=i),(r=t7(r/2))&&(i+=i);while(r);return c}function L(i,r){return iZ(Nu(i,r,fn),i+"")}function fe(i,r,l,E){if(!K(i))return i;r=st(r,i);for(var S=-1,P=r.length,C=P-1,A=i;null!=A&&++S<P;){var q=Wn(r[S]),T=l;if("__proto__"===q||"constructor"===q||"prototype"===q)break;if(S!=C){var D=A[q];(T=E?E(D,q,A):c)===c&&(T=K(D)?D:Zn(r[S+1])?[]:{})}se(A,q,T),A=A[q]}return i}var i$=iS?function(i,r){return iS.set(i,r),i}:fn,iH=tG?function(i,r){return tG(i,"toString",{configurable:!0,enumerable:!1,value:bi(r),writable:!0})}:fn;function Cn(i,r,c){var l=-1,E=i.length;r<0&&(r=-r>E?0:E+r),(c=c>E?E:c)<0&&(c+=E),E=r>c?0:c-r>>>0,r>>>=0;for(var S=e4(E);++l<E;)S[l]=i[l+r];return S}function Bc(i,r){var c;return ij(i,function(i,l,E){return!(c=r(i,l,E))}),!!c}function Ye(i,r,c){var l=0,E=null==i?l:i.length;if("number"==typeof r&&r==r&&E<=2147483647){for(;l<E;){var S=l+E>>>1,P=i[S];null!==P&&!pn(P)&&(c?P<=r:P<r)?l=S+1:E=S}return E}return ii(i,r,fn,c)}function ii(i,r,l,E){var S=0,P=null==i?0:i.length;if(0===P)return 0;r=l(r);for(var C=r!=r,A=null===r,q=pn(r),T=r===c;S<P;){var D=t7((S+P)/2),M=l(i[D]),U=M!==c,B=null===M,F=M==M,J=pn(M);if(C)var X=E||F;else X=T?F&&(E||U):A?F&&U&&(E||!B):q?F&&U&&!B&&(E||!J):!B&&!J&&(E?M<=r:M<r);X?S=D+1:P=D}return ip(P,4294967294)}function uu(i,r){for(var c=-1,l=i.length,E=0,S=[];++c<l;){var P=i[c],C=r?r(P):P;if(!c||!bn(C,A)){var A=C;S[E++]=0===P?0:P}}return S}function au(i){return"number"==typeof i?i:pn(i)?C:+i}function ln(i){if("string"==typeof i)return i;if(rD(i))return G(i,ln)+"";if(pn(i))return iD?iD.call(i):"";var r=i+"";return"0"==r&&1/i==-P?"-0":r}function it(i,r,c){var l=-1,E=Ee,S=i.length,P=!0,C=[],A=C;if(c)P=!1,E=Dr;else if(S>=200){var q=r?null:iK(i);if(q)return Se(q);P=!1,E=jt,A=new gt}else A=r?[]:C;e:for(;++l<S;){var T=i[l],D=r?r(T):T;if(T=c||0!==T?T:0,P&&D==D){for(var M=A.length;M--;)if(A[M]===D)continue e;r&&A.push(D),C.push(T)}else E(A,D,c)||(A!==C&&A.push(D),C.push(T))}return C}function si(i,r){return r=st(r,i),null==(i=Hu(i,r))||delete i[Wn(In(r))]}function ou(i,r,c,l){return fe(i,r,c(_t(i,r)),l)}function Ze(i,r,c,l){for(var E=i.length,S=l?E:-1;(l?S--:++S<E)&&r(i[S],S,i););return c?Cn(i,l?0:S,l?S+1:E):Cn(i,l?S+1:0,l?E:S)}function fu(i,r){var c=i;return c instanceof H&&(c=c.value()),Nr(r,function(i,r){return r.func.apply(r.thisArg,nt([i],r.args))},c)}function ui(i,r,c){var l=i.length;if(l<2)return l?it(i[0]):[];for(var E=-1,S=e4(l);++E<l;)for(var P=i[E],C=-1;++C<l;)C!=E&&(S[E]=ue(S[E]||P,i[C],r,c));return it(j(S,1),r,c)}function cu(i,r,l){for(var E=-1,S=i.length,P=r.length,C={};++E<S;){var A=E<P?r[E]:c;l(C,i[E],A)}return C}function ai(i){return Z(i)?i:[]}function oi(i){return"function"==typeof i?i:fn}function st(i,r){return rD(i)?i:_i(i,r)?[i]:iQ(W(i))}function ut(i,r,l){var E=i.length;return l=l===c?E:l,!r&&l>=E?i:Cn(i,r,l)}var iU=tJ||function(i){return tV.clearTimeout(i)};function lu(i,r){if(r)return i.slice();var c=i.length,l=tR?tR(c):new i.constructor(c);return i.copy(l),l}function fi(i){var r=new i.constructor(i.byteLength);return new tC(r).set(new tC(i)),r}function pu(i,r){var c=r?fi(i.buffer):i.buffer;return new i.constructor(c,i.byteOffset,i.length)}function du(i,r){if(i!==r){var l=i!==c,E=null===i,S=i==i,P=pn(i),C=r!==c,A=null===r,q=r==r,T=pn(r);if(!A&&!T&&!P&&i>r||P&&C&&q&&!A&&!T||E&&C&&q||!l&&q||!S)return 1;if(!E&&!P&&!T&&i<r||T&&l&&S&&!E&&!P||A&&l&&S||!C&&S||!q)return -1}return 0}function gu(i,r,c,l){for(var E=-1,S=i.length,P=c.length,C=-1,A=r.length,q=il(S-P,0),T=e4(A+q),D=!l;++C<A;)T[C]=r[C];for(;++E<P;)(D||E<S)&&(T[c[E]]=i[E]);for(;q--;)T[C++]=i[E++];return T}function vu(i,r,c,l){for(var E=-1,S=i.length,P=-1,C=c.length,A=-1,q=r.length,T=il(S-C,0),D=e4(T+q),M=!l;++E<T;)D[E]=i[E];for(var U=E;++A<q;)D[U+A]=r[A];for(;++P<C;)(M||E<S)&&(D[U+c[P]]=i[E++]);return D}function un(i,r){var c=-1,l=i.length;for(r||(r=e4(l));++c<l;)r[c]=i[c];return r}function Un(i,r,l,E){var S=!l;l||(l={});for(var P=-1,C=r.length;++P<C;){var A=r[P],q=E?E(l[A],i[A],A,l,i):c;q===c&&(q=i[A]),S?zn(l,A,q):se(l,A,q)}return l}function Je(i,r){return function(c,l){var E=rD(c)?jo:_c,S=r?r():{};return E(c,i,x(l,2),S)}}function Ft(i){return L(function(r,l){var E=-1,S=l.length,P=S>1?l[S-1]:c,C=S>2?l[2]:c;for(P=i.length>3&&"function"==typeof P?(S--,P):c,C&&rn(l[0],l[1],C)&&(P=S<3?c:P,S=1),r=tn(r);++E<S;){var A=l[E];A&&i(r,A,E,P)}return r})}function _u(i,r){return function(c,l){if(null==c)return c;if(!an(c))return i(c,l);for(var E=c.length,S=r?E:-1,P=tn(c);(r?S--:++S<E)&&!1!==l(P[S],S,P););return c}}function mu(i){return function(r,c,l){for(var E=-1,S=tn(r),P=l(r),C=P.length;C--;){var A=P[i?C:++E];if(!1===c(S[A],A,S))break}return r}}function wu(i){return function(r){var l=Lt(r=W(r))?On(r):c,E=l?l[0]:r.charAt(0),S=l?ut(l,1).join(""):r.slice(1);return E[i]()+S}}function Mt(i){return function(r){return Nr(_a(va(r).replace(tO,"")),i,"")}}function ce(i){return function(){var r=arguments;switch(r.length){case 0:return new i;case 1:return new i(r[0]);case 2:return new i(r[0],r[1]);case 3:return new i(r[0],r[1],r[2]);case 4:return new i(r[0],r[1],r[2],r[3]);case 5:return new i(r[0],r[1],r[2],r[3],r[4]);case 6:return new i(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new i(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var c=ik(i.prototype),l=i.apply(c,r);return K(l)?l:c}}function Pu(i){return function(r,l,E){var S=tn(r);if(!an(r)){var P=x(l,3);r=V(r),l=function(i){return P(S[i],i,S)}}var C=i(r,l,E);return C>-1?S[P?r[C]:C]:c}}function Au(i){return Yn(function(r){var E=r.length,S=E,P=Pn.prototype.thru;for(i&&r.reverse();S--;){var C=r[S];if("function"!=typeof C)throw new th(l);if(P&&!A&&"wrapper"==je(C))var A=new Pn([],!0)}for(S=A?S:E;++S<E;){var q=je(C=r[S]),T="wrapper"==q?iV(C):c;A=T&&mi(T[0])&&424==T[1]&&!T[4].length&&1==T[9]?A[je(T[0])].apply(A,T[3]):1==C.length&&mi(C)?A[q]():A.thru(C)}return function(){var i=arguments,c=i[0];if(A&&1==i.length&&rD(c))return A.plant(c).value();for(var l=0,S=E?r[l].apply(this,i):c;++l<E;)S=r[l].call(this,S);return S}})}function Xe(i,r,l,E,S,P,C,A,q,T){var D=128&r,M=1&r,U=2&r,B=24&r,F=512&r,J=U?c:ce(i);return function y(){for(var X=arguments.length,ee=e4(X),et=X;et--;)ee[et]=arguments[et];if(B)var ea=qt(y),eo=function(i,r){for(var c=i.length,l=0;c--;)i[c]===r&&++l;return l}(ee,ea);if(E&&(ee=gu(ee,E,S,B)),P&&(ee=vu(ee,P,C,B)),X-=eo,B&&X<T){var ec=tt(ee,ea);return xu(i,r,Xe,y.placeholder,l,ee,ec,A,q,T-X)}var eh=M?l:this,el=U?eh[i]:i;return X=ee.length,A?ee=function(i,r){for(var l=i.length,E=ip(r.length,l),S=un(i);E--;){var P=r[E];i[E]=Zn(P,l)?S[P]:c}return i}(ee,A):F&&X>1&&ee.reverse(),D&&q<X&&(ee.length=q),this&&this!==tV&&this instanceof y&&(el=J||ce(el)),el.apply(eh,ee)}}function Cu(i,r){return function(c,l){var E,S;return E=r(l),S={},$n(c,function(r,c,l){i(S,E(r),c,l)}),S}}function Qe(i,r){return function(l,E){var S;if(l===c&&E===c)return r;if(l!==c&&(S=l),E!==c){if(S===c)return E;"string"==typeof l||"string"==typeof E?(l=ln(l),E=ln(E)):(l=au(l),E=au(E)),S=i(l,E)}return S}}function ci(i){return Yn(function(r){return r=G(r,hn(x())),L(function(c){var l=this;return i(r,function(i){return cn(i,l,c)})})})}function Ve(i,r){var l=(r=r===c?" ":ln(r)).length;if(l<2)return l?ri(r,i):r;var E=ri(r,t8(i/Dt(r)));return Lt(r)?ut(On(E),0,i).join(""):E.slice(0,i)}function Iu(i){return function(r,l,E){return E&&"number"!=typeof E&&rn(r,l,E)&&(l=E=c),r=Xn(r),l===c?(l=r,r=0):l=Xn(l),E=E===c?r<l?1:-1:Xn(E),function(i,r,c,l){for(var E=-1,S=il(t8((r-i)/(c||1)),0),P=e4(S);S--;)P[l?S:++E]=i,i+=c;return P}(r,l,E,i)}}function ke(i){return function(r,c){return"string"==typeof r&&"string"==typeof c||(r=xn(r),c=xn(c)),i(r,c)}}function xu(i,r,l,E,S,P,C,A,q,T){var D=8&r,M=D?C:c,U=D?c:C,B=D?P:c,F=D?c:P;r|=D?32:64,4&(r&=~(D?64:32))||(r&=-4);var J=[i,r,S,B,M,F,U,A,q,T],X=l.apply(c,J);return mi(i)&&iJ(X,J),X.placeholder=E,Uu(X,i,r)}function hi(i){var r=te[i];return function(i,c){if(i=xn(i),(c=null==c?0:ip(R(c),292))&&io(i)){var l=(W(i)+"e").split("e");return+((l=(W(r(l[0]+"e"+(+l[1]+c)))+"e").split("e"))[0]+"e"+(+l[1]-c))}return r(i)}}var iK=iI&&1/Se(new iI([,-0]))[1]==P?function(i){return new iI(i)}:Di;function Eu(i){return function(r){var c,l,E=iF(r);return E==J?qr(r):E==eo?(c=-1,l=Array(r.size),r.forEach(function(i){l[++c]=[i,i]}),l):G(i(r),function(i){return[i,r[i]]})}}function Kn(i,r,E,P,C,A,q,T){var D=2&r;if(!D&&"function"!=typeof i)throw new th(l);var M=P?P.length:0;if(M||(r&=-97,P=C=c),q=q===c?q:il(R(q),0),T=T===c?T:R(T),M-=C?C.length:0,64&r){var U=P,B=C;P=C=c}var F=D?c:iV(i),J=[i,r,E,P,C,U,B,A,q,T];if(F&&function(i,r){var c=i[1],l=r[1],E=c|l,P=E<131,C=128==l&&8==c||128==l&&256==c&&i[7].length<=r[8]||384==l&&r[7].length<=r[8]&&8==c;if(P||C){1&l&&(i[2]=r[2],E|=1&c?0:4);var A=r[3];if(A){var q=i[3];i[3]=q?gu(q,A,r[4]):A,i[4]=q?tt(i[3],S):r[4]}(A=r[5])&&(q=i[5],i[5]=q?vu(q,A,r[6]):A,i[6]=q?tt(i[5],S):r[6]),(A=r[7])&&(i[7]=A),128&l&&(i[8]=null==i[8]?r[8]:ip(i[8],r[8])),null==i[9]&&(i[9]=r[9]),i[0]=r[0],i[1]=E}}(J,F),i=J[0],r=J[1],E=J[2],P=J[3],C=J[4],(T=J[9]=J[9]===c?D?0:i.length:il(J[9]-M,0))||!(24&r)||(r&=-25),r&&1!=r)8==r||16==r?(X=i,ee=r,et=T,ea=ce(X),ew=function s(){for(var i=arguments.length,r=e4(i),l=i,E=qt(s);l--;)r[l]=arguments[l];var S=i<3&&r[0]!==E&&r[i-1]!==E?[]:tt(r,E);return(i-=S.length)<et?xu(X,ee,Xe,s.placeholder,c,r,S,c,c,et-i):cn(this&&this!==tV&&this instanceof s?ea:X,this,r)}):32!=r&&33!=r||C.length?ew=Xe.apply(c,J):(eo=i,ec=r,eh=E,el=P,ep=1&ec,ed=ce(eo),ew=function f(){for(var i=-1,r=arguments.length,c=-1,l=el.length,E=e4(l+r),S=this&&this!==tV&&this instanceof f?ed:eo;++c<l;)E[c]=el[c];for(;r--;)E[c++]=arguments[++i];return cn(S,ep?eh:this,E)});else var X,ee,et,ea,eo,ec,eh,el,ep,ed,ef,eg,ey,em,e_,ew=(ef=i,eg=r,ey=E,em=1&eg,e_=ce(ef),function o(){return(this&&this!==tV&&this instanceof o?e_:ef).apply(em?ey:this,arguments)});return Uu((F?i$:iJ)(ew,J),i,r)}function yu(i,r,l,E){return i===c||bn(i,td[l])&&!tm.call(E,l)?r:i}function Su(i,r,l,E,S,P){return K(i)&&K(r)&&(P.set(r,i),Ke(i,r,c,Su,P),P.delete(r)),i}function nh(i){return pe(i)?c:i}function Ou(i,r,l,E,S,P){var C=1&l,A=i.length,q=r.length;if(A!=q&&!(C&&q>A))return!1;var T=P.get(i),D=P.get(r);if(T&&D)return T==r&&D==i;var M=-1,U=!0,B=2&l?new gt:c;for(P.set(i,r),P.set(r,i);++M<A;){var F=i[M],J=r[M];if(E)var X=C?E(J,F,M,r,i,P):E(F,J,M,i,r,P);if(X!==c){if(X)continue;U=!1;break}if(B){if(!Hr(r,function(i,r){if(!jt(B,r)&&(F===i||S(F,i,l,E,P)))return B.push(r)})){U=!1;break}}else if(!(F===J||S(F,J,l,E,P))){U=!1;break}}return P.delete(i),P.delete(r),U}function Yn(i){return iZ(Nu(i,c,Gu),i+"")}function li(i){return Js(i,V,iB)}function pi(i){return Js(i,on,iW)}var iV=iS?function(i){return iS.get(i)}:Di;function je(i){for(var r=i.name+"",c=iP[r],l=tm.call(iP,r)?c.length:0;l--;){var E=c[l],S=E.func;if(null==S||S==i)return E.name}return r}function qt(i){return(tm.call(a,"placeholder")?a:i).placeholder}function x(){var i=a.iteratee||Ti;return i=i===Ti?Vs:i,arguments.length?i(arguments[0],arguments[1]):i}function nr(i,r){var c,l=i.__data__;return("string"==(c=typeof r)||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==r:null===r)?l["string"==typeof r?"string":"hash"]:l.map}function gi(i){for(var r=V(i),c=r.length;c--;){var l=r[c],E=i[l];r[c]=[l,E,E==E&&!K(E)]}return r}function mt(i,r){var l=null==i?c:i[r];return Qs(l)?l:c}var iB=ir?function(i){return null==i?[]:jn(ir(i=tn(i)),function(r){return tL.call(i,r)})}:Ni,iW=ir?function(i){for(var r=[];i;)nt(r,iB(i)),i=tq(i);return r}:Ni,iF=en;function bu(i,r,c){r=st(r,i);for(var l=-1,E=r.length,S=!1;++l<E;){var P=Wn(r[l]);if(!(S=null!=i&&c(i,P)))break;i=i[P]}return S||++l!=E?S:!!(E=null==i?0:i.length)&&ar(E)&&Zn(P,E)&&(rD(i)||rT(i))}function Tu(i){return"function"!=typeof i.constructor||he(i)?{}:ik(tq(i))}function fh(i){return rD(i)||rT(i)||!!(tK&&i&&i[tK])}function Zn(i,r){var c=typeof i;return!!(r=r??9007199254740991)&&("number"==c||"symbol"!=c&&e0.test(i))&&i>-1&&i%1==0&&i<r}function rn(i,r,c){if(!K(c))return!1;var l=typeof r;return("number"==l?!!(an(c)&&Zn(r,c.length)):"string"==l&&r in c)&&bn(c[r],i)}function _i(i,r){if(rD(i))return!1;var c=typeof i;return!!("number"==c||"symbol"==c||"boolean"==c||null==i||pn(i))||ej.test(i)||!ek.test(i)||null!=r&&i in tn(r)}function mi(i){var r=je(i),c=a[r];if("function"!=typeof c||!(r in H.prototype))return!1;if(i===c)return!0;var l=iV(c);return!!l&&i===l[0]}(i_&&iF(new i_(new ArrayBuffer(1)))!=ed||iw&&iF(new iw)!=J||ib&&iF(ib.resolve())!=et||iI&&iF(new iI)!=eo||iE&&iF(new iE)!=el)&&(iF=function(i){var r=en(i),l=r==ee?i.constructor:c,E=l?wt(l):"";if(E)switch(E){case iC:return ed;case iR:return J;case iO:return et;case iA:return eo;case iq:return el}return r});var iG=tg?Jn:Hi;function he(i){var r=i&&i.constructor;return i===("function"==typeof r&&r.prototype||td)}function Du(i,r){return function(l){return null!=l&&l[i]===r&&(r!==c||i in tn(l))}}function Nu(i,r,l){return r=il(r===c?i.length-1:r,0),function(){for(var c=arguments,E=-1,S=il(c.length-r,0),P=e4(S);++E<S;)P[E]=c[r+E];E=-1;for(var C=e4(r+1);++E<r;)C[E]=c[E];return C[r]=l(P),cn(i,this,C)}}function Hu(i,r){return r.length<2?i:_t(i,Cn(r,0,-1))}function wi(i,r){if(!("constructor"===r&&"function"==typeof i[r])&&"__proto__"!=r)return i[r]}var iJ=Wu(i$),iY=t9||function(i,r){return tV.setTimeout(i,r)},iZ=Wu(iH);function Uu(i,r,c){var l,E,S=r+"";return iZ(i,function(i,r){var c=r.length;if(!c)return i;var l=c-1;return r[l]=(c>1?"& ":"")+r[l],r=r.join(c>2?", ":" "),i.replace(eU,`{
/* [wrapped with `+r+`] */
`)}(S,(l=(E=S.match(eK))?E[1].split(eV):[],mn(A,function(i){var r="_."+i[0];c&i[1]&&!Ee(l,r)&&l.push(r)}),l.sort())))}function Wu(i){var r=0,l=0;return function(){var E=id(),S=16-(E-l);if(l=E,S>0){if(++r>=800)return arguments[0]}else r=0;return i.apply(c,arguments)}}function tr(i,r){var l=-1,E=i.length,S=E-1;for(r=r===c?E:r;++l<r;){var P=ei(l,S),C=i[P];i[P]=i[l],i[l]=C}return i.length=r,i}var iQ=(e2=(eH=sr(function(i){var r=[];return 46===i.charCodeAt(0)&&r.push(""),i.replace(eM,function(i,c,l,E){r.push(l?E.replace(eF,"$1"):c||i)}),r},function(i){return 500===e2.size&&e2.clear(),i})).cache,eH);function Wn(i){if("string"==typeof i||pn(i))return i;var r=i+"";return"0"==r&&1/i==-P?"-0":r}function wt(i){if(null!=i){try{return ty.call(i)}catch{}try{return i+""}catch{}}return""}function Mu(i){if(i instanceof H)return i.clone();var r=new Pn(i.__wrapped__,i.__chain__);return r.__actions__=un(i.__actions__),r.__index__=i.__index__,r.__values__=i.__values__,r}var iX=L(function(i,r){return Z(i)?ue(i,j(r,1,Z,!0)):[]}),i0=L(function(i,r){var l=In(r);return Z(l)&&(l=c),Z(i)?ue(i,j(r,1,Z,!0),x(l,2)):[]}),i1=L(function(i,r){var l=In(r);return Z(l)&&(l=c),Z(i)?ue(i,j(r,1,Z,!0),c,l):[]});function qu(i,r,c){var l=null==i?0:i.length;if(!l)return -1;var E=null==c?0:R(c);return E<0&&(E=il(l+E,0)),ye(i,x(r,3),E)}function Bu(i,r,l){var E=null==i?0:i.length;if(!E)return -1;var S=E-1;return l!==c&&(S=R(l),S=l<0?il(E+S,0):ip(S,E-1)),ye(i,x(r,3),S,!0)}function Gu(i){return(null==i?0:i.length)?j(i,1):[]}function zu(i){return i&&i.length?i[0]:c}var i5=L(function(i){var r=G(i,ai);return r.length&&r[0]===i[0]?Vr(r):[]}),i6=L(function(i){var r=In(i),l=G(i,ai);return r===In(l)?r=c:l.pop(),l.length&&l[0]===i[0]?Vr(l,x(r,2)):[]}),i2=L(function(i){var r=In(i),l=G(i,ai);return(r="function"==typeof r?r:c)&&l.pop(),l.length&&l[0]===i[0]?Vr(l,c,r):[]});function In(i){var r=null==i?0:i.length;return r?i[r-1]:c}var i3=L(Ku);function Ku(i,r){return i&&i.length&&r&&r.length?ti(i,r):i}var i4=Yn(function(i,r){var c=null==i?0:i.length,l=Zr(i,r);return iu(i,G(r,function(i){return Zn(i,c)?+i:i}).sort(du)),l});function Ai(i){return null==i?i:im.call(i)}var i9=L(function(i){return it(j(i,1,Z,!0))}),i8=L(function(i){var r=In(i);return Z(r)&&(r=c),it(j(i,1,Z,!0),x(r,2))}),i7=L(function(i){var r=In(i);return r="function"==typeof r?r:c,it(j(i,1,Z,!0),c,r)});function Ci(i){if(!(i&&i.length))return[];var r=0;return i=jn(i,function(i){if(Z(i))return r=il(i.length,r),!0}),Fr(r,function(r){return G(i,$r(r))})}function Yu(i,r){if(!(i&&i.length))return[];var l=Ci(i);return null==r?l:G(l,function(i){return cn(r,c,i)})}var re=L(function(i,r){return Z(i)?ue(i,r):[]}),rt=L(function(i){return ui(jn(i,Z))}),ro=L(function(i){var r=In(i);return Z(r)&&(r=c),ui(jn(i,Z),x(r,2))}),rc=L(function(i){var r=In(i);return r="function"==typeof r?r:c,ui(jn(i,Z),c,r)}),rh=L(Ci),rl=L(function(i){var r=i.length,l=r>1?i[r-1]:c;return l="function"==typeof l?(i.pop(),l):c,Yu(i,l)});function Zu(i){var r=a(i);return r.__chain__=!0,r}function er(i,r){return r(i)}var rp=Yn(function(i){var r=i.length,l=r?i[0]:0,E=this.__wrapped__,s=function(r){return Zr(r,i)};return!(r>1)&&!this.__actions__.length&&E instanceof H&&Zn(l)?((E=E.slice(l,+l+(r?1:0))).__actions__.push({func:er,args:[s],thisArg:c}),new Pn(E,this.__chain__).thru(function(i){return r&&!i.length&&i.push(c),i})):this.thru(s)}),rd=Je(function(i,r,c){tm.call(i,c)?++i[c]:zn(i,c,1)}),rf=Pu(qu),rg=Pu(Bu);function Ju(i,r){return(rD(i)?mn:ij)(i,x(r,3))}function Xu(i,r){return(rD(i)?function(i,r){for(var c=null==i?0:i.length;c--&&!1!==r(i[c],c,i););return i}:iM)(i,x(r,3))}var ry=Je(function(i,r,c){tm.call(i,c)?i[c].push(r):zn(i,c,[r])}),rm=L(function(i,r,c){var l=-1,E="function"==typeof r,S=an(i)?e4(i.length):[];return ij(i,function(i){S[++l]=E?cn(r,i,c):ae(i,r,c)}),S}),r_=Je(function(i,r,c){zn(i,c,r)});function rr(i,r){return(rD(i)?G:ks)(i,x(r,3))}var rw=Je(function(i,r,c){i[c?0:1].push(r)},function(){return[[],[]]}),rb=L(function(i,r){if(null==i)return[];var c=r.length;return c>1&&rn(i,r[0],r[1])?r=[]:c>2&&rn(r[0],r[1],r[2])&&(r=[r[0]]),eu(i,j(r,1),[])}),rI=t5||function(){return tV.Date.now()};function Qu(i,r,l){return r=l?c:r,r=i&&null==r?i.length:r,Kn(i,128,c,c,c,c,r)}function Vu(i,r){var E;if("function"!=typeof r)throw new th(l);return i=R(i),function(){return--i>0&&(E=r.apply(this,arguments)),i<=1&&(r=c),E}}var rE=L(function(i,r,c){var l=1;if(c.length){var E=tt(c,qt(rE));l|=32}return Kn(i,l,r,c,E)}),rx=L(function(i,r,c){var l=3;if(c.length){var E=tt(c,qt(rx));l|=32}return Kn(r,l,i,c,E)});function ta(i,r,E){var S,P,C,A,q,T,D=0,M=!1,U=!1,B=!0;if("function"!=typeof i)throw new th(l);function I(r){var l=S,E=P;return S=P=c,D=r,A=i.apply(E,l)}function y(i){var l=i-T,E=i-D;return T===c||l>=r||l<0||U&&E>=C}function N(){var i,c,l,E=rI();if(y(E))return $(E);q=iY(N,(i=E-T,c=E-D,l=r-i,U?ip(l,C-c):l))}function $(i){return q=c,B&&S?I(i):(S=P=c,A)}function gn(){var i,l=rI(),E=y(l);if(S=arguments,P=this,T=l,E){if(q===c)return D=i=T,q=iY(N,r),M?I(i):A;if(U)return iU(q),q=iY(N,r),I(T)}return q===c&&(q=iY(N,r)),A}return r=xn(r)||0,K(E)&&(M=!!E.leading,C=(U="maxWait"in E)?il(xn(E.maxWait)||0,r):C,B="trailing"in E?!!E.trailing:B),gn.cancel=function(){q!==c&&iU(q),D=0,S=T=P=q=c},gn.flush=function(){return q===c?A:$(rI())},gn}var rS=L(function(i,r){return zs(i,1,r)}),rP=L(function(i,r,c){return zs(i,xn(r)||0,c)});function sr(i,r){if("function"!=typeof i||null!=r&&"function"!=typeof r)throw new th(l);var e=function(){var c=arguments,l=r?r.apply(this,c):c[0],E=e.cache;if(E.has(l))return E.get(l);var S=i.apply(this,c);return e.cache=E.set(l,S)||E,S};return e.cache=new(sr.Cache||Gn),e}function ur(i){if("function"!=typeof i)throw new th(l);return function(){var r=arguments;switch(r.length){case 0:return!i.call(this);case 1:return!i.call(this,r[0]);case 2:return!i.call(this,r[0],r[1]);case 3:return!i.call(this,r[0],r[1],r[2])}return!i.apply(this,r)}}sr.Cache=Gn;var rC=L(function(i,r){var c=(r=1==r.length&&rD(r[0])?G(r[0],hn(x())):G(j(r,1),hn(x()))).length;return L(function(l){for(var E=-1,S=ip(l.length,c);++E<S;)l[E]=r[E].call(this,l[E]);return cn(i,this,l)})}),rR=L(function(i,r){var l=tt(r,qt(rR));return Kn(i,32,c,r,l)}),rO=L(function(i,r){var l=tt(r,qt(rO));return Kn(i,64,c,r,l)}),rA=Yn(function(i,r){return Kn(i,256,c,c,c,r)});function bn(i,r){return i===r||i!=i&&r!=r}var rq=ke(Qr),rN=ke(function(i,r){return i>=r}),rT=Xs(function(){return arguments}())?Xs:function(i){return Y(i)&&tm.call(i,"callee")&&!tL.call(i,"callee")},rD=e4.isArray,rk=tY?hn(tY):function(i){return Y(i)&&en(i)==ep};function an(i){return null!=i&&ar(i.length)&&!Jn(i)}function Z(i){return Y(i)&&an(i)}var rj=ia||Hi,rM=tZ?hn(tZ):function(i){return Y(i)&&en(i)==M};function Ei(i){if(!Y(i))return!1;var r=en(i);return r==U||"[object DOMException]"==r||"string"==typeof i.message&&"string"==typeof i.name&&!pe(i)}function Jn(i){if(!K(i))return!1;var r=en(i);return r==B||r==F||"[object AsyncFunction]"==r||"[object Proxy]"==r}function ra(i){return"number"==typeof i&&i==R(i)}function ar(i){return"number"==typeof i&&i>-1&&i%1==0&&i<=9007199254740991}function K(i){var r=typeof i;return null!=i&&("object"==r||"function"==r)}function Y(i){return null!=i&&"object"==typeof i}var rz=tQ?hn(tQ):function(i){return Y(i)&&iF(i)==J};function sa(i){return"number"==typeof i||Y(i)&&en(i)==X}function pe(i){if(!Y(i)||en(i)!=ee)return!1;var r=tq(i);if(null===r)return!0;var c=tm.call(r,"constructor")&&r.constructor;return"function"==typeof c&&c instanceof c&&ty.call(c)==tI}var rL=tX?hn(tX):function(i){return Y(i)&&en(i)==ea},r$=t0?hn(t0):function(i){return Y(i)&&iF(i)==eo};function or(i){return"string"==typeof i||!rD(i)&&Y(i)&&en(i)==ec}function pn(i){return"symbol"==typeof i||Y(i)&&en(i)==eh}var rH=t1?hn(t1):function(i){return Y(i)&&ar(i.length)&&!!tM[en(i)]},rU=ke(ni),rK=ke(function(i,r){return i<=r});function aa(i){if(!i)return[];if(an(i))return or(i)?On(i):un(i);if(tB&&i[tB])return function(i){for(var r,c=[];!(r=i.next()).done;)c.push(r.value);return c}(i[tB]());var r=iF(i);return(r==J?qr:r==eo?Se:Gt)(i)}function Xn(i){return i?(i=xn(i))===P||i===-P?(i<0?-1:1)*17976931348623157e292:i==i?i:0:0===i?i:0}function R(i){var r=Xn(i),c=r%1;return r==r?c?r-c:r:0}function oa(i){return i?vt(R(i),0,4294967295):0}function xn(i){if("number"==typeof i)return i;if(pn(i))return C;if(K(i)){var r="function"==typeof i.valueOf?i.valueOf():i;i=K(r)?r+"":r}if("string"!=typeof i)return 0===i?i:+i;i=Ss(i);var c=eZ.test(i);return c||eX.test(i)?tH(i.slice(2),c?2:8):eY.test(i)?C:+i}function fa(i){return Un(i,on(i))}function W(i){return null==i?"":ln(i)}var rV=Ft(function(i,r){if(he(r)||an(r)){Un(r,V(r),i);return}for(var c in r)tm.call(r,c)&&se(i,c,r[c])}),rB=Ft(function(i,r){Un(r,on(r),i)}),rW=Ft(function(i,r,c,l){Un(r,on(r),i,l)}),rF=Ft(function(i,r,c,l){Un(r,V(r),i,l)}),rG=Yn(Zr),rJ=L(function(i,r){i=tn(i);var l=-1,E=r.length,S=E>2?r[2]:c;for(S&&rn(r[0],r[1],S)&&(E=1);++l<E;)for(var P=r[l],C=on(P),A=-1,q=C.length;++A<q;){var T=C[A],D=i[T];(D===c||bn(D,td[T])&&!tm.call(i,T))&&(i[T]=P[T])}return i}),rY=L(function(i){return i.push(c,Su),cn(r1,c,i)});function Si(i,r,l){var E=null==i?c:_t(i,r);return E===c?l:E}function Oi(i,r){return null!=i&&bu(i,r,Ic)}var rZ=Cu(function(i,r,c){null!=r&&"function"!=typeof r.toString&&(r=tb.call(r)),i[r]=c},bi(fn)),rQ=Cu(function(i,r,c){null!=r&&"function"!=typeof r.toString&&(r=tb.call(r)),tm.call(i,r)?i[r].push(c):i[r]=[c]},x),rX=L(ae);function V(i){return an(i)?Ms(i):jr(i)}function on(i){return an(i)?Ms(i,!0):function(i){if(!K(i))return function(i){var r=[];if(null!=i)for(var c in tn(i))r.push(c);return r}(i);var r=he(i),c=[];for(var l in i)"constructor"==l&&(r||!tm.call(i,l))||c.push(l);return c}(i)}var r0=Ft(function(i,r,c){Ke(i,r,c)}),r1=Ft(function(i,r,c,l){Ke(i,r,c,l)}),r5=Yn(function(i,r){var c={};if(null==i)return c;var l=!1;r=G(r,function(r){return r=st(r,i),l||(l=r.length>1),r}),Un(i,pi(i),c),l&&(c=An(c,7,nh));for(var E=r.length;E--;)si(c,r[E]);return c}),r6=Yn(function(i,r){return null==i?{}:ru(i,r,function(r,c){return Oi(i,c)})});function la(i,r){if(null==i)return{};var c=G(pi(i),function(i){return[i]});return r=x(r),ru(i,c,function(i,c){return r(i,c[0])})}var r2=Eu(V),r3=Eu(on);function Gt(i){return null==i?[]:Mr(i,V(i))}var r4=Mt(function(i,r,c){return r=r.toLowerCase(),i+(c?ga(r):r)});function ga(i){return sh(W(i).toLowerCase())}function va(i){return(i=W(i))&&i.replace(e1,t6).replace(tA,"")}var r9=Mt(function(i,r,c){return i+(c?"-":"")+r.toLowerCase()}),r8=Mt(function(i,r,c){return i+(c?" ":"")+r.toLowerCase()}),r7=wu("toLowerCase"),sn=Mt(function(i,r,c){return i+(c?"_":"")+r.toLowerCase()}),so=Mt(function(i,r,c){return i+(c?" ":"")+sh(r)}),sc=Mt(function(i,r,c){return i+(c?" ":"")+r.toUpperCase()}),sh=wu("toUpperCase");function _a(i,r,l){var E;return i=W(i),(r=l?c:r)===c?(E=i,tD.test(E))?i.match(tN)||[]:i.match(eB)||[]:i.match(r)||[]}var sl=L(function(i,r){try{return cn(i,c,r)}catch(i){return Ei(i)?i:new e8(i)}}),su=Yn(function(i,r){return mn(r,function(r){zn(i,r=Wn(r),rE(i[r],i))}),i});function bi(i){return function(){return i}}var sp=Au(),sd=Au(!0);function fn(i){return i}function Ti(i){return Vs("function"==typeof i?i:An(i,1))}var sf=L(function(i,r){return function(c){return ae(c,i,r)}}),sg=L(function(i,r){return function(c){return ae(i,c,r)}});function Li(i,r,c){var l=V(r),E=ze(r,l);null!=c||K(r)&&(E.length||!l.length)||(c=r,r=i,i=this,E=ze(r,V(r)));var S=!(K(c)&&"chain"in c)||!!c.chain,P=Jn(i);return mn(E,function(c){var l=r[c];i[c]=l,P&&(i.prototype[c]=function(){var r=this.__chain__;if(S||r){var c=i(this.__wrapped__);return(c.__actions__=un(this.__actions__)).push({func:l,args:arguments,thisArg:i}),c.__chain__=r,c}return l.apply(i,nt([this.value()],arguments))})}),i}function Di(){}var sy=ci(G),sm=ci(Cs),s_=ci(Hr);function wa(i){return _i(i)?$r(Wn(i)):function(r){return _t(r,i)}}var sw=Iu(),sb=Iu(!0);function Ni(){return[]}function Hi(){return!1}var sI=Qe(function(i,r){return i+r},0),sE=hi("ceil"),sx=Qe(function(i,r){return i/r},1),sS=hi("floor"),sP=Qe(function(i,r){return i*r},1),sC=hi("round"),sR=Qe(function(i,r){return i-r},0);return a.after=function(i,r){if("function"!=typeof r)throw new th(l);return i=R(i),function(){if(--i<1)return r.apply(this,arguments)}},a.ary=Qu,a.assign=rV,a.assignIn=rB,a.assignInWith=rW,a.assignWith=rF,a.at=rG,a.before=Vu,a.bind=rE,a.bindAll=su,a.bindKey=rx,a.castArray=function(){if(!arguments.length)return[];var i=arguments[0];return rD(i)?i:[i]},a.chain=Zu,a.chunk=function(i,r,l){r=(l?rn(i,r,l):r===c)?1:il(R(r),0);var E=null==i?0:i.length;if(!E||r<1)return[];for(var S=0,P=0,C=e4(t8(E/r));S<E;)C[P++]=Cn(i,S,S+=r);return C},a.compact=function(i){for(var r=-1,c=null==i?0:i.length,l=0,E=[];++r<c;){var S=i[r];S&&(E[l++]=S)}return E},a.concat=function(){var i=arguments.length;if(!i)return[];for(var r=e4(i-1),c=arguments[0],l=i;l--;)r[l-1]=arguments[l];return nt(rD(c)?un(c):[c],j(r,1))},a.cond=function(i){var r=null==i?0:i.length,c=x();return i=r?G(i,function(i){if("function"!=typeof i[1])throw new th(l);return[c(i[0]),i[1]]}):[],L(function(c){for(var l=-1;++l<r;){var E=i[l];if(cn(E[0],this,c))return cn(E[1],this,c)}})},a.conforms=function(i){var r,c;return c=V(r=An(i,1)),function(i){return Gs(i,r,c)}},a.constant=bi,a.countBy=rd,a.create=function(i,r){var c=ik(i);return null==r?c:Bs(c,r)},a.curry=function ju(i,r,l){r=l?c:r;var E=Kn(i,8,c,c,c,c,c,r);return E.placeholder=ju.placeholder,E},a.curryRight=function na(i,r,l){r=l?c:r;var E=Kn(i,16,c,c,c,c,c,r);return E.placeholder=na.placeholder,E},a.debounce=ta,a.defaults=rJ,a.defaultsDeep=rY,a.defer=rS,a.delay=rP,a.difference=iX,a.differenceBy=i0,a.differenceWith=i1,a.drop=function(i,r,l){var E=null==i?0:i.length;return E?Cn(i,(r=l||r===c?1:R(r))<0?0:r,E):[]},a.dropRight=function(i,r,l){var E=null==i?0:i.length;return E?Cn(i,0,(r=E-(r=l||r===c?1:R(r)))<0?0:r):[]},a.dropRightWhile=function(i,r){return i&&i.length?Ze(i,x(r,3),!0,!0):[]},a.dropWhile=function(i,r){return i&&i.length?Ze(i,x(r,3),!0):[]},a.fill=function(i,r,l,E){var S=null==i?0:i.length;return S?(l&&"number"!=typeof l&&rn(i,r,l)&&(l=0,E=S),function(i,r,l,E){var S=i.length;for((l=R(l))<0&&(l=-l>S?0:S+l),(E=E===c||E>S?S:R(E))<0&&(E+=S),E=l>E?0:oa(E);l<E;)i[l++]=r;return i}(i,r,l,E)):[]},a.filter=function(i,r){return(rD(i)?jn:Ys)(i,x(r,3))},a.flatMap=function(i,r){return j(rr(i,r),1)},a.flatMapDeep=function(i,r){return j(rr(i,r),P)},a.flatMapDepth=function(i,r,l){return l=l===c?1:R(l),j(rr(i,r),l)},a.flatten=Gu,a.flattenDeep=function(i){return(null==i?0:i.length)?j(i,P):[]},a.flattenDepth=function(i,r){return(null==i?0:i.length)?j(i,r=r===c?1:R(r)):[]},a.flip=function(i){return Kn(i,512)},a.flow=sp,a.flowRight=sd,a.fromPairs=function(i){for(var r=-1,c=null==i?0:i.length,l={};++r<c;){var E=i[r];l[E[0]]=E[1]}return l},a.functions=function(i){return null==i?[]:ze(i,V(i))},a.functionsIn=function(i){return null==i?[]:ze(i,on(i))},a.groupBy=ry,a.initial=function(i){return(null==i?0:i.length)?Cn(i,0,-1):[]},a.intersection=i5,a.intersectionBy=i6,a.intersectionWith=i2,a.invert=rZ,a.invertBy=rQ,a.invokeMap=rm,a.iteratee=Ti,a.keyBy=r_,a.keys=V,a.keysIn=on,a.map=rr,a.mapKeys=function(i,r){var c={};return r=x(r,3),$n(i,function(i,l,E){zn(c,r(i,l,E),i)}),c},a.mapValues=function(i,r){var c={};return r=x(r,3),$n(i,function(i,l,E){zn(c,l,r(i,l,E))}),c},a.matches=function(i){return js(An(i,1))},a.matchesProperty=function(i,r){return nu(i,An(r,1))},a.memoize=sr,a.merge=r0,a.mergeWith=r1,a.method=sf,a.methodOf=sg,a.mixin=Li,a.negate=ur,a.nthArg=function(i){return i=R(i),L(function(r){return tu(r,i)})},a.omit=r5,a.omitBy=function(i,r){return la(i,ur(x(r)))},a.once=function(i){return Vu(2,i)},a.orderBy=function(i,r,l,E){return null==i?[]:(rD(r)||(r=null==r?[]:[r]),rD(l=E?c:l)||(l=null==l?[]:[l]),eu(i,r,l))},a.over=sy,a.overArgs=rC,a.overEvery=sm,a.overSome=s_,a.partial=rR,a.partialRight=rO,a.partition=rw,a.pick=r6,a.pickBy=la,a.property=wa,a.propertyOf=function(i){return function(r){return null==i?c:_t(i,r)}},a.pull=i3,a.pullAll=Ku,a.pullAllBy=function(i,r,c){return i&&i.length&&r&&r.length?ti(i,r,x(c,2)):i},a.pullAllWith=function(i,r,l){return i&&i.length&&r&&r.length?ti(i,r,c,l):i},a.pullAt=i4,a.range=sw,a.rangeRight=sb,a.rearg=rA,a.reject=function(i,r){return(rD(i)?jn:Ys)(i,ur(x(r,3)))},a.remove=function(i,r){var c=[];if(!(i&&i.length))return c;var l=-1,E=[],S=i.length;for(r=x(r,3);++l<S;){var P=i[l];r(P,l,i)&&(c.push(P),E.push(l))}return iu(i,E),c},a.rest=function(i,r){if("function"!=typeof i)throw new th(l);return L(i,r=r===c?r:R(r))},a.reverse=Ai,a.sampleSize=function(i,r,l){return r=(l?rn(i,r,l):r===c)?1:R(r),(rD(i)?function(i,r){return tr(un(i),vt(r,0,i.length))}:function(i,r){var c=Gt(i);return tr(c,vt(r,0,c.length))})(i,r)},a.set=function(i,r,c){return null==i?i:fe(i,r,c)},a.setWith=function(i,r,l,E){return E="function"==typeof E?E:c,null==i?i:fe(i,r,l,E)},a.shuffle=function(i){return(rD(i)?function(i){return tr(un(i))}:function(i){return tr(Gt(i))})(i)},a.slice=function(i,r,l){var E=null==i?0:i.length;return E?(l&&"number"!=typeof l&&rn(i,r,l)?(r=0,l=E):(r=null==r?0:R(r),l=l===c?E:R(l)),Cn(i,r,l)):[]},a.sortBy=rb,a.sortedUniq=function(i){return i&&i.length?uu(i):[]},a.sortedUniqBy=function(i,r){return i&&i.length?uu(i,x(r,2)):[]},a.split=function(i,r,l){return l&&"number"!=typeof l&&rn(i,r,l)&&(r=l=c),(l=l===c?4294967295:l>>>0)?(i=W(i))&&("string"==typeof r||null!=r&&!rL(r))&&!(r=ln(r))&&Lt(i)?ut(On(i),0,l):i.split(r,l):[]},a.spread=function(i,r){if("function"!=typeof i)throw new th(l);return r=null==r?0:il(R(r),0),L(function(c){var l=c[r],E=ut(c,0,r);return l&&nt(E,l),cn(i,this,E)})},a.tail=function(i){var r=null==i?0:i.length;return r?Cn(i,1,r):[]},a.take=function(i,r,l){return i&&i.length?Cn(i,0,(r=l||r===c?1:R(r))<0?0:r):[]},a.takeRight=function(i,r,l){var E=null==i?0:i.length;return E?Cn(i,(r=E-(r=l||r===c?1:R(r)))<0?0:r,E):[]},a.takeRightWhile=function(i,r){return i&&i.length?Ze(i,x(r,3),!1,!0):[]},a.takeWhile=function(i,r){return i&&i.length?Ze(i,x(r,3)):[]},a.tap=function(i,r){return r(i),i},a.throttle=function(i,r,c){var E=!0,S=!0;if("function"!=typeof i)throw new th(l);return K(c)&&(E="leading"in c?!!c.leading:E,S="trailing"in c?!!c.trailing:S),ta(i,r,{leading:E,maxWait:r,trailing:S})},a.thru=er,a.toArray=aa,a.toPairs=r2,a.toPairsIn=r3,a.toPath=function(i){return rD(i)?G(i,Wn):pn(i)?[i]:un(iQ(W(i)))},a.toPlainObject=fa,a.transform=function(i,r,c){var l=rD(i),E=l||rj(i)||rH(i);if(r=x(r,4),null==c){var S=i&&i.constructor;c=E?l?new S:[]:K(i)&&Jn(S)?ik(tq(i)):{}}return(E?mn:$n)(i,function(i,l,E){return r(c,i,l,E)}),c},a.unary=function(i){return Qu(i,1)},a.union=i9,a.unionBy=i8,a.unionWith=i7,a.uniq=function(i){return i&&i.length?it(i):[]},a.uniqBy=function(i,r){return i&&i.length?it(i,x(r,2)):[]},a.uniqWith=function(i,r){return r="function"==typeof r?r:c,i&&i.length?it(i,c,r):[]},a.unset=function(i,r){return null==i||si(i,r)},a.unzip=Ci,a.unzipWith=Yu,a.update=function(i,r,c){return null==i?i:ou(i,r,oi(c))},a.updateWith=function(i,r,l,E){return E="function"==typeof E?E:c,null==i?i:ou(i,r,oi(l),E)},a.values=Gt,a.valuesIn=function(i){return null==i?[]:Mr(i,on(i))},a.without=re,a.words=_a,a.wrap=function(i,r){return rR(oi(r),i)},a.xor=rt,a.xorBy=ro,a.xorWith=rc,a.zip=rh,a.zipObject=function(i,r){return cu(i||[],r||[],se)},a.zipObjectDeep=function(i,r){return cu(i||[],r||[],fe)},a.zipWith=rl,a.entries=r2,a.entriesIn=r3,a.extend=rB,a.extendWith=rW,Li(a,a),a.add=sI,a.attempt=sl,a.camelCase=r4,a.capitalize=ga,a.ceil=sE,a.clamp=function(i,r,l){return l===c&&(l=r,r=c),l!==c&&(l=(l=xn(l))==l?l:0),r!==c&&(r=(r=xn(r))==r?r:0),vt(xn(i),r,l)},a.clone=function(i){return An(i,4)},a.cloneDeep=function(i){return An(i,5)},a.cloneDeepWith=function(i,r){return An(i,5,r="function"==typeof r?r:c)},a.cloneWith=function(i,r){return An(i,4,r="function"==typeof r?r:c)},a.conformsTo=function(i,r){return null==r||Gs(i,r,V(r))},a.deburr=va,a.defaultTo=function(i,r){return null==i||i!=i?r:i},a.divide=sx,a.endsWith=function(i,r,l){i=W(i),r=ln(r);var E=i.length,S=l=l===c?E:vt(R(l),0,E);return(l-=r.length)>=0&&i.slice(l,S)==r},a.eq=bn,a.escape=function(i){return(i=W(i))&&eA.test(i)?i.replace(eR,t2):i},a.escapeRegExp=function(i){return(i=W(i))&&eL.test(i)?i.replace(ez,"\\$&"):i},a.every=function(i,r,l){var E=rD(i)?Cs:Pc;return l&&rn(i,r,l)&&(r=c),E(i,x(r,3))},a.find=rf,a.findIndex=qu,a.findKey=function(i,r){return Is(i,x(r,3),$n)},a.findLast=rg,a.findLastIndex=Bu,a.findLastKey=function(i,r){return Is(i,x(r,3),Xr)},a.floor=sS,a.forEach=Ju,a.forEachRight=Xu,a.forIn=function(i,r){return null==i?i:iz(i,x(r,3),on)},a.forInRight=function(i,r){return null==i?i:iL(i,x(r,3),on)},a.forOwn=function(i,r){return i&&$n(i,x(r,3))},a.forOwnRight=function(i,r){return i&&Xr(i,x(r,3))},a.get=Si,a.gt=rq,a.gte=rN,a.has=function(i,r){return null!=i&&bu(i,r,Cc)},a.hasIn=Oi,a.head=zu,a.identity=fn,a.includes=function(i,r,c,l){i=an(i)?i:Gt(i),c=c&&!l?R(c):0;var E=i.length;return c<0&&(c=il(E+c,0)),or(i)?c<=E&&i.indexOf(r,c)>-1:!!E&&Tt(i,r,c)>-1},a.indexOf=function(i,r,c){var l=null==i?0:i.length;if(!l)return -1;var E=null==c?0:R(c);return E<0&&(E=il(l+E,0)),Tt(i,r,E)},a.inRange=function(i,r,l){var E,S,P;return r=Xn(r),l===c?(l=r,r=0):l=Xn(l),(E=i=xn(i))>=ip(S=r,P=l)&&E<il(S,P)},a.invoke=rX,a.isArguments=rT,a.isArray=rD,a.isArrayBuffer=rk,a.isArrayLike=an,a.isArrayLikeObject=Z,a.isBoolean=function(i){return!0===i||!1===i||Y(i)&&en(i)==D},a.isBuffer=rj,a.isDate=rM,a.isElement=function(i){return Y(i)&&1===i.nodeType&&!pe(i)},a.isEmpty=function(i){if(null==i)return!0;if(an(i)&&(rD(i)||"string"==typeof i||"function"==typeof i.splice||rj(i)||rH(i)||rT(i)))return!i.length;var r=iF(i);if(r==J||r==eo)return!i.size;if(he(i))return!jr(i).length;for(var c in i)if(tm.call(i,c))return!1;return!0},a.isEqual=function(i,r){return oe(i,r)},a.isEqualWith=function(i,r,l){var E=(l="function"==typeof l?l:c)?l(i,r):c;return E===c?oe(i,r,c,l):!!E},a.isError=Ei,a.isFinite=function(i){return"number"==typeof i&&io(i)},a.isFunction=Jn,a.isInteger=ra,a.isLength=ar,a.isMap=rz,a.isMatch=function(i,r){return i===r||kr(i,r,gi(r))},a.isMatchWith=function(i,r,l){return l="function"==typeof l?l:c,kr(i,r,gi(r),l)},a.isNaN=function(i){return sa(i)&&i!=+i},a.isNative=function(i){if(iG(i))throw new e8("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Qs(i)},a.isNil=function(i){return null==i},a.isNull=function(i){return null===i},a.isNumber=sa,a.isObject=K,a.isObjectLike=Y,a.isPlainObject=pe,a.isRegExp=rL,a.isSafeInteger=function(i){return ra(i)&&i>=-9007199254740991&&i<=9007199254740991},a.isSet=r$,a.isString=or,a.isSymbol=pn,a.isTypedArray=rH,a.isUndefined=function(i){return i===c},a.isWeakMap=function(i){return Y(i)&&iF(i)==el},a.isWeakSet=function(i){return Y(i)&&"[object WeakSet]"==en(i)},a.join=function(i,r){return null==i?"":ic.call(i,r)},a.kebabCase=r9,a.last=In,a.lastIndexOf=function(i,r,l){var E=null==i?0:i.length;if(!E)return -1;var S=E;return l!==c&&(S=(S=R(l))<0?il(E+S,0):ip(S,E-1)),r==r?function(i,r,c){for(var l=c+1;l--&&i[l]!==r;);return l}(i,r,S):ye(i,xs,S,!0)},a.lowerCase=r8,a.lowerFirst=r7,a.lt=rU,a.lte=rK,a.max=function(i){return i&&i.length?Ge(i,fn,Qr):c},a.maxBy=function(i,r){return i&&i.length?Ge(i,x(r,2),Qr):c},a.mean=function(i){return Es(i,fn)},a.meanBy=function(i,r){return Es(i,x(r,2))},a.min=function(i){return i&&i.length?Ge(i,fn,ni):c},a.minBy=function(i,r){return i&&i.length?Ge(i,x(r,2),ni):c},a.stubArray=Ni,a.stubFalse=Hi,a.stubObject=function(){return{}},a.stubString=function(){return""},a.stubTrue=function(){return!0},a.multiply=sP,a.nth=function(i,r){return i&&i.length?tu(i,R(r)):c},a.noConflict=function(){return tV._===this&&(tV._=tE),this},a.noop=Di,a.now=rI,a.pad=function(i,r,c){i=W(i);var l=(r=R(r))?Dt(i):0;if(!r||l>=r)return i;var E=(r-l)/2;return Ve(t7(E),c)+i+Ve(t8(E),c)},a.padEnd=function(i,r,c){i=W(i);var l=(r=R(r))?Dt(i):0;return r&&l<r?i+Ve(r-l,c):i},a.padStart=function(i,r,c){i=W(i);var l=(r=R(r))?Dt(i):0;return r&&l<r?Ve(r-l,c)+i:i},a.parseInt=function(i,r,c){return c||null==r?r=0:r&&(r=+r),ig(W(i).replace(e$,""),r||0)},a.random=function(i,r,l){if(l&&"boolean"!=typeof l&&rn(i,r,l)&&(r=l=c),l===c&&("boolean"==typeof r?(l=r,r=c):"boolean"==typeof i&&(l=i,i=c)),i===c&&r===c?(i=0,r=1):(i=Xn(i),r===c?(r=i,i=0):r=Xn(r)),i>r){var E=i;i=r,r=E}if(l||i%1||r%1){var S=iy();return ip(i+S*(r-i+t$("1e-"+((S+"").length-1))),r)}return ei(i,r)},a.reduce=function(i,r,c){var l=rD(i)?Nr:ys,E=arguments.length<3;return l(i,x(r,4),c,E,ij)},a.reduceRight=function(i,r,c){var l=rD(i)?tf:ys,E=arguments.length<3;return l(i,x(r,4),c,E,iM)},a.repeat=function(i,r,l){return r=(l?rn(i,r,l):r===c)?1:R(r),ri(W(i),r)},a.replace=function(){var i=arguments,r=W(i[0]);return i.length<3?r:r.replace(i[1],i[2])},a.result=function(i,r,l){r=st(r,i);var E=-1,S=r.length;for(S||(S=1,i=c);++E<S;){var P=null==i?c:i[Wn(r[E])];P===c&&(E=S,P=l),i=Jn(P)?P.call(i):P}return i},a.round=sC,a.runInContext=h,a.sample=function(i){return(rD(i)?qs:function(i){return qs(Gt(i))})(i)},a.size=function(i){if(null==i)return 0;if(an(i))return or(i)?Dt(i):i.length;var r=iF(i);return r==J||r==eo?i.size:jr(i).length},a.snakeCase=sn,a.some=function(i,r,l){var E=rD(i)?Hr:Bc;return l&&rn(i,r,l)&&(r=c),E(i,x(r,3))},a.sortedIndex=function(i,r){return Ye(i,r)},a.sortedIndexBy=function(i,r,c){return ii(i,r,x(c,2))},a.sortedIndexOf=function(i,r){var c=null==i?0:i.length;if(c){var l=Ye(i,r);if(l<c&&bn(i[l],r))return l}return -1},a.sortedLastIndex=function(i,r){return Ye(i,r,!0)},a.sortedLastIndexBy=function(i,r,c){return ii(i,r,x(c,2),!0)},a.sortedLastIndexOf=function(i,r){if(null==i?0:i.length){var c=Ye(i,r,!0)-1;if(bn(i[c],r))return c}return -1},a.startCase=so,a.startsWith=function(i,r,c){return i=W(i),c=null==c?0:vt(R(c),0,i.length),r=ln(r),i.slice(c,c+r.length)==r},a.subtract=sR,a.sum=function(i){return i&&i.length?Wr(i,fn):0},a.sumBy=function(i,r){return i&&i.length?Wr(i,x(r,2)):0},a.template=function(i,r,l){var E=a.templateSettings;l&&rn(i,r,l)&&(r=c),i=W(i),r=rW({},r,E,yu);var S,P,C=rW({},r.imports,E.imports,yu),A=V(C),q=Mr(C,A),T=0,D=r.interpolate||e5,M="__p += '",U=to((r.escape||e5).source+"|"+D.source+"|"+(D===eD?eG:e5).source+"|"+(r.evaluate||e5).source+"|$","g"),B="//# sourceURL="+(tm.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++tj+"]")+`
`;i.replace(U,function(r,c,l,E,C,A){return l||(l=E),M+=i.slice(T,A).replace(e6,lf),c&&(S=!0,M+=`' +
__e(`+c+`) +
'`),C&&(P=!0,M+=`';
`+C+`;
__p += '`),l&&(M+=`' +
((__t = (`+l+`)) == null ? '' : __t) +
'`),T=A+r.length,r}),M+=`';
`;var F=tm.call(r,"variable")&&r.variable;if(F){if(eW.test(F))throw new e8("Invalid `variable` option passed into `_.template`")}else M=`with (obj) {
`+M+`
}
`;M=(P?M.replace(ex,""):M).replace(eS,"$1").replace(eP,"$1;"),M="function("+(F||"obj")+`) {
`+(F?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(S?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+M+`return __p
}`;var J=sl(function(){return e7(A,B+"return "+M).apply(c,q)});if(J.source=M,Ei(J))throw J;return J},a.times=function(i,r){if((i=R(i))<1||i>9007199254740991)return[];var c=4294967295,l=ip(i,4294967295);r=x(r),i-=4294967295;for(var E=Fr(l,r);++c<i;)r(c);return E},a.toFinite=Xn,a.toInteger=R,a.toLength=oa,a.toLower=function(i){return W(i).toLowerCase()},a.toNumber=xn,a.toSafeInteger=function(i){return i?vt(R(i),-9007199254740991,9007199254740991):0===i?i:0},a.toString=W,a.toUpper=function(i){return W(i).toUpperCase()},a.trim=function(i,r,l){if((i=W(i))&&(l||r===c))return Ss(i);if(!i||!(r=ln(r)))return i;var E=On(i),S=On(r),P=Os(E,S),C=Rs(E,S)+1;return ut(E,P,C).join("")},a.trimEnd=function(i,r,l){if((i=W(i))&&(l||r===c))return i.slice(0,Ts(i)+1);if(!i||!(r=ln(r)))return i;var E=On(i),S=Rs(E,On(r))+1;return ut(E,0,S).join("")},a.trimStart=function(i,r,l){if((i=W(i))&&(l||r===c))return i.replace(e$,"");if(!i||!(r=ln(r)))return i;var E=On(i),S=Os(E,On(r));return ut(E,S).join("")},a.truncate=function(i,r){var l=30,E="...";if(K(r)){var S="separator"in r?r.separator:S;l="length"in r?R(r.length):l,E="omission"in r?ln(r.omission):E}var P=(i=W(i)).length;if(Lt(i)){var C=On(i);P=C.length}if(l>=P)return i;var A=l-Dt(E);if(A<1)return E;var q=C?ut(C,0,A).join(""):i.slice(0,A);if(S===c)return q+E;if(C&&(A+=q.length-A),rL(S)){if(i.slice(A).search(S)){var T,D=q;for(S.global||(S=to(S.source,W(eJ.exec(S))+"g")),S.lastIndex=0;T=S.exec(D);)var M=T.index;q=q.slice(0,M===c?A:M)}}else if(i.indexOf(ln(S),A)!=A){var U=q.lastIndexOf(S);U>-1&&(q=q.slice(0,U))}return q+E},a.unescape=function(i){return(i=W(i))&&eO.test(i)?i.replace(eC,t3):i},a.uniqueId=function(i){var r=++t_;return W(i)+r},a.upperCase=sc,a.upperFirst=sh,a.each=Ju,a.eachRight=Xu,a.first=zu,Li(a,(e3={},$n(a,function(i,r){tm.call(a.prototype,r)||(e3[r]=i)}),e3),{chain:!1}),a.VERSION="4.17.21",mn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){a[i].placeholder=a}),mn(["drop","take"],function(i,r){H.prototype[i]=function(l){l=l===c?1:il(R(l),0);var E=this.__filtered__&&!r?new H(this):this.clone();return E.__filtered__?E.__takeCount__=ip(l,E.__takeCount__):E.__views__.push({size:ip(l,4294967295),type:i+(E.__dir__<0?"Right":"")}),E},H.prototype[i+"Right"]=function(r){return this.reverse()[i](r).reverse()}}),mn(["filter","map","takeWhile"],function(i,r){var c=r+1,l=1==c||3==c;H.prototype[i]=function(i){var r=this.clone();return r.__iteratees__.push({iteratee:x(i,3),type:c}),r.__filtered__=r.__filtered__||l,r}}),mn(["head","last"],function(i,r){var c="take"+(r?"Right":"");H.prototype[i]=function(){return this[c](1).value()[0]}}),mn(["initial","tail"],function(i,r){var c="drop"+(r?"":"Right");H.prototype[i]=function(){return this.__filtered__?new H(this):this[c](1)}}),H.prototype.compact=function(){return this.filter(fn)},H.prototype.find=function(i){return this.filter(i).head()},H.prototype.findLast=function(i){return this.reverse().find(i)},H.prototype.invokeMap=L(function(i,r){return"function"==typeof i?new H(this):this.map(function(c){return ae(c,i,r)})}),H.prototype.reject=function(i){return this.filter(ur(x(i)))},H.prototype.slice=function(i,r){i=R(i);var l=this;return l.__filtered__&&(i>0||r<0)?new H(l):(i<0?l=l.takeRight(-i):i&&(l=l.drop(i)),r!==c&&(l=(r=R(r))<0?l.dropRight(-r):l.take(r-i)),l)},H.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},H.prototype.toArray=function(){return this.take(4294967295)},$n(H.prototype,function(i,r){var l=/^(?:filter|find|map|reject)|While$/.test(r),E=/^(?:head|last)$/.test(r),S=a[E?"take"+("last"==r?"Right":""):r],P=E||/^find/.test(r);S&&(a.prototype[r]=function(){var r=this.__wrapped__,C=E?[1]:arguments,A=r instanceof H,q=C[0],T=A||rD(r),m=function(i){var r=S.apply(a,nt([i],C));return E&&D?r[0]:r};T&&l&&"function"==typeof q&&1!=q.length&&(A=T=!1);var D=this.__chain__,M=!!this.__actions__.length,U=P&&!D,B=A&&!M;if(!P&&T){r=B?r:new H(this);var F=i.apply(r,C);return F.__actions__.push({func:er,args:[m],thisArg:c}),new Pn(F,D)}return U&&B?i.apply(this,C):(F=this.thru(m),U?E?F.value()[0]:F.value():F)})}),mn(["pop","push","shift","sort","splice","unshift"],function(i){var r=tl[i],c=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",l=/^(?:pop|shift)$/.test(i);a.prototype[i]=function(){var i=arguments;if(l&&!this.__chain__){var E=this.value();return r.apply(rD(E)?E:[],i)}return this[c](function(c){return r.apply(rD(c)?c:[],i)})}}),$n(H.prototype,function(i,r){var c=a[r];if(c){var l=c.name+"";tm.call(iP,l)||(iP[l]=[]),iP[l].push({name:r,func:c})}}),iP[Xe(c,2).name]=[{name:"wrapper",func:c}],H.prototype.clone=function(){var i=new H(this.__wrapped__);return i.__actions__=un(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=un(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=un(this.__views__),i},H.prototype.reverse=function(){if(this.__filtered__){var i=new H(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i},H.prototype.value=function(){var i=this.__wrapped__.value(),r=this.__dir__,c=rD(i),l=r<0,E=c?i.length:0,S=function(i,r,c){for(var l=-1,E=c.length;++l<E;){var S=c[l],P=S.size;switch(S.type){case"drop":i+=P;break;case"dropRight":r-=P;break;case"take":r=ip(r,i+P);break;case"takeRight":i=il(i,r-P)}}return{start:i,end:r}}(0,E,this.__views__),P=S.start,C=S.end,A=C-P,q=l?C:P-1,T=this.__iteratees__,D=T.length,M=0,U=ip(A,this.__takeCount__);if(!c||!l&&E==A&&U==A)return fu(i,this.__actions__);var B=[];e:for(;A--&&M<U;){q+=r;for(var F=-1,J=i[q];++F<D;){var X=T[F],ee=X.iteratee,et=X.type,ea=ee(J);if(2==et)J=ea;else if(!ea){if(1==et)continue e;break e}}B[M++]=J}return B},a.prototype.at=rp,a.prototype.chain=function(){return Zu(this)},a.prototype.commit=function(){return new Pn(this.value(),this.__chain__)},a.prototype.next=function(){this.__values__===c&&(this.__values__=aa(this.value()));var i=this.__index__>=this.__values__.length,r=i?c:this.__values__[this.__index__++];return{done:i,value:r}},a.prototype.plant=function(i){for(var r,l=this;l instanceof qe;){var E=Mu(l);E.__index__=0,E.__values__=c,r?S.__wrapped__=E:r=E;var S=E;l=l.__wrapped__}return S.__wrapped__=i,r},a.prototype.reverse=function(){var i=this.__wrapped__;if(i instanceof H){var r=i;return this.__actions__.length&&(r=new H(this)),(r=r.reverse()).__actions__.push({func:er,args:[Ai],thisArg:c}),new Pn(r,this.__chain__)}return this.thru(Ai)},a.prototype.toJSON=a.prototype.valueOf=a.prototype.value=function(){return fu(this.__wrapped__,this.__actions__)},a.prototype.first=a.prototype.head,tB&&(a.prototype[tB]=function(){return this}),a}();tW?((tW.exports=t4)._=t4,tB._=t4):tV._=t4}).call(iE)}(ix,ix.exports);var iS=Object.defineProperty,iP=Object.defineProperties,iC=Object.getOwnPropertyDescriptors,iR=Object.getOwnPropertySymbols,iO=Object.prototype.hasOwnProperty,iA=Object.prototype.propertyIsEnumerable,Sa=(i,r,c)=>r in i?iS(i,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[r]=c,index_es_cr=(i,r)=>{for(var c in r||(r={}))iO.call(r,c)&&Sa(i,c,r[c]);if(iR)for(var c of iR(r))iA.call(r,c)&&Sa(i,c,r[c]);return i},Xg=(i,r)=>iP(i,iC(r));function index_es_ft(i,r,c){var l;let E=(0,P.DQe)(i);return(null==(l=r.rpcMap)?void 0:l[E.reference])||`https://rpc.walletconnect.com/v1/?chainId=${E.namespace}:${E.reference}&projectId=${c}`}function index_es_Ct(i){return i.includes(":")?i.split(":")[1]:i}function Oa(i){return i.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function index_es_Wi(i={},r={}){let c=Ra(i),l=Ra(r);return ix.exports.merge(c,l)}function Ra(i){var r,c,l,E;let S={};if(!(0,P.L5o)(i))return S;for(let[C,A]of Object.entries(i)){let i=(0,P.gpE)(C)?[C]:A.chains,q=A.methods||[],T=A.events||[],D=A.rpcMap||{},M=(0,P.Maj)(C);S[M]=Xg(index_es_cr(index_es_cr({},S[M]),A),{chains:(0,P.eGA)(i,null==(r=S[M])?void 0:r.chains),methods:(0,P.eGA)(q,null==(c=S[M])?void 0:c.methods),events:(0,P.eGA)(T,null==(l=S[M])?void 0:l.events),rpcMap:index_es_cr(index_es_cr({},D),null==(E=S[M])?void 0:E.rpcMap)})}return S}function Vg(i){return i.includes(":")?i.split(":")[2]:i}function ba(i){let r={};for(let[c,l]of Object.entries(i)){let i=l.methods||[],E=l.events||[],S=l.accounts||[],C=(0,P.gpE)(c)?[c]:l.chains?l.chains:Oa(l.accounts);r[c]={chains:C,methods:i,events:E,accounts:S}}return r}function Fi(i){return"number"==typeof i?i:i.includes("0x")?parseInt(i,16):isNaN(Number(i=i.includes(":")?i.split(":")[1]:i))?i:Number(i)}let iq={},dist_index_es_z=i=>iq[i],Mi=(i,r)=>{iq[i]=r};let kg=class kg{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=dist_index_es_z("events"),this.client=dist_index_es_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let i=this.namespace.chains[0];if(!i)throw Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(iI.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getAccounts(){let i=this.namespace.accounts;return i&&i.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]}createHttpProviders(){let i={};return this.namespace.chains.forEach(r=>{var c;let l=index_es_Ct(r);i[l]=this.createHttpProvider(l,null==(c=this.namespace.rpcMap)?void 0:c[r])}),i}getHttpProvider(){let i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){let c=this.createHttpProvider(i,r);c&&(this.httpProviders[i]=c)}createHttpProvider(i,r){let c=r||index_es_ft(i,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${i}`);return new ey.r(new i_.Z(c,dist_index_es_z("disableProviderPing")))}};let jg=class jg{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=dist_index_es_z("events"),this.client=dist_index_es_z("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(parseInt(i),r),this.chainId=parseInt(i),this.events.emit(iI.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let i=this.namespace.chains[0];if(!i)throw Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){let c=r||index_es_ft(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${i}`);return new ey.r(new i_.k(c,dist_index_es_z("disableProviderPing")))}setHttpProvider(i,r){let c=this.createHttpProvider(i,r);c&&(this.httpProviders[i]=c)}createHttpProviders(){let i={};return this.namespace.chains.forEach(r=>{var c;let l=parseInt(index_es_Ct(r));i[l]=this.createHttpProvider(l,null==(c=this.namespace.rpcMap)?void 0:c[r])}),i}getAccounts(){let i=this.namespace.accounts;return i?[...new Set(i.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){let i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,c;let l=i.request.params?null==(r=i.request.params[0])?void 0:r.chainId:"0x0";l=l.startsWith("0x")?l:`0x${l}`;let E=parseInt(l,16);if(this.isChainApproved(E))this.setDefaultChain(`${E}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:l}]},chainId:null==(c=this.namespace.chains)?void 0:c[0]}),this.setDefaultChain(`${E}`);else throw Error(`Failed to switch to chain 'eip155:${E}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}};let nv=class nv{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=dist_index_es_z("events"),this.client=dist_index_es_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(iI.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let i=this.namespace.chains[0];if(!i)throw Error("ChainId not found");return i.split(":")[1]}getAccounts(){let i=this.namespace.accounts;return i?[...new Set(i.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){let i={};return this.namespace.chains.forEach(r=>{var c;let l=index_es_Ct(r);i[l]=this.createHttpProvider(l,null==(c=this.namespace.rpcMap)?void 0:c[r])}),i}getHttpProvider(){let i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){let c=this.createHttpProvider(i,r);c&&(this.httpProviders[i]=c)}createHttpProvider(i,r){let c=r||index_es_ft(i,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${i}`);return new ey.r(new i_.Z(c,dist_index_es_z("disableProviderPing")))}};let tv=class tv{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=dist_index_es_z("events"),this.client=dist_index_es_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let i=this.namespace.chains[0];if(!i)throw Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(iI.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let i=this.namespace.accounts;return i?[...new Set(i.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){let i={};return this.namespace.chains.forEach(r=>{var c;let l=index_es_Ct(r);i[l]=this.createHttpProvider(l,null==(c=this.namespace.rpcMap)?void 0:c[r])}),i}getHttpProvider(){let i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){let c=this.createHttpProvider(i,r);c&&(this.httpProviders[i]=c)}createHttpProvider(i,r){let c=r||index_es_ft(i,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${i}`);return new ey.r(new i_.Z(c,dist_index_es_z("disableProviderPing")))}};let ev=class ev{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=dist_index_es_z("events"),this.client=dist_index_es_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let i=this.namespace.chains[0];if(!i)throw Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(iI.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let i=this.namespace.accounts;return i?[...new Set(i.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){let i={};return this.namespace.chains.forEach(r=>{let c=this.getCardanoRPCUrl(r),l=index_es_Ct(r);i[l]=this.createHttpProvider(l,c)}),i}getHttpProvider(){let i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){let r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){let c=this.createHttpProvider(i,r);c&&(this.httpProviders[i]=c)}createHttpProvider(i,r){let c=r||this.getCardanoRPCUrl(i);if(!c)throw Error(`No RPC url provided for chainId: ${i}`);return new ey.r(new i_.Z(c,dist_index_es_z("disableProviderPing")))}};let rv=class rv{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=dist_index_es_z("events"),this.client=dist_index_es_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(iI.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let i=this.namespace.chains[0];if(!i)throw Error("ChainId not found");return i.split(":")[1]}getAccounts(){let i=this.namespace.accounts;return i?[...new Set(i.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){let i={};return this.namespace.chains.forEach(r=>{var c;let l=index_es_Ct(r);i[l]=this.createHttpProvider(l,null==(c=this.namespace.rpcMap)?void 0:c[r])}),i}getHttpProvider(){let i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){let c=this.createHttpProvider(i,r);c&&(this.httpProviders[i]=c)}createHttpProvider(i,r){let c=r||index_es_ft(i,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${i}`);return new ey.r(new i_.Z(c,dist_index_es_z("disableProviderPing")))}};let iv=class iv{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=dist_index_es_z("events"),this.client=dist_index_es_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){this.httpProviders[i]||this.setHttpProvider(i,r),this.chainId=i,this.events.emit(iI.DEFAULT_CHAIN_CHANGED,`${this.name}:${i}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let i=this.namespace.chains[0];if(!i)throw Error("ChainId not found");return i.split(":")[1]}getAccounts(){let i=this.namespace.accounts;return i?[...new Set(i.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){let i={};return this.namespace.chains.forEach(r=>{var c;let l=index_es_Ct(r);i[l]=this.createHttpProvider(l,null==(c=this.namespace.rpcMap)?void 0:c[r])}),i}getHttpProvider(){let i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){let c=this.createHttpProvider(i,r);c&&(this.httpProviders[i]=c)}createHttpProvider(i,r){let c=r||index_es_ft(i,this.namespace,this.client.core.projectId);if(!c)throw Error(`No RPC url provided for chainId: ${i}`);return new ey.r(new i_.Z(c,dist_index_es_z("disableProviderPing")))}};let sv=class sv{constructor(i){this.name="near",this.namespace=i.namespace,this.events=dist_index_es_z("events"),this.client=dist_index_es_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let i=this.namespace.chains[0];if(!i)throw Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){let c=r||index_es_ft(`${this.name}:${i}`,this.namespace);if(!c)throw Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,c)}this.events.emit(iI.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let i=this.namespace.accounts;return i&&i.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]}createHttpProviders(){let i={};return this.namespace.chains.forEach(r=>{var c;i[r]=this.createHttpProvider(r,null==(c=this.namespace.rpcMap)?void 0:c[r])}),i}getHttpProvider(){let i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){let c=this.createHttpProvider(i,r);c&&(this.httpProviders[i]=c)}createHttpProvider(i,r){let c=r||index_es_ft(i,this.namespace);return typeof c>"u"?void 0:new ey.r(new i_.Z(c,dist_index_es_z("disableProviderPing")))}};var iN=Object.defineProperty,iT=Object.defineProperties,iD=Object.getOwnPropertyDescriptors,ik=Object.getOwnPropertySymbols,ij=Object.prototype.hasOwnProperty,iM=Object.prototype.propertyIsEnumerable,Da=(i,r,c)=>r in i?iN(i,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[r]=c,index_es_hr=(i,r)=>{for(var c in r||(r={}))ij.call(r,c)&&Da(i,c,r[c]);if(ik)for(var c of ik(r))iM.call(r,c)&&Da(i,c,r[c]);return i},qi=(i,r)=>iT(i,iD(r));let index_es_lr=class index_es_lr{constructor(i){this.events=new(S()),this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger="u">typeof i?.logger&&"string"!=typeof i?.logger?i.logger:(0,ee.gw)((0,ee.jI)({level:i?.logger||iw})),this.disableProviderPing=i?.disableProviderPing||!1}static async init(i){let r=new index_es_lr(i);return await r.initialize(),r}async request(i,r,c){let[l,E]=this.validateChain(r);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(l).request({request:index_es_hr({},i),chainId:`${l}:${E}`,topic:this.session.topic,expiry:c})}sendAsync(i,r,c,l){let E=new Date().getTime();this.request(i,c,l).then(i=>r(null,(0,em.formatJsonRpcResult)(E,i))).catch(i=>r(i,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(i=this.session)?void 0:i.topic,reason:(0,P.D6H)("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}async authenticate(i){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(i),await this.cleanupPendingPairings();let{uri:r,response:c}=await this.client.authenticate(i);r&&(this.uri=r,this.events.emit("display_uri",r));let l=await c();if(this.session=l.session,this.session){let i=ba(this.session.namespaces);this.namespaces=index_es_Wi(this.namespaces,i),this.persist("namespaces",this.namespaces),this.onConnect()}return l}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw Error("Max auto pairing attempts reached");let{uri:c,approval:l}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});c&&(this.uri=c,this.events.emit("display_uri",c)),await l().then(i=>{this.session=i;let r=ba(i.namespaces);this.namespaces=index_es_Wi(this.namespaces,r),this.persist("namespaces",this.namespaces)}).catch(i=>{if(i.message!==t9)throw i;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;let[c,l]=this.validateChain(i);this.getProvider(c).setDefaultChain(l,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");let r=this.client.pairing.getAll();if((0,P.qt8)(r)){for(let c of r)i.deletePairings?this.client.core.expirer.set(c.topic,0):await this.client.core.relayer.subscriber.unsubscribe(c.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){let i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await oe.init({logger:this.providerOpts.logger||iw,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.com",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let i=[...new Set(Object.keys(this.session.namespaces).map(i=>(0,P.Maj)(i)))];Mi("client",this.client),Mi("events",this.events),Mi("disableProviderPing",this.disableProviderPing),i.forEach(i=>{if(!this.session)return;let r=function(i,r){let c=Object.keys(r.namespaces).filter(r=>r.includes(i));if(!c.length)return[];let l=[];return c.forEach(i=>{let c=r.namespaces[i].accounts;l.push(...c)}),l}(i,this.session),c=Oa(r),l=index_es_Wi(this.namespaces,this.optionalNamespaces),E=qi(index_es_hr({},l[i]),{accounts:r,chains:c});switch(i){case"eip155":this.rpcProviders[i]=new jg({namespace:E});break;case"solana":this.rpcProviders[i]=new nv({namespace:E});break;case"cosmos":this.rpcProviders[i]=new tv({namespace:E});break;case"polkadot":this.rpcProviders[i]=new kg({namespace:E});break;case"cip34":this.rpcProviders[i]=new ev({namespace:E});break;case"elrond":this.rpcProviders[i]=new rv({namespace:E});break;case"multiversx":this.rpcProviders[i]=new iv({namespace:E});break;case"near":this.rpcProviders[i]=new sv({namespace:E})}})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{let{params:r}=i,{event:c}=r;if("accountsChanged"===c.name){let i=c.data;i&&(0,P.qt8)(i)&&this.events.emit("accountsChanged",i.map(Vg))}else if("chainChanged"===c.name){let i=r.chainId,c=r.event.data,l=(0,P.Maj)(i),E=Fi(i)!==Fi(c)?`${l}:${Fi(c)}`:i;this.onChainChanged(E)}else this.events.emit(c.name,c.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var c;let{namespaces:l}=r,E=null==(c=this.client)?void 0:c.session.get(i);this.session=qi(index_es_hr({},E),{namespaces:l}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",qi(index_es_hr({},(0,P.D6H)("USER_DISCONNECTED")),{data:i.topic}))}),this.on(iI.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace(null==(r=this.session)?void 0:r.namespaces[i])})}setNamespaces(i){let{namespaces:r,optionalNamespaces:c,sessionProperties:l}=i;r&&Object.keys(r).length&&(this.namespaces=r),c&&Object.keys(c).length&&(this.optionalNamespaces=c),this.sessionProperties=l,this.persist("namespaces",r),this.persist("optionalNamespaces",c)}validateChain(i){let[r,c]=i?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,c];if(r&&!Object.keys(this.namespaces||{}).map(i=>(0,P.Maj)(i)).includes(r))throw Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&c)return[r,c];let l=(0,P.Maj)(Object.keys(this.namespaces)[0]),E=this.rpcProviders[l].getDefaultChain();return[l,E]}async requestAccounts(){let[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){if(!this.namespaces)return;let[c,l]=this.validateChain(i);l&&(r||this.getProvider(c).setDefaultChain(l),this.namespaces[c]?this.namespaces[c].defaultChain=l:this.namespaces[`${c}:${l}`]?this.namespaces[`${c}:${l}`].defaultChain=l:this.namespaces[`${c}:${l}`]={defaultChain:l},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${ib}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${ib}/${i}`)}};let iz=["eth_sendTransaction","personal_sign"],iL=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],i$=["chainChanged","accountsChanged"],iH=["chainChanged","accountsChanged","message","disconnect","connect"];var iU=Object.defineProperty,iK=Object.defineProperties,iV=Object.getOwnPropertyDescriptors,iB=Object.getOwnPropertySymbols,iW=Object.prototype.hasOwnProperty,iF=Object.prototype.propertyIsEnumerable,dist_index_es_b=(i,r,c)=>r in i?iU(i,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[r]=c,index_es_p=(i,r)=>{for(var c in r||(r={}))iW.call(r,c)&&dist_index_es_b(i,c,r[c]);if(iB)for(var c of iB(r))iF.call(r,c)&&dist_index_es_b(i,c,r[c]);return i},ethereum_provider_dist_index_es_E=(i,r)=>iK(i,iV(r));function index_es_m(i){return Number(i[0].split(":")[1])}function index_es_v(i){return`0x${i.toString(16)}`}let ethereum_provider_dist_index_es_C=class ethereum_provider_dist_index_es_C{constructor(){this.events=new E.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY="wc@2:ethereum_provider:",this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){let r=new ethereum_provider_dist_index_es_C;return await r.initialize(i),r}async request(i,r){return await this.signer.request(i,this.formatChainId(this.chainId),r)}sendAsync(i,r,c){this.signer.sendAsync(i,r,this.formatChainId(this.chainId),c)}get connected(){return!!this.signer.client&&this.signer.client.core.relayer.connected}get connecting(){return!!this.signer.client&&this.signer.client.core.relayer.connecting}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);let{required:r,optional:c}=function(i){let{chains:r,optionalChains:c,methods:l,optionalMethods:E,events:S,optionalEvents:C,rpcMap:A}=i;if(!(0,P.qt8)(r))throw Error("Invalid chains");let q={chains:r,methods:l||iz,events:S||i$,rpcMap:index_es_p({},r.length?{[index_es_m(r)]:A[index_es_m(r)]}:{})},T=S?.filter(i=>!i$.includes(i)),D=l?.filter(i=>!iz.includes(i));if(!c&&!C&&!E&&!(null!=T&&T.length)&&!(null!=D&&D.length))return{required:r.length?q:void 0};let M=T?.length&&D?.length||!c,U={chains:[...new Set(M?q.chains.concat(c||[]):c)],methods:[...new Set(q.methods.concat(null!=E&&E.length?E:iL))],events:[...new Set(q.events.concat(null!=C&&C.length?C:iH))],rpcMap:A};return{required:r.length?q:void 0,optional:c.length?U:void 0}}(this.rpc);try{let l=await new Promise(async(l,E)=>{var S;this.rpc.showQrModal&&(null==(S=this.modal)||S.subscribeModal(i=>{i.open||this.signer.session||(this.signer.abortPairingAttempt(),E(Error("Connection request reset. Please try again.")))})),await this.signer.connect(ethereum_provider_dist_index_es_E(index_es_p({namespaces:index_es_p({},r&&{[this.namespace]:r})},c&&{optionalNamespaces:{[this.namespace]:c}}),{pairingTopic:i?.pairingTopic})).then(i=>{l(i)}).catch(i=>{E(Error(i.message))})});if(!l)return;let E=(0,P.guN)(l.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:E),this.setAccounts(E),this.events.emit("connect",{chainId:index_es_v(this.chainId)})}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async authenticate(i){if(!this.signer.client)throw Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:i?.chains});try{let r=await new Promise(async(r,c)=>{var l;this.rpc.showQrModal&&(null==(l=this.modal)||l.subscribeModal(i=>{i.open||this.signer.session||(this.signer.abortPairingAttempt(),c(Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(ethereum_provider_dist_index_es_E(index_es_p({},i),{chains:this.rpc.chains})).then(i=>{r(i)}).catch(i=>{c(Error(i.message))})}),c=r.session;if(c){let i=(0,P.guN)(c.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:i),this.setAccounts(i),this.events.emit("connect",{chainId:index_es_v(this.chainId)})}return r}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{let{params:r}=i,{event:c}=r;"accountsChanged"===c.name?(this.accounts=this.parseAccounts(c.data),this.events.emit("accountsChanged",this.accounts)):"chainChanged"===c.name?this.setChainId(this.formatChainId(c.data)):this.events.emit(c.name,c.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{let r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",index_es_v(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",ethereum_provider_dist_index_es_E(index_es_p({},(0,P.D6H)("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,c;this.rpc.showQrModal&&(null==(r=this.modal)||r.closeModal(),null==(c=this.modal)||c.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return"string"==typeof i&&i.startsWith(`${this.namespace}:`)}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){let r=i.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",index_es_v(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){let r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){let[r,c,l]=i.split(":");return{chainId:`${r}:${c}`,address:l}}setAccounts(i){this.accounts=i.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,c;let l=null!=(r=i?.chains)?r:[],E=null!=(c=i?.optionalChains)?c:[],S=l.concat(E);if(!S.length)throw Error("No chains specified in either `chains` or `optionalChains`");let P=l.length?i?.methods||iz:[],C=l.length?i?.events||i$:[],A=i?.optionalMethods||[],q=i?.optionalEvents||[],T=i?.rpcMap||this.buildRpcMap(S,i.projectId),D=i?.qrModalOptions||void 0;return{chains:l?.map(i=>this.formatChainId(i)),optionalChains:E.map(i=>this.formatChainId(i)),methods:P,events:C,optionalMethods:A,optionalEvents:q,rpcMap:T,showQrModal:!!(null!=i&&i.showQrModal),qrModalOptions:D,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){let c={};return i.forEach(i=>{c[i]=this.getRpcUrl(i,r)}),c}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?index_es_m(this.rpc.chains):index_es_m(this.rpc.optionalChains),this.signer=await index_es_lr.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{let{WalletConnectModal:r}=await c.e(343).then(c.bind(c,59343));i=r}catch{throw Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(index_es_p({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;let{chains:r,optionalChains:c,rpcMap:l}=i;r&&(0,P.qt8)(r)&&(this.rpc.chains=r.map(i=>this.formatChainId(i)),r.forEach(i=>{this.rpc.rpcMap[i]=l?.[i]||this.getRpcUrl(i)})),c&&(0,P.qt8)(c)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=c?.map(i=>this.formatChainId(i)),c.forEach(i=>{this.rpc.rpcMap[i]=l?.[i]||this.getRpcUrl(i)}))}getRpcUrl(i,r){var c;return(null==(c=this.rpc.rpcMap)?void 0:c[i])||`https://rpc.walletconnect.com/v1/?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{let i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r?.accounts),this.setAccounts(r?.accounts)}catch(i){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(i),await this.disconnect().catch(i=>this.signer.logger.warn(i))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return"string"==typeof i||i instanceof String?[this.parseAccount(i)]:i.map(i=>this.parseAccount(i))}};let iG=ethereum_provider_dist_index_es_C},72030:function(i){"use strict";i.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},43014:function(){},43631:function(i,r,c){"use strict";c.d(r,{qY:function(){return detect}});var l=c(34155),__spreadArray=function(i,r,c){if(c||2==arguments.length)for(var l,E=0,S=r.length;E<S;E++)!l&&E in r||(l||(l=Array.prototype.slice.call(r,0,E)),l[E]=r[E]);return i.concat(l||Array.prototype.slice.call(r))},BrowserInfo=function(i,r,c){this.name=i,this.version=r,this.os=c,this.type="browser"},NodeInfo=function(i){this.version=i,this.type="node",this.name="node",this.os=l.platform},SearchBotDeviceInfo=function(i,r,c,l){this.name=i,this.version=r,this.os=c,this.bot=l,this.type="bot-device"},BotInfo=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},ReactNativeInfo=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},E=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,S=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],P=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function detect(i){return i?parseUserAgent(i):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new ReactNativeInfo:"undefined"!=typeof navigator?parseUserAgent(navigator.userAgent):void 0!==l&&l.version?new NodeInfo(l.version.slice(1)):null}function parseUserAgent(i){var r=""!==i&&S.reduce(function(r,c){var l=c[0],E=c[1];if(r)return r;var S=E.exec(i);return!!S&&[l,S]},!1);if(!r)return null;var c=r[0],l=r[1];if("searchbot"===c)return new BotInfo;var C=l[1]&&l[1].split(".").join("_").split("_").slice(0,3);C?C.length<3&&(C=__spreadArray(__spreadArray([],C,!0),function(i){for(var r=[],c=0;c<i;c++)r.push("0");return r}(3-C.length),!0)):C=[];var A=C.join("."),q=function(i){for(var r=0,c=P.length;r<c;r++){var l=P[r],E=l[0];if(l[1].exec(i))return E}return null}(i),T=E.exec(i);return T&&T[1]?new SearchBotDeviceInfo(c,A,q,T[1]):new BrowserInfo(c,A,q)}},72307:function(i,r,c){i=c.nmd(i);var l,E,S,P="__lodash_hash_undefined__",C="[object Arguments]",A="[object Array]",q="[object Boolean]",T="[object Date]",D="[object Error]",M="[object Function]",U="[object Map]",B="[object Number]",F="[object Object]",J="[object Promise]",X="[object RegExp]",ee="[object Set]",et="[object String]",ea="[object WeakMap]",eo="[object ArrayBuffer]",ec="[object DataView]",eh=/^\[object .+?Constructor\]$/,el=/^(?:0|[1-9]\d*)$/,ep={};ep["[object Float32Array]"]=ep["[object Float64Array]"]=ep["[object Int8Array]"]=ep["[object Int16Array]"]=ep["[object Int32Array]"]=ep["[object Uint8Array]"]=ep["[object Uint8ClampedArray]"]=ep["[object Uint16Array]"]=ep["[object Uint32Array]"]=!0,ep[C]=ep[A]=ep[eo]=ep[q]=ep[ec]=ep[T]=ep[D]=ep[M]=ep[U]=ep[B]=ep[F]=ep[X]=ep[ee]=ep[et]=ep[ea]=!1;var ed="object"==typeof c.g&&c.g&&c.g.Object===Object&&c.g,ef="object"==typeof self&&self&&self.Object===Object&&self,eg=ed||ef||Function("return this")(),ey=r&&!r.nodeType&&r,em=ey&&i&&!i.nodeType&&i,e_=em&&em.exports===ey,ew=e_&&ed.process,eb=function(){try{return ew&&ew.binding&&ew.binding("util")}catch(i){}}(),eI=eb&&eb.isTypedArray;function mapToArray(i){var r=-1,c=Array(i.size);return i.forEach(function(i,l){c[++r]=[l,i]}),c}function setToArray(i){var r=-1,c=Array(i.size);return i.forEach(function(i){c[++r]=i}),c}var eE=Array.prototype,ex=Function.prototype,eS=Object.prototype,eP=eg["__core-js_shared__"],eC=ex.toString,eR=eS.hasOwnProperty,eO=(l=/[^.]+$/.exec(eP&&eP.keys&&eP.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"",eA=eS.toString,eN=RegExp("^"+eC.call(eR).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),eT=e_?eg.Buffer:void 0,eD=eg.Symbol,ek=eg.Uint8Array,ej=eS.propertyIsEnumerable,eM=eE.splice,ez=eD?eD.toStringTag:void 0,eL=Object.getOwnPropertySymbols,e$=eT?eT.isBuffer:void 0,eH=(E=Object.keys,S=Object,function(i){return E(S(i))}),eU=getNative(eg,"DataView"),eK=getNative(eg,"Map"),eV=getNative(eg,"Promise"),eB=getNative(eg,"Set"),eW=getNative(eg,"WeakMap"),eF=getNative(Object,"create"),eG=toSource(eU),eJ=toSource(eK),eY=toSource(eV),eZ=toSource(eB),eQ=toSource(eW),eX=eD?eD.prototype:void 0,e0=eX?eX.valueOf:void 0;function Hash(i){var r=-1,c=null==i?0:i.length;for(this.clear();++r<c;){var l=i[r];this.set(l[0],l[1])}}function ListCache(i){var r=-1,c=null==i?0:i.length;for(this.clear();++r<c;){var l=i[r];this.set(l[0],l[1])}}function MapCache(i){var r=-1,c=null==i?0:i.length;for(this.clear();++r<c;){var l=i[r];this.set(l[0],l[1])}}function SetCache(i){var r=-1,c=null==i?0:i.length;for(this.__data__=new MapCache;++r<c;)this.add(i[r])}function Stack(i){var r=this.__data__=new ListCache(i);this.size=r.size}function assocIndexOf(i,r){for(var c=i.length;c--;)if(eq(i[c][0],r))return c;return -1}function baseGetTag(i){return null==i?void 0===i?"[object Undefined]":"[object Null]":ez&&ez in Object(i)?function(i){var r=eR.call(i,ez),c=i[ez];try{i[ez]=void 0;var l=!0}catch(i){}var E=eA.call(i);return l&&(r?i[ez]=c:delete i[ez]),E}(i):eA.call(i)}function baseIsArguments(i){return isObjectLike(i)&&baseGetTag(i)==C}function equalArrays(i,r,c,l,E,S){var P=1&c,C=i.length,A=r.length;if(C!=A&&!(P&&A>C))return!1;var q=S.get(i);if(q&&S.get(r))return q==r;var T=-1,D=!0,M=2&c?new SetCache:void 0;for(S.set(i,r),S.set(r,i);++T<C;){var U=i[T],B=r[T];if(l)var F=P?l(B,U,T,r,i,S):l(U,B,T,i,r,S);if(void 0!==F){if(F)continue;D=!1;break}if(M){if(!function(i,r){for(var c=-1,l=null==i?0:i.length;++c<l;)if(r(i[c],c,i))return!0;return!1}(r,function(i,r){if(!M.has(r)&&(U===i||E(U,i,c,l,S)))return M.push(r)})){D=!1;break}}else if(!(U===B||E(U,B,c,l,S))){D=!1;break}}return S.delete(i),S.delete(r),D}function getAllKeys(i){var r;return r=function(i){return null!=i&&isLength(i.length)&&!isFunction(i)?function(i,r){var c,l=e2(i),E=!l&&e6(i),S=!l&&!E&&e3(i),P=!l&&!E&&!S&&e4(i),C=l||E||S||P,A=C?function(i,r){for(var c=-1,l=Array(i);++c<i;)l[c]=r(c);return l}(i.length,String):[],q=A.length;for(var T in i)eR.call(i,T)&&!(C&&("length"==T||S&&("offset"==T||"parent"==T)||P&&("buffer"==T||"byteLength"==T||"byteOffset"==T)||(c=null==(c=q)?9007199254740991:c)&&("number"==typeof T||el.test(T))&&T>-1&&T%1==0&&T<c))&&A.push(T);return A}(i):function(i){if(r=i&&i.constructor,i!==("function"==typeof r&&r.prototype||eS))return eH(i);var r,c=[];for(var l in Object(i))eR.call(i,l)&&"constructor"!=l&&c.push(l);return c}(i)}(i),e2(i)?r:function(i,r){for(var c=-1,l=r.length,E=i.length;++c<l;)i[E+c]=r[c];return i}(r,e1(i))}function getMapData(i,r){var c,l=i.__data__;return("string"==(c=typeof r)||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==r:null===r)?l["string"==typeof r?"string":"hash"]:l.map}function getNative(i,r){var c=null==i?void 0:i[r];return!(!isObject(c)||eO&&eO in c)&&(isFunction(c)?eN:eh).test(toSource(c))?c:void 0}Hash.prototype.clear=function(){this.__data__=eF?eF(null):{},this.size=0},Hash.prototype.delete=function(i){var r=this.has(i)&&delete this.__data__[i];return this.size-=r?1:0,r},Hash.prototype.get=function(i){var r=this.__data__;if(eF){var c=r[i];return c===P?void 0:c}return eR.call(r,i)?r[i]:void 0},Hash.prototype.has=function(i){var r=this.__data__;return eF?void 0!==r[i]:eR.call(r,i)},Hash.prototype.set=function(i,r){var c=this.__data__;return this.size+=this.has(i)?0:1,c[i]=eF&&void 0===r?P:r,this},ListCache.prototype.clear=function(){this.__data__=[],this.size=0},ListCache.prototype.delete=function(i){var r=this.__data__,c=assocIndexOf(r,i);return!(c<0)&&(c==r.length-1?r.pop():eM.call(r,c,1),--this.size,!0)},ListCache.prototype.get=function(i){var r=this.__data__,c=assocIndexOf(r,i);return c<0?void 0:r[c][1]},ListCache.prototype.has=function(i){return assocIndexOf(this.__data__,i)>-1},ListCache.prototype.set=function(i,r){var c=this.__data__,l=assocIndexOf(c,i);return l<0?(++this.size,c.push([i,r])):c[l][1]=r,this},MapCache.prototype.clear=function(){this.size=0,this.__data__={hash:new Hash,map:new(eK||ListCache),string:new Hash}},MapCache.prototype.delete=function(i){var r=getMapData(this,i).delete(i);return this.size-=r?1:0,r},MapCache.prototype.get=function(i){return getMapData(this,i).get(i)},MapCache.prototype.has=function(i){return getMapData(this,i).has(i)},MapCache.prototype.set=function(i,r){var c=getMapData(this,i),l=c.size;return c.set(i,r),this.size+=c.size==l?0:1,this},SetCache.prototype.add=SetCache.prototype.push=function(i){return this.__data__.set(i,P),this},SetCache.prototype.has=function(i){return this.__data__.has(i)},Stack.prototype.clear=function(){this.__data__=new ListCache,this.size=0},Stack.prototype.delete=function(i){var r=this.__data__,c=r.delete(i);return this.size=r.size,c},Stack.prototype.get=function(i){return this.__data__.get(i)},Stack.prototype.has=function(i){return this.__data__.has(i)},Stack.prototype.set=function(i,r){var c=this.__data__;if(c instanceof ListCache){var l=c.__data__;if(!eK||l.length<199)return l.push([i,r]),this.size=++c.size,this;c=this.__data__=new MapCache(l)}return c.set(i,r),this.size=c.size,this};var e1=eL?function(i){return null==i?[]:function(i,r){for(var c=-1,l=null==i?0:i.length,E=0,S=[];++c<l;){var P=i[c];r(P,c,i)&&(S[E++]=P)}return S}(eL(i=Object(i)),function(r){return ej.call(i,r)})}:function(){return[]},e5=baseGetTag;function toSource(i){if(null!=i){try{return eC.call(i)}catch(i){}try{return i+""}catch(i){}}return""}function eq(i,r){return i===r||i!=i&&r!=r}(eU&&e5(new eU(new ArrayBuffer(1)))!=ec||eK&&e5(new eK)!=U||eV&&e5(eV.resolve())!=J||eB&&e5(new eB)!=ee||eW&&e5(new eW)!=ea)&&(e5=function(i){var r=baseGetTag(i),c=r==F?i.constructor:void 0,l=c?toSource(c):"";if(l)switch(l){case eG:return ec;case eJ:return U;case eY:return J;case eZ:return ee;case eQ:return ea}return r});var e6=baseIsArguments(function(){return arguments}())?baseIsArguments:function(i){return isObjectLike(i)&&eR.call(i,"callee")&&!ej.call(i,"callee")},e2=Array.isArray,e3=e$||function(){return!1};function isFunction(i){if(!isObject(i))return!1;var r=baseGetTag(i);return r==M||"[object GeneratorFunction]"==r||"[object AsyncFunction]"==r||"[object Proxy]"==r}function isLength(i){return"number"==typeof i&&i>-1&&i%1==0&&i<=9007199254740991}function isObject(i){var r=typeof i;return null!=i&&("object"==r||"function"==r)}function isObjectLike(i){return null!=i&&"object"==typeof i}var e4=eI?function(i){return eI(i)}:function(i){return isObjectLike(i)&&isLength(i.length)&&!!ep[baseGetTag(i)]};i.exports=function(i,r){return function baseIsEqual(i,r,c,l,E){return i===r||(null!=i&&null!=r&&(isObjectLike(i)||isObjectLike(r))?function(i,r,c,l,E,S){var P=e2(i),M=e2(r),J=P?A:e5(i),ea=M?A:e5(r);J=J==C?F:J,ea=ea==C?F:ea;var eh=J==F,el=ea==F,ep=J==ea;if(ep&&e3(i)){if(!e3(r))return!1;P=!0,eh=!1}if(ep&&!eh)return S||(S=new Stack),P||e4(i)?equalArrays(i,r,c,l,E,S):function(i,r,c,l,E,S,P){switch(c){case ec:if(i.byteLength!=r.byteLength||i.byteOffset!=r.byteOffset)break;i=i.buffer,r=r.buffer;case eo:if(i.byteLength!=r.byteLength||!S(new ek(i),new ek(r)))break;return!0;case q:case T:case B:return eq(+i,+r);case D:return i.name==r.name&&i.message==r.message;case X:case et:return i==r+"";case U:var C=mapToArray;case ee:var A=1&l;if(C||(C=setToArray),i.size!=r.size&&!A)break;var M=P.get(i);if(M)return M==r;l|=2,P.set(i,r);var F=equalArrays(C(i),C(r),l,E,S,P);return P.delete(i),F;case"[object Symbol]":if(e0)return e0.call(i)==e0.call(r)}return!1}(i,r,J,c,l,E,S);if(!(1&c)){var ed=eh&&eR.call(i,"__wrapped__"),ef=el&&eR.call(r,"__wrapped__");if(ed||ef){var eg=ed?i.value():i,ey=ef?r.value():r;return S||(S=new Stack),E(eg,ey,c,l,S)}}return!!ep&&(S||(S=new Stack),function(i,r,c,l,E,S){var P=1&c,C=getAllKeys(i),A=C.length;if(A!=getAllKeys(r).length&&!P)return!1;for(var q=A;q--;){var T=C[q];if(!(P?T in r:eR.call(r,T)))return!1}var D=S.get(i);if(D&&S.get(r))return D==r;var M=!0;S.set(i,r),S.set(r,i);for(var U=P;++q<A;){var B=i[T=C[q]],F=r[T];if(l)var J=P?l(F,B,T,r,i,S):l(B,F,T,i,r,S);if(!(void 0===J?B===F||E(B,F,c,l,S):J)){M=!1;break}U||(U="constructor"==T)}if(M&&!U){var X=i.constructor,ee=r.constructor;X!=ee&&"constructor"in i&&"constructor"in r&&!("function"==typeof X&&X instanceof X&&"function"==typeof ee&&ee instanceof ee)&&(M=!1)}return S.delete(i),S.delete(r),M}(i,r,c,l,E,S))}(i,r,c,l,baseIsEqual,E):i!=i&&r!=r)}(i,r)}},63144:function(i){"use strict";let r=self.fetch.bind(self);i.exports=r,i.exports.default=i.exports}}]);